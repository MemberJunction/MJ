-- ============================================================================
-- MemberJunction PostgreSQL Migration
-- Converted from SQL Server using TypeScript conversion pipeline
-- ============================================================================

-- Extensions
CREATE EXTENSION IF NOT EXISTS "pgcrypto";
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

-- Schema
CREATE SCHEMA IF NOT EXISTS __mj;
SET search_path TO __mj, public;

-- Ensure backslashes in string literals are treated literally (not as escape sequences)
SET standard_conforming_strings = on;

-- Implicit INTEGER -> BOOLEAN cast (SQL Server BIT columns accept 0/1 in INSERTs)
-- PostgreSQL has a built-in explicit-only INTEGER->bool cast. We upgrade it to implicit
-- so INSERT VALUES with 0/1 for BOOLEAN columns work like SQL Server BIT.
UPDATE pg_cast SET castcontext = 'i'
WHERE castsource = 'integer'::regtype AND casttarget = 'boolean'::regtype;


-- ===================== DDL: Tables, PKs, Indexes =====================


-- ===================== Helper Functions (fn*) =====================


-- ===================== Views =====================


-- ===================== Stored Procedures (sp*) =====================


-- ===================== Triggers =====================


-- ===================== Data (INSERT/UPDATE/DELETE) =====================

-- SQL Logging Session
-- Session ID: c2f6072b-ba9f-4368-95ef-2afcedf07440
-- Started: 2026-02-16T23:56:04.862Z
-- Description: MetadataSync push operation
-- Format: Migration-ready with Flyway schema placeholders
-- Generated by MemberJunction SQLServerDataProvider

-- Save MJ: Queries (core SP call only)
DO $$
DECLARE
  p_Name_f5f42028 VARCHAR(255);
  p_CategoryID_f5f42028 UUID;
  p_UserQuestion_f5f42028 TEXT;
  p_Description_f5f42028 TEXT;
  p_SQL_f5f42028 TEXT;
  p_TechnicalDescription_f5f42028 TEXT;
  p_OriginalSQL_f5f42028 TEXT;
  p_Feedback_f5f42028 TEXT;
  p_Status_f5f42028 VARCHAR(15);
  p_QualityRank_f5f42028 INTEGER;
  p_ExecutionCostRank_f5f42028 INTEGER;
  p_UsesTemplate_f5f42028 BOOLEAN;
  p_AuditQueryRuns_f5f42028 BOOLEAN;
  p_CacheEnabled_f5f42028 BOOLEAN;
  p_CacheTTLMinutes_f5f42028 INTEGER;
  p_CacheMaxSize_f5f42028 INTEGER;
  p_EmbeddingVector_f5f42028 TEXT;
  p_EmbeddingModelID_f5f42028 UUID;
  p_CacheValidationSQL_f5f42028 TEXT;
  p_ID_f5f42028 UUID;
BEGIN
  p_Name_f5f42028 := 'GetConversationsForMemoryManager';
  p_CategoryID_f5f42028 := '5609FBC7-381C-4F9C-9C74-04B52C1FF3DA';
  p_UserQuestion_f5f42028 := 'What conversations have new activity that need to be analyzed for memory extraction?';
  p_Description_f5f42028 := 'Returns all conversation data needed for memory extraction in a single query: conversations with new activity, their details with ratings, and linked agent runs for scope inheritance. Optimized to replace 4 separate sequential queries.';
  p_SQL_f5f42028 := '-- Get Conversations for Memory Manager - Single optimized query
-- Returns all data needed for memory extraction: conversations, details, ratings, and agent runs
-- Uses JSON aggregation to include related data without row multiplication
-- This replaces 4 separate queries with 1 query for better performance
--
-- Parameters:
--   @since (optional): ISO date string - only include conversations with new activity after this date
--   @agentIds: Comma-separated list of agent IDs that have memory enabled

SELECT
    c."ID" as ConversationID,
    c."UserID",

    -- Most recent agent run ID for this conversation (for scope inheritance)
    (
        SELECT TOP 1 ar."ID"
        FROM [__mj].[vwAIAgentRuns] ar
        WHERE ar."ConversationID" = c."ID"
        AND ar."AgentID" IN ({{ agentIds }})
        ORDER BY ar."StartedAt" DESC
    ) as AgentRunID,

    -- Conversation details as JSON array with ratings included
    (
        SELECT
            cd."ID" as id,
            cd."Role" as role,
            cd."Message" as message,
            cd.__mj_CreatedAt as createdAt,
            cdr."Rating" as rating,
            cdr."Comments" as ratingComment
        FROM [__mj].[vwConversationDetails] cd
        LEFT OUTER JOIN [__mj].[vwConversationDetailRatings] cdr
            ON cdr."ConversationDetailID" = cd."ID"
        WHERE cd."ConversationID" = c."ID"
        AND cd."Status" = ''Complete''
        ORDER BY cd.__mj_CreatedAt ASC
        FOR JSON PATH
    ) as MessagesJSON,

    -- Rating summary flags
    CASE WHEN EXISTS (
        SELECT 1 FROM [__mj].[vwConversationDetails] cd
        INNER JOIN [__mj].[vwConversationDetailRatings] cdr ON cdr."ConversationDetailID" = cd."ID"
        WHERE cd."ConversationID" = c."ID" AND cdr."Rating" >= 8
    ) THEN 1 ELSE 0
END as HasPositiveRating,

    CASE WHEN EXISTS (
        SELECT 1 FROM [__mj].[vwConversationDetails] cd
        INNER JOIN [__mj].[vwConversationDetailRatings] cdr ON cdr."ConversationDetailID" = cd."ID"
        WHERE cd."ConversationID" = c."ID" AND cdr."Rating" <= 3
    ) THEN 1 ELSE 0
END as HasNegativeRating,

    CASE WHEN NOT EXISTS (
        SELECT 1 FROM [__mj].[vwConversationDetails] cd
        INNER JOIN [__mj].[vwConversationDetailRatings] cdr ON cdr."ConversationDetailID" = cd."ID"
        WHERE cd."ConversationID" = c."ID"
    ) THEN 1 ELSE 0
END as IsUnrated

FROM [__mj].[vwConversations] c

-- Only include conversations with new activity since last run
WHERE EXISTS (
    SELECT 1 FROM [__mj].[vwConversationDetails] cd_new
    WHERE cd_new."ConversationID" = c."ID"
    {% if since %}
    AND cd_new.__mj_CreatedAt >= ''{{ since }}''
    {% endif %}
)

-- Only include conversations linked to agents that have memory enabled
AND EXISTS (
    SELECT 1 FROM [__mj].[vwAIAgentRuns] ar
    WHERE ar."ConversationID" = c."ID"
    AND ar."AgentID" IN ({{ agentIds }})
)

ORDER BY c.__mj_UpdatedAt DESC
';
  p_TechnicalDescription_f5f42028 := 'Single-query optimization that replaces 4 separate RunView calls in Memory Manager (get conversations, get agent runs, get details, get ratings). Uses SQL Server FOR JSON PATH to aggregate conversation details with ratings as JSON arrays. Returns rating summary flags (HasPositiveRating, HasNegativeRating, IsUnrated) and most recent AgentRunID for scope inheritance. Reduces database round trips from 4 to 1.';
  p_Status_f5f42028 := 'Approved';
  p_QualityRank_f5f42028 := 9;
  p_ExecutionCostRank_f5f42028 := 3;
  p_UsesTemplate_f5f42028 := 1;
  p_AuditQueryRuns_f5f42028 := 0;
  p_CacheEnabled_f5f42028 := 0;
  p_EmbeddingVector_f5f42028 := CAST(
    '[0.05079127848148346,0.09035059064626694,-0.0241005327552557,0.0002047202578978613,0.007942557334899902,-0.004986656829714775,-0.0040833973325788975,-0.013648014515638351,-0.012232557870447636,-0.016947250813245773,-0.028481926769018173,0.007967942394316196,-0.02684820257127285,0.04656028747558594,-0.052749037742614746,-0.0031639356166124344,0.021843701601028442,-0.00868343934416771,0.024816567078232765,0.024035068228840828,-0.00625630933791399,-0.005105008836835623,0.03923854976892471,-0.03631487116217613,-0.011602414771914482,-0.003479759907349944,-0.04228506609797478,0.019970396533608437,0.03680785372853279,-0.05429837480187416,0.0020721578039228916,0.03860961273312569,-0.063536137342453,0.020076200366020203,0.0000018501910972190672,-0.029065575450658798,-0.04729870334267616,0.016312794759869576,0.0121134789660573,0.033217646181583405,0.06390431523323059,0.010297387838363647,0.04633641615509987,0.013665363192558289,-0.058271877467632294,0.04765554890036583,-0.006883734837174416,-0.06572329252958298,0.046769462525844574,0.02473931387066841,-0.009251734241843224,0.032639279961586,-0.027040032669901848,0.005404791794717312,0.03869984298944473,-0.07086299359798431,0.012611155398190022,0.042279329150915146,0.06193437799811363,-0.0017248332733288407,0.036020055413246155,-0.012290241196751595,-0.010795294307172298,-0.023887621238827705,-0.00048658213927410543,0.004781071562319994,-0.027481012046337128,-0.01167088933289051,-0.005306650884449482,0.012155258096754551,0.1098610982298851,0.048767127096652985,0.014109102077782154,-0.005584047641605139,-0.023643946275115013,-0.05883141607046127,-0.0119113028049469,-0.0008175396360456944,-0.01818632148206234,0.011405295692384243,-0.0691610649228096,0.03485322743654251,-0.016906920820474625,-0.020627707242965698,-0.05224714055657387,-0.017756739631295204,-0.00005160645378055051,-0.010144558735191822,-0.012117987498641014,-0.03278453275561333,0.10722796618938446,0.009296494536101818,0.03643833100795746,-0.02586969919502735,-0.02776397578418255,0.002058778889477253,-0.018441760912537575,-0.00994481984525919,0.017424477264285088,-0.08905638009309769,0.026498032733798027,0.03623943775892258,0.03114563226699829,0.02810569480061531,0.049529869109392166,-0.06858674436807632,-0.018866688013076782,-0.037773989140987396,-0.030855953693389893,-0.0016322797164320946,-0.03939410671591759,0.0075011784210801125,-0.023640239611268044,0.0894571989774704,-0.05356133356690407,0.0033090044744312763,-0.055434998124837875,0.08320257812738419,0.0010676984675228596,-0.007338373921811581,0.009556654840707779,0.03627324849367142,-0.028003215789794922,0.024955447763204575,-0.027351753786206245,0.017706898972392082,-0.0022198003716766834,-0.02509322389960289,0.022394653409719467,-0.07395141571760178,-0.01856291852891445,-0.018150687217712402,0.031191453337669373,-0.03474811092019081,-0.005459083244204521,0.04644906520843506,0.025601867586374283,-0.07710008323192596,-0.017003830522298813,-0.0401291623711586,0.06264519691467285,-0.03787681832909584,-0.02545793540775776,-0.017351355403661728,0.03698789328336716,-0.030737601220607758,-0.039643894881010056,0.02032824046909809,-0.00019931506540160626,0.02879779413342476,-0.058180488646030426,0.019686447456479073,0.002907541813328862,0.0023019530344754457,0.003079300280660391,0.010915940627455711,0.10657579451799393,0.08073189109563828,0.006317181047052145,0.06279805302619934,0.04606578126549721,-0.000859603111166507,-0.017565233632922173,-0.0028020672034472227,0.011497484520077705,0.0007478615152649581,0.013867675326764584,0.028941577300429344,-0.027205482125282288,-0.025482267141342163,-0.015496990643441677,0.019426340237259865,-0.026243751868605614,-0.003329381812363863,0.04347588121891022,0.046181272715330124,-0.0378577895462513,-0.002381382044404745,-0.028820278123021126,0.01254812628030777,-0.031145159155130386,-0.05485319346189499,-0.04959753155708313,0.03526325896382332,0.0010121699888259172,-0.03156620264053345,0.07196877151727676,0.021316271275281906,-0.050753612' AS TEXT
  ) || '07127571,-0.024181406944990158,0.018523653969168663,-0.062384121119976044,0.025164064019918442,-0.0076613579876720905,0.028020406141877174,-0.004517694003880024,-0.03566809743642807,0.050433333963155746,0.03190324828028679,-0.028339020907878876,-0.056465163826942444,-0.01460159569978714,0.013730207458138466,0.08056039363145828,-0.011897717602550983,-0.022440511733293533,-0.07959193736314774,0.03878672793507576,0.008727208711206913,0.007012821733951569,0.00516737625002861,0.021217189729213715,0.032105930149555206,-0.009648353792726994,-0.023099390789866447,0.028003400191664696,0.039157934486866,0.016207469627261162,0.0008238396840170026,-0.013398611918091774,-0.01404569111764431,0.02496291883289814,-0.029620852321386337,-0.006285957992076874,0.0005397481145337224,0.029324516654014587,0.028163200244307518,0.0014608276542276144,0.03636430948972702,0.05486462637782097,0.006569191347807646,0.0003904184268321842,0.0591057687997818,0.021048828959465027,0.010539560578763485,0.06098775565624237,0.012887216173112392,0.0705694928765297,-0.035670775920152664,-0.003907260950654745,0.04537628963589668,-0.04667634144425392,-0.02407081238925457,0.008037649095058441,0.0061867255717515945,-0.040602907538414,0.05563296750187874,-0.002667628927156329,0.019101625308394432,-0.003512762486934662,0.001137108076363802,0.030229294672608376,0.02169504202902317,-0.05029250681400299,-0.055469121783971786,-0.03266417980194092,-0.018757766112685204,0.005477202124893665,-0.03844166174530983,0.04366390034556389,-0.01916595920920372,0.02346942201256752,0.01841963268816471,-0.013052878901362419,0.04185650125145912,-0.048077140003442764,0.009478059597313404,-0.07091536372900009,0.022565769031643867,-0.004921324085444212,0.04391113668680191,0.011910381726920605,0.08163058012723923,0.0018719411455094814,-0.03828807175159454,0.03158252313733101,0.0425875261425972,0.0010985546978190541,0.040754493325948715,-0.004179877694696188,0.025889461860060692,-0.012415274046361446,-0.015056653879582882,0.004746823105961084,-0.0002814853214658797,0.01745971105992794,0.0441463403403759,-0.08236732333898544,0.014081819914281368,-0.036024268716573715,-0.016545020043849945,-0.003377856919541955,-0.02306751348078251,-0.02636226825416088,-0.01099723856896162,-0.05543310195207596,-0.0648922249674797,0.06529548764228821,0.013662722893059254,0.036326147615909576,-0.007037690375000238,-0.0361054427921772,-0.058202896267175674,-0.004697256721556187,-0.04680855572223663,0.0021172116976231337,-0.01232223305851221,0.02042219787836075,0.05537120997905731,0.03784762695431709,-0.04327843338251114,0.032823529094457626,-0.014867894351482391,-0.008223011158406734,0.03855353593826294,-0.013950797729194164,0.04459561035037041,0.027599478140473366,-0.004590993747115135,0.03264136239886284,-0.010919061489403248,-0.05871909111738205,0.035408467054367065,0.06742919236421585,0.010252798907458782,-0.07799189537763596,-0.016890371218323708,-0.007714482955634594,0.05800987407565117,-0.02045244351029396,0.005857840180397034,-0.02115759439766407,-0.06399159878492355,0.030116943642497063,-0.053240351378917694,0.003706203540787101,-0.04979139193892479,0.06886255741119385,-0.04757111892104149,0.0033437798265367746,0.00736438762396574,-0.022324025630950928,-0.02843300811946392,0.03313082829117775,-0.031460754573345184,-0.019286077469587326,0.0031424034386873245,-0.03315126895904541,-0.06568882614374161,0.014908798970282078,-0.04478200152516365,-0.013060609810054302,-0.017260616645216942,-0.01208257395774126,0.0013886390952393413,-0.024398701265454292,-0.0075802854262292385,0.004130313638597727,-0.06296239048242569,-0.021676722913980484,0.029038386419415474,0.09631688892841339,0.024205869063735008,-0.03380195051431656,0.0354977510869503,-0.040639523416757584,0.028481315821409225,-0.006406386848539114,0.0029548911843448877,0.013059730641543865,0.033372655510902405,-0.02978798747062683,-0.05105017125606537,0.06694665551185608,0.02004576474428177,-0.10536867380142212,-0.01994118094444275,-0.013440405018627644,-0.027' || '942100539803505,-0.020736780017614365,0.03392152115702629,-0.09779267013072968,0.014945067465305328,-0.028502844274044037,0.020530885085463524,0.01761610433459282,-0.0625622346997261,-0.033886488527059555,-0.1131233349442482,0.00009574100113241002,0.012706561014056206,-0.06307659298181534,0.019195737317204475,-0.08009906113147736,0.005383370444178581,-0.017002683132886887,-0.004235582426190376,-0.021217117086052895,0.01647210866212845,-0.0007949425489641726,-0.011339214630424976,0.006899432744830847,0.0444469228386879,0.008899403735995293,-0.06134840101003647,0.03177731856703758,0.015260351821780205,0.06299184262752533,0.0032627482432872057,-0.02273254469037056,-0.03224923461675644,0.005678757559508085,-0.01799294725060463,-0.028770867735147476,0.05657487362623215,-0.013943229801952839,0.03969544544816017,0.02078286185860634,0.046805765479803085,-0.004324295558035374,0.05251304432749748,0.029305709525942802,0.022435922175645828,-0.026093272492289543,0.02631351165473461,-0.00607965188100934,0.04262903332710266,0.01061802078038454,0.02471427246928215,-0.00781203480437398,-0.014936456456780434,-0.025120357051491737,-0.0036682637874037027,-0.018968453630805016,-0.0644301250576973,0.03706567734479904,0.031014690175652504,-0.07060138136148453,-0.02515042945742607,-0.008712846785783768,-0.03514249250292778,0.018190797418355942,0.08127940446138382,-0.017786934971809387,0.018582746386528015,0.024726053699851036,0.00039170298259705305,-0.026734352111816406,-0.021657204255461693,-0.0040737902745604515,-0.00675504794344306,-0.008087733760476112,-0.02449152059853077,-0.005953727290034294,0.007129926234483719,0.013528949581086636,-0.024357624351978302,-0.07492576539516449,-0.047737520188093185,0.014164100401103497,0.05191383510828018,0.035761598497629166,0.035110652446746826,0.008612304925918579,0.013734747655689716,-0.028543705120682716,0.05263384059071541,-0.09211473166942596,0.018031325191259384,0.025148333981633186,0.06415750831365585,0.011009620502591133,0.030593188479542732,-0.023033324629068375,0.025234058499336243,0.02118276059627533,-0.015876511111855507,-0.0508064404129982,-0.012985431589186192,-0.000732322339899838,0.02684761956334114,0.019889231771230698,0.050808217376470566,-0.04824836552143097,0.00004551123856799677,0.04843232035636902,-0.07893157750368118,0.007085248362272978,-0.0434907041490078,-0.012945124879479408,-0.016079507768154144,0.00799733679741621,-0.013625946827232838,0.018292617052793503,0.002236912725493312,0.04320317879319191,-0.011262319050729275,-0.05728518217802048,0.02192917838692665,-0.05100050941109657,-0.0038374271243810654,-0.032028570771217346,-0.004153268411755562,0.014178507961332798,0.018571963533759117,0.06490568816661835,-0.04621608182787895,0.0011113806394860148,0.0038916936609894037,0.011749910190701485,0.02180490642786026,0.03846370801329613,-0.05944552272558212,-0.031017789617180824,0.03457550331950188,-0.031838394701480865,-0.03136684373021126,0.0001624780852580443,0.04812081530690193,-0.004885158967226744,0.015770161524415016,-0.006694483105093241,0.0160669032484293,-0.0043753222562372684,0.025523560121655464,-0.03197191283106804,0.015508252196013927,0.0016496420139446855,0.008066253736615181,0.06393346190452576,-0.052016470581293106,0.041149038821458817,-0.006335366051644087,-0.0408761091530323,-0.022557884454727173,-0.010689076967537403,0.0378512367606163,0.06826858222484589,0.011972835287451744,-0.07253285497426987,-0.006630072370171547,0.029759662225842476,0.013830936513841152,-0.028837310150265694,-0.017657645046710968,0.0028450982645154,0.040727175772190094,0.018832918256521225,0.053141843527555466,0.022112255915999413,-0.032845836132764816,-0.038760773837566376,-0.08138919621706009,-0.0023772651329636574,0.036029040813446045,-6.432864916884136e-33,-0.023917924612760544,-0.014684871770441532,0.006195457652211189,0.03723994642496109,-0.0597340352833271,-0.014452226459980011,-0.014286693185567856,-0.031614288687705994,-0.0014728907262906432,-0.0454246811568737,-0.019309645518660545,0.04' || '720998555421829,0.037140704691410065,0.017804637551307678,0.024539735168218613,0.018375108018517494,0.024064848199486732,-0.015934990718960762,0.003956449218094349,0.06683484464883804,0.05707010626792908,0.07038233429193497,-0.0026173924561589956,-0.04496459290385246,0.017081035301089287,0.016864199191331863,0.04953546077013016,0.0032294809352606535,0.004290263168513775,0.01644625887274742,-0.017755873501300812,0.011755957268178463,0.0029416726902127266,0.02460000291466713,-0.00520614068955183,-0.040576498955488205,-0.053908150643110275,-0.061240725219249725,0.0105019211769104,-0.03919978067278862,-0.006003388203680515,0.005817030090838671,0.012093015015125275,0.010909541510045528,0.019264882430434227,-0.03533279895782471,0.034129075706005096,-0.009940299205482006,-0.04438069090247154,-0.030499612912535667,-0.005030960310250521,0.016664298251271248,0.0006420074496418238,0.07340309023857117,0.0007477820618078113,-0.02241343818604946,-0.00947281252592802,0.0218973346054554,-0.057180631905794144,0.03891448304057121,-0.06643245369195938,0.015900282189249992,-0.02570738084614277,0.05755329877138138,0.03457222878932953,0.015214716084301472,0.04068397358059883,0.060166239738464355,0.00036199623718857765,0.017706768587231636,-0.00989444274455309,0.06864777952432632,-0.05683824419975281,-0.0468280054628849,-0.04011251777410507,-0.007704589981585741,-0.0539516881108284,-0.01912015490233898,0.04430456832051277,0.008914164267480373,0.010646039620041847,0.023217666894197464,-0.056944120675325394,-0.010533517226576805,0.037721216678619385,0.05675901100039482,-0.0004984409315511584,-0.03318960592150688,-0.018096156418323517,-0.002046339213848114,-0.06401760131120682,0.012063666246831417,-0.002988585736602545,-0.02988538332283497,0.01409144140779972,-0.00019880582112818956,0.05567929893732071,-0.04396361485123634,-0.013401719741523266,0.015571626834571362,-0.009291345253586769,-0.020664727315306664,0.005512372124940157,0.03060385398566723,-0.014660770073533058,0.004089468624442816,0.02298607863485813,-0.02113240957260132,-0.046136461198329926,-0.009890127927064896,-0.0017711372347548604,0.02748834528028965,0.005973044782876968,0.03226775303483009,-0.008336141705513,0.04134117066860199,-0.005496539641171694,0.11610472947359085,0.03799837827682495,0.048205774277448654,-0.03318478912115097,-0.032624684274196625,0.060979388654232025,-0.026705428957939148,0.00505594490095973,0.02075597085058689,-0.045613549649715424,-0.038081854581832886,0.0028805441688746214,-0.020954394713044167,-0.005293926224112511,0.01901543326675892,2.7053718554270745e-7,0.019686926156282425,0.017047487199306488,-0.013053808361291885,0.003960337024182081,0.0027668620459735394,0.00214202213101089,0.046231482177972794,0.011082331649959087,0.03369522839784622,-0.002964071463793516,0.04340475797653198,0.017111919820308685,0.011001167818903923,0.03854682296514511,-0.07275687158107758,-0.036689192056655884,-0.0218672938644886,-0.09564562886953354,-0.07321562618017197,-0.03604140505194664,0.03735772892832756,0.0071462951600551605,0.04691056162118912,0.0017742825439199805,-0.005430781748145819,0.0074676088988780975,0.019835757091641426,-0.05317511036992073,-0.08343472331762314,0.015415129251778126,0.05399279296398163,-0.052760958671569824,-0.033376842737197876,0.01886281929910183,-0.021096426993608475,0.009936757385730743,-0.047020334750413895,0.01970226876437664,-0.025672458112239838,-0.047675274312496185,0.008177420124411583,-0.045784033834934235,-0.01186355296522379,0.06341540813446045,0.059236180037260056,-0.049784839153289795,-0.05416940152645111,0.005316439084708691,-0.008641050197184086,-0.031758345663547516,0.022063013166189194,0.03223682940006256,0.011694096028804779,0.001983350608497858,0.011517112143337727,0.03735494241118431,-0.017370957881212234,-0.04038471728563309,0.0416184663772583,-0.0342542827129364,-0.0036211232654750347,-0.09179119765758514,0.01881531998515129,0.030116280540823936,-0.021103352308273315,-0.03853075951337814,0.013337511569261551,2.6788554278417677' || 'e-34,0.039873164147138596,0.05002487450838089,0.028683243319392204,0.05554112046957016,0.029719317331910133,0.03558764606714249,0.009646526537835598,0.007612765766680241,0.055310722440481186,-0.1114618182182312,-0.007236486300826073]';
  p_EmbeddingModelID_f5f42028 := '1D45AA65-41EC-4572-9ECD-AB2826C9B059';
  p_ID_f5f42028 := '574FD9D5-AB9E-4FA5-A36C-C25E7D3F63FC';
  PERFORM __mj."spUpdateQuery"(p_Name := p_Name_f5f42028, p_CategoryID := p_CategoryID_f5f42028, p_UserQuestion := p_UserQuestion_f5f42028, p_Description := p_Description_f5f42028, p_SQL := p_SQL_f5f42028, p_TechnicalDescription := p_TechnicalDescription_f5f42028, p_OriginalSQL := p_OriginalSQL_f5f42028, p_Feedback := p_Feedback_f5f42028, p_Status := p_Status_f5f42028, p_QualityRank := p_QualityRank_f5f42028, p_ExecutionCostRank := p_ExecutionCostRank_f5f42028, p_UsesTemplate := p_UsesTemplate_f5f42028, p_AuditQueryRuns := p_AuditQueryRuns_f5f42028, p_CacheEnabled := p_CacheEnabled_f5f42028, p_CacheTTLMinutes := p_CacheTTLMinutes_f5f42028, p_CacheMaxSize := p_CacheMaxSize_f5f42028, p_EmbeddingVector := p_EmbeddingVector_f5f42028, p_EmbeddingModelID := p_EmbeddingModelID_f5f42028, p_CacheValidationSQL := p_CacheValidationSQL_f5f42028, p_ID := p_ID_f5f42028);
END $$;

-- Save MJ: Query Parameters (core SP call only)
DO $$
DECLARE
  p_QueryID_a2930ba2 UUID;
  p_Name_a2930ba2 VARCHAR(255);
  p_Type_a2930ba2 VARCHAR(50);
  p_IsRequired_a2930ba2 BOOLEAN;
  p_DefaultValue_a2930ba2 TEXT;
  p_Description_a2930ba2 TEXT;
  p_SampleValue_a2930ba2 TEXT;
  p_ValidationFilters_a2930ba2 TEXT;
  p_DetectionMethod_a2930ba2 VARCHAR(50);
  p_AutoDetectConfidenceScore_a2930ba2 NUMERIC(3,2);
  p_ID_a2930ba2 UUID;
BEGIN
  p_QueryID_a2930ba2 := '574FD9D5-AB9E-4FA5-A36C-C25E7D3F63FC';
  p_Name_a2930ba2 := 'since';
  p_Type_a2930ba2 := 'date';
  p_IsRequired_a2930ba2 := 0;
  p_Description_a2930ba2 := 'ISO date string - only include conversations with new activity after this date';
  p_SampleValue_a2930ba2 := '2024-01-15T10:30:00Z';
  p_DetectionMethod_a2930ba2 := 'AI';
  p_ID_a2930ba2 := 'DF0E9F24-CD92-4C6C-BA18-13B443160DE5';
  PERFORM __mj."spUpdateQueryParameter"(p_QueryID := p_QueryID_a2930ba2, p_Name := p_Name_a2930ba2, p_Type := p_Type_a2930ba2, p_IsRequired := p_IsRequired_a2930ba2, p_DefaultValue := p_DefaultValue_a2930ba2, p_Description := p_Description_a2930ba2, p_SampleValue := p_SampleValue_a2930ba2, p_ValidationFilters := p_ValidationFilters_a2930ba2, p_DetectionMethod := p_DetectionMethod_a2930ba2, p_AutoDetectConfidenceScore := p_AutoDetectConfidenceScore_a2930ba2, p_ID := p_ID_a2930ba2);
END $$;

-- Save MJ: Query Parameters (core SP call only)
DO $$
DECLARE
  p_QueryID_f1753d09 UUID;
  p_Name_f1753d09 VARCHAR(255);
  p_Type_f1753d09 VARCHAR(50);
  p_IsRequired_f1753d09 BOOLEAN;
  p_DefaultValue_f1753d09 TEXT;
  p_Description_f1753d09 TEXT;
  p_SampleValue_f1753d09 TEXT;
  p_ValidationFilters_f1753d09 TEXT;
  p_DetectionMethod_f1753d09 VARCHAR(50);
  p_AutoDetectConfidenceScore_f1753d09 NUMERIC(3,2);
  p_ID_f1753d09 UUID;
BEGIN
  p_QueryID_f1753d09 := '574FD9D5-AB9E-4FA5-A36C-C25E7D3F63FC';
  p_Name_f1753d09 := 'agentIds';
  p_Type_f1753d09 := 'string';
  p_IsRequired_f1753d09 := 1;
  p_Description_f1753d09 := 'Comma-separated list of agent IDs that have memory enabled';
  p_SampleValue_f1753d09 := '''agent1'',''agent2'',''agent3''';
  p_DetectionMethod_f1753d09 := 'AI';
  p_ID_f1753d09 := 'AF4459A1-BEDA-4200-A739-4292E90EA6A1';
  PERFORM __mj."spUpdateQueryParameter"(p_QueryID := p_QueryID_f1753d09, p_Name := p_Name_f1753d09, p_Type := p_Type_f1753d09, p_IsRequired := p_IsRequired_f1753d09, p_DefaultValue := p_DefaultValue_f1753d09, p_Description := p_Description_f1753d09, p_SampleValue := p_SampleValue_f1753d09, p_ValidationFilters := p_ValidationFilters_f1753d09, p_DetectionMethod := p_DetectionMethod_f1753d09, p_AutoDetectConfidenceScore := p_AutoDetectConfidenceScore_f1753d09, p_ID := p_ID_f1753d09);
END $$;

-- Save MJ: Query Fields (core SP call only)
DO $$
DECLARE
  p_QueryID_99318626 UUID;
  p_Name_99318626 VARCHAR(255);
  p_Description_99318626 TEXT;
  p_Sequence_99318626 INTEGER;
  p_SQLBaseType_99318626 VARCHAR(50);
  p_SQLFullType_99318626 VARCHAR(100);
  p_SourceEntityID_99318626 UUID;
  p_SourceFieldName_99318626 VARCHAR(255);
  p_IsComputed_99318626 BOOLEAN;
  p_ComputationDescription_99318626 TEXT;
  p_IsSummary_99318626 BOOLEAN;
  p_SummaryDescription_99318626 TEXT;
  p_DetectionMethod_99318626 VARCHAR(50);
  p_AutoDetectConfidenceScore_99318626 NUMERIC(3,2);
  p_ID_99318626 UUID;
BEGIN
  p_QueryID_99318626 := '574FD9D5-AB9E-4FA5-A36C-C25E7D3F63FC';
  p_Name_99318626 := 'HasPositiveRating';
  p_Description_99318626 := 'Flag indicating if conversation has at least one rating >= 8';
  p_Sequence_99318626 := 5;
  p_SQLBaseType_99318626 := 'bit';
  p_SQLFullType_99318626 := 'bit';
  p_IsComputed_99318626 := 1;
  p_ComputationDescription_99318626 := 'CASE expression checking EXISTS for ratings >= 8';
  p_IsSummary_99318626 := 0;
  p_DetectionMethod_99318626 := 'Manual';
  p_ID_99318626 := 'ADC80F10-C778-46A7-AB21-1474FF3051BA';
  PERFORM __mj."spUpdateQueryField"(p_QueryID := p_QueryID_99318626, p_Name := p_Name_99318626, p_Description := p_Description_99318626, p_Sequence := p_Sequence_99318626, p_SQLBaseType := p_SQLBaseType_99318626, p_SQLFullType := p_SQLFullType_99318626, p_SourceEntityID := p_SourceEntityID_99318626, p_SourceFieldName := p_SourceFieldName_99318626, p_IsComputed := p_IsComputed_99318626, p_ComputationDescription := p_ComputationDescription_99318626, p_IsSummary := p_IsSummary_99318626, p_SummaryDescription := p_SummaryDescription_99318626, p_DetectionMethod := p_DetectionMethod_99318626, p_AutoDetectConfidenceScore := p_AutoDetectConfidenceScore_99318626, p_ID := p_ID_99318626);
END $$;

-- Save MJ: Query Fields (core SP call only)
DO $$
DECLARE
  p_QueryID_04daae0e UUID;
  p_Name_04daae0e VARCHAR(255);
  p_Description_04daae0e TEXT;
  p_Sequence_04daae0e INTEGER;
  p_SQLBaseType_04daae0e VARCHAR(50);
  p_SQLFullType_04daae0e VARCHAR(100);
  p_SourceEntityID_04daae0e UUID;
  p_SourceFieldName_04daae0e VARCHAR(255);
  p_IsComputed_04daae0e BOOLEAN;
  p_ComputationDescription_04daae0e TEXT;
  p_IsSummary_04daae0e BOOLEAN;
  p_SummaryDescription_04daae0e TEXT;
  p_DetectionMethod_04daae0e VARCHAR(50);
  p_AutoDetectConfidenceScore_04daae0e NUMERIC(3,2);
  p_ID_04daae0e UUID;
BEGIN
  p_QueryID_04daae0e := '574FD9D5-AB9E-4FA5-A36C-C25E7D3F63FC';
  p_Name_04daae0e := 'UserID';
  p_Description_04daae0e := 'Unique identifier of the user associated with the conversation';
  p_Sequence_04daae0e := 2;
  p_SQLBaseType_04daae0e := 'TEXT';
  p_SQLFullType_04daae0e := 'TEXT';
  p_SourceEntityID_04daae0e := '13248F34-2837-EF11-86D4-6045BDEE16E6';
  p_SourceFieldName_04daae0e := 'UserID';
  p_IsComputed_04daae0e := 0;
  p_IsSummary_04daae0e := 0;
  p_DetectionMethod_04daae0e := 'Manual';
  p_ID_04daae0e := 'FC47BF02-BE51-4C7C-9132-1C20ADC4FEBD';
  PERFORM __mj."spUpdateQueryField"(p_QueryID := p_QueryID_04daae0e, p_Name := p_Name_04daae0e, p_Description := p_Description_04daae0e, p_Sequence := p_Sequence_04daae0e, p_SQLBaseType := p_SQLBaseType_04daae0e, p_SQLFullType := p_SQLFullType_04daae0e, p_SourceEntityID := p_SourceEntityID_04daae0e, p_SourceFieldName := p_SourceFieldName_04daae0e, p_IsComputed := p_IsComputed_04daae0e, p_ComputationDescription := p_ComputationDescription_04daae0e, p_IsSummary := p_IsSummary_04daae0e, p_SummaryDescription := p_SummaryDescription_04daae0e, p_DetectionMethod := p_DetectionMethod_04daae0e, p_AutoDetectConfidenceScore := p_AutoDetectConfidenceScore_04daae0e, p_ID := p_ID_04daae0e);
END $$;

-- Save MJ: Query Fields (core SP call only)
DO $$
DECLARE
  p_QueryID_1d3b66fe UUID;
  p_Name_1d3b66fe VARCHAR(255);
  p_Description_1d3b66fe TEXT;
  p_Sequence_1d3b66fe INTEGER;
  p_SQLBaseType_1d3b66fe VARCHAR(50);
  p_SQLFullType_1d3b66fe VARCHAR(100);
  p_SourceEntityID_1d3b66fe UUID;
  p_SourceFieldName_1d3b66fe VARCHAR(255);
  p_IsComputed_1d3b66fe BOOLEAN;
  p_ComputationDescription_1d3b66fe TEXT;
  p_IsSummary_1d3b66fe BOOLEAN;
  p_SummaryDescription_1d3b66fe TEXT;
  p_DetectionMethod_1d3b66fe VARCHAR(50);
  p_AutoDetectConfidenceScore_1d3b66fe NUMERIC(3,2);
  p_ID_1d3b66fe UUID;
BEGIN
  p_QueryID_1d3b66fe := '574FD9D5-AB9E-4FA5-A36C-C25E7D3F63FC';
  p_Name_1d3b66fe := 'MessagesJSON';
  p_Description_1d3b66fe := 'Conversation details as JSON array with ratings included';
  p_Sequence_1d3b66fe := 4;
  p_SQLBaseType_1d3b66fe := 'TEXT';
  p_SQLFullType_1d3b66fe := 'TEXT';
  p_IsComputed_1d3b66fe := 1;
  p_ComputationDescription_1d3b66fe := 'FOR JSON PATH subquery aggregating conversation details and ratings';
  p_IsSummary_1d3b66fe := 0;
  p_DetectionMethod_1d3b66fe := 'Manual';
  p_ID_1d3b66fe := 'CB76A976-AE46-454B-B837-90A78B74ED50';
  PERFORM __mj."spUpdateQueryField"(p_QueryID := p_QueryID_1d3b66fe, p_Name := p_Name_1d3b66fe, p_Description := p_Description_1d3b66fe, p_Sequence := p_Sequence_1d3b66fe, p_SQLBaseType := p_SQLBaseType_1d3b66fe, p_SQLFullType := p_SQLFullType_1d3b66fe, p_SourceEntityID := p_SourceEntityID_1d3b66fe, p_SourceFieldName := p_SourceFieldName_1d3b66fe, p_IsComputed := p_IsComputed_1d3b66fe, p_ComputationDescription := p_ComputationDescription_1d3b66fe, p_IsSummary := p_IsSummary_1d3b66fe, p_SummaryDescription := p_SummaryDescription_1d3b66fe, p_DetectionMethod := p_DetectionMethod_1d3b66fe, p_AutoDetectConfidenceScore := p_AutoDetectConfidenceScore_1d3b66fe, p_ID := p_ID_1d3b66fe);
END $$;

-- Save MJ: Query Fields (core SP call only)
DO $$
DECLARE
  p_QueryID_eb2e360e UUID;
  p_Name_eb2e360e VARCHAR(255);
  p_Description_eb2e360e TEXT;
  p_Sequence_eb2e360e INTEGER;
  p_SQLBaseType_eb2e360e VARCHAR(50);
  p_SQLFullType_eb2e360e VARCHAR(100);
  p_SourceEntityID_eb2e360e UUID;
  p_SourceFieldName_eb2e360e VARCHAR(255);
  p_IsComputed_eb2e360e BOOLEAN;
  p_ComputationDescription_eb2e360e TEXT;
  p_IsSummary_eb2e360e BOOLEAN;
  p_SummaryDescription_eb2e360e TEXT;
  p_DetectionMethod_eb2e360e VARCHAR(50);
  p_AutoDetectConfidenceScore_eb2e360e NUMERIC(3,2);
  p_ID_eb2e360e UUID;
BEGIN
  p_QueryID_eb2e360e := '574FD9D5-AB9E-4FA5-A36C-C25E7D3F63FC';
  p_Name_eb2e360e := 'AgentRunID';
  p_Description_eb2e360e := 'Most recent agent run ID for this conversation (for scope inheritance)';
  p_Sequence_eb2e360e := 3;
  p_SQLBaseType_eb2e360e := 'TEXT';
  p_SQLFullType_eb2e360e := 'TEXT';
  p_IsComputed_eb2e360e := 1;
  p_ComputationDescription_eb2e360e := 'Scalar subquery selecting top 1 ID from AIAgentRuns ordered by StartedAt DESC';
  p_IsSummary_eb2e360e := 0;
  p_DetectionMethod_eb2e360e := 'Manual';
  p_ID_eb2e360e := '4CAB47E1-C542-4CDD-9BEF-90BFC2786FF0';
  PERFORM __mj."spUpdateQueryField"(p_QueryID := p_QueryID_eb2e360e, p_Name := p_Name_eb2e360e, p_Description := p_Description_eb2e360e, p_Sequence := p_Sequence_eb2e360e, p_SQLBaseType := p_SQLBaseType_eb2e360e, p_SQLFullType := p_SQLFullType_eb2e360e, p_SourceEntityID := p_SourceEntityID_eb2e360e, p_SourceFieldName := p_SourceFieldName_eb2e360e, p_IsComputed := p_IsComputed_eb2e360e, p_ComputationDescription := p_ComputationDescription_eb2e360e, p_IsSummary := p_IsSummary_eb2e360e, p_SummaryDescription := p_SummaryDescription_eb2e360e, p_DetectionMethod := p_DetectionMethod_eb2e360e, p_AutoDetectConfidenceScore := p_AutoDetectConfidenceScore_eb2e360e, p_ID := p_ID_eb2e360e);
END $$;

-- Save MJ: Query Fields (core SP call only)
DO $$
DECLARE
  p_QueryID_57c0eeaa UUID;
  p_Name_57c0eeaa VARCHAR(255);
  p_Description_57c0eeaa TEXT;
  p_Sequence_57c0eeaa INTEGER;
  p_SQLBaseType_57c0eeaa VARCHAR(50);
  p_SQLFullType_57c0eeaa VARCHAR(100);
  p_SourceEntityID_57c0eeaa UUID;
  p_SourceFieldName_57c0eeaa VARCHAR(255);
  p_IsComputed_57c0eeaa BOOLEAN;
  p_ComputationDescription_57c0eeaa TEXT;
  p_IsSummary_57c0eeaa BOOLEAN;
  p_SummaryDescription_57c0eeaa TEXT;
  p_DetectionMethod_57c0eeaa VARCHAR(50);
  p_AutoDetectConfidenceScore_57c0eeaa NUMERIC(3,2);
  p_ID_57c0eeaa UUID;
BEGIN
  p_QueryID_57c0eeaa := '574FD9D5-AB9E-4FA5-A36C-C25E7D3F63FC';
  p_Name_57c0eeaa := 'HasNegativeRating';
  p_Description_57c0eeaa := 'Flag indicating if conversation has at least one rating <= 3';
  p_Sequence_57c0eeaa := 6;
  p_SQLBaseType_57c0eeaa := 'bit';
  p_SQLFullType_57c0eeaa := 'bit';
  p_IsComputed_57c0eeaa := 1;
  p_ComputationDescription_57c0eeaa := 'CASE expression checking EXISTS for ratings <= 3';
  p_IsSummary_57c0eeaa := 0;
  p_DetectionMethod_57c0eeaa := 'Manual';
  p_ID_57c0eeaa := '5A464544-F105-4F17-94F8-A0423F150812';
  PERFORM __mj."spUpdateQueryField"(p_QueryID := p_QueryID_57c0eeaa, p_Name := p_Name_57c0eeaa, p_Description := p_Description_57c0eeaa, p_Sequence := p_Sequence_57c0eeaa, p_SQLBaseType := p_SQLBaseType_57c0eeaa, p_SQLFullType := p_SQLFullType_57c0eeaa, p_SourceEntityID := p_SourceEntityID_57c0eeaa, p_SourceFieldName := p_SourceFieldName_57c0eeaa, p_IsComputed := p_IsComputed_57c0eeaa, p_ComputationDescription := p_ComputationDescription_57c0eeaa, p_IsSummary := p_IsSummary_57c0eeaa, p_SummaryDescription := p_SummaryDescription_57c0eeaa, p_DetectionMethod := p_DetectionMethod_57c0eeaa, p_AutoDetectConfidenceScore := p_AutoDetectConfidenceScore_57c0eeaa, p_ID := p_ID_57c0eeaa);
END $$;

-- Save MJ: Query Fields (core SP call only)
DO $$
DECLARE
  p_QueryID_dc77f32e UUID;
  p_Name_dc77f32e VARCHAR(255);
  p_Description_dc77f32e TEXT;
  p_Sequence_dc77f32e INTEGER;
  p_SQLBaseType_dc77f32e VARCHAR(50);
  p_SQLFullType_dc77f32e VARCHAR(100);
  p_SourceEntityID_dc77f32e UUID;
  p_SourceFieldName_dc77f32e VARCHAR(255);
  p_IsComputed_dc77f32e BOOLEAN;
  p_ComputationDescription_dc77f32e TEXT;
  p_IsSummary_dc77f32e BOOLEAN;
  p_SummaryDescription_dc77f32e TEXT;
  p_DetectionMethod_dc77f32e VARCHAR(50);
  p_AutoDetectConfidenceScore_dc77f32e NUMERIC(3,2);
  p_ID_dc77f32e UUID;
BEGIN
  p_QueryID_dc77f32e := '574FD9D5-AB9E-4FA5-A36C-C25E7D3F63FC';
  p_Name_dc77f32e := 'IsUnrated';
  p_Description_dc77f32e := 'Flag indicating if conversation has no ratings';
  p_Sequence_dc77f32e := 7;
  p_SQLBaseType_dc77f32e := 'bit';
  p_SQLFullType_dc77f32e := 'bit';
  p_IsComputed_dc77f32e := 1;
  p_ComputationDescription_dc77f32e := 'CASE expression checking NOT EXISTS for any ratings';
  p_IsSummary_dc77f32e := 0;
  p_DetectionMethod_dc77f32e := 'Manual';
  p_ID_dc77f32e := 'F11B7F22-EF85-418E-855A-AC0EDBEE014A';
  PERFORM __mj."spUpdateQueryField"(p_QueryID := p_QueryID_dc77f32e, p_Name := p_Name_dc77f32e, p_Description := p_Description_dc77f32e, p_Sequence := p_Sequence_dc77f32e, p_SQLBaseType := p_SQLBaseType_dc77f32e, p_SQLFullType := p_SQLFullType_dc77f32e, p_SourceEntityID := p_SourceEntityID_dc77f32e, p_SourceFieldName := p_SourceFieldName_dc77f32e, p_IsComputed := p_IsComputed_dc77f32e, p_ComputationDescription := p_ComputationDescription_dc77f32e, p_IsSummary := p_IsSummary_dc77f32e, p_SummaryDescription := p_SummaryDescription_dc77f32e, p_DetectionMethod := p_DetectionMethod_dc77f32e, p_AutoDetectConfidenceScore := p_AutoDetectConfidenceScore_dc77f32e, p_ID := p_ID_dc77f32e);
END $$;

-- Save MJ: Applications (core SP call only)
DO $$
DECLARE
  p_Name_ae878754 VARCHAR(100);
  p_Description_ae878754 TEXT;
  p_Icon_ae878754 VARCHAR(500);
  p_DefaultForNewUser_ae878754 BOOLEAN;
  p_SchemaAutoAddNewEntities_ae878754 TEXT;
  p_Color_ae878754 VARCHAR(20);
  p_DefaultNavItems_ae878754 TEXT;
  p_ClassName_ae878754 VARCHAR(255);
  p_DefaultSequence_ae878754 INTEGER;
  p_Status_ae878754 VARCHAR(20);
  p_NavigationStyle_ae878754 VARCHAR(20);
  p_TopNavLocation_ae878754 VARCHAR(30);
  p_HideNavBarIconWhenActive_ae878754 BOOLEAN;
  p_Path_ae878754 VARCHAR(100);
  p_AutoUpdatePath_ae878754 BOOLEAN;
  p_ID_ae878754 UUID;
BEGIN
  p_Name_ae878754 := 'Chat';
  p_Description_ae878754 := 'Agent conversations, artifact collections, and tasks';
  p_Icon_ae878754 := 'fa-solid fa-comments';
  p_DefaultForNewUser_ae878754 := 1;
  p_Color_ae878754 := '#9c27b0';
  p_DefaultNavItems_ae878754 := '[
  {
    "Label": "Conversations",
    "Icon": "fa-solid fa-comments",
    "ResourceType": "Custom",
    "DriverClass": "ChatConversationsResource",
    "isDefault": true
  },
  {
    "Label": "Collections",
    "Icon": "fa-solid fa-folder-open",
    "ResourceType": "Custom",
    "DriverClass": "ChatCollectionsResource",
    "isDefault": false
  },
  {
    "Label": "Tasks",
    "Icon": "fa-solid fa-tasks",
    "ResourceType": "Custom",
    "DriverClass": "ChatTasksResource",
    "isDefault": false
  }
]';
  p_DefaultSequence_ae878754 := 1;
  p_Status_ae878754 := 'Active';
  p_NavigationStyle_ae878754 := 'Both';
  p_TopNavLocation_ae878754 := 'Left of User Menu';
  p_HideNavBarIconWhenActive_ae878754 := 1;
  p_Path_ae878754 := 'chat';
  p_AutoUpdatePath_ae878754 := 1;
  p_ID_ae878754 := '7A873E1A-692E-43FA-97F8-57D8161A985C';
  PERFORM __mj."spUpdateApplication"(p_Name := p_Name_ae878754, p_Description := p_Description_ae878754, p_Icon := p_Icon_ae878754, p_DefaultForNewUser := p_DefaultForNewUser_ae878754, p_SchemaAutoAddNewEntities := p_SchemaAutoAddNewEntities_ae878754, p_Color := p_Color_ae878754, p_DefaultNavItems := p_DefaultNavItems_ae878754, p_ClassName := p_ClassName_ae878754, p_DefaultSequence := p_DefaultSequence_ae878754, p_Status := p_Status_ae878754, p_NavigationStyle := p_NavigationStyle_ae878754, p_TopNavLocation := p_TopNavLocation_ae878754, p_HideNavBarIconWhenActive := p_HideNavBarIconWhenActive_ae878754, p_Path := p_Path_ae878754, p_AutoUpdatePath := p_AutoUpdatePath_ae878754, p_ID := p_ID_ae878754);
END $$;

-- Save MJ: Applications (core SP call only)
DO $$
DECLARE
  p_Name_f2234c67 VARCHAR(100);
  p_Description_f2234c67 TEXT;
  p_Icon_f2234c67 VARCHAR(500);
  p_DefaultForNewUser_f2234c67 BOOLEAN;
  p_SchemaAutoAddNewEntities_f2234c67 TEXT;
  p_Color_f2234c67 VARCHAR(20);
  p_DefaultNavItems_f2234c67 TEXT;
  p_ClassName_f2234c67 VARCHAR(255);
  p_DefaultSequence_f2234c67 INTEGER;
  p_Status_f2234c67 VARCHAR(20);
  p_NavigationStyle_f2234c67 VARCHAR(20);
  p_TopNavLocation_f2234c67 VARCHAR(30);
  p_HideNavBarIconWhenActive_f2234c67 BOOLEAN;
  p_Path_f2234c67 VARCHAR(100);
  p_AutoUpdatePath_f2234c67 BOOLEAN;
  p_ID_f2234c67 UUID;
BEGIN
  p_Name_f2234c67 := 'Lists';
  p_Description_f2234c67 := 'Manage user defined collections of records across the system';
  p_Icon_f2234c67 := 'fa-solid fa-list-check';
  p_DefaultForNewUser_f2234c67 := 1;
  p_Color_f2234c67 := '#009688';
  p_DefaultNavItems_f2234c67 := '[
  {
    "Label": "Lists",
    "Icon": "fa-solid fa-list-check",
    "ResourceType": "Custom",
    "DriverClass": "ListsBrowseResource",
    "isDefault": true
  },
  {
    "Label": "Operations",
    "Icon": "fa-solid fa-diagram-project",
    "ResourceType": "Custom",
    "DriverClass": "ListsOperationsResource",
    "isDefault": false
  },
  {
    "Label": "Categories",
    "Icon": "fa-solid fa-tags",
    "ResourceType": "Custom",
    "DriverClass": "ListsCategoriesResource",
    "isDefault": false
  }
]';
  p_DefaultSequence_f2234c67 := 50;
  p_Status_f2234c67 := 'Active';
  p_NavigationStyle_f2234c67 := 'App Switcher';
  p_TopNavLocation_f2234c67 := 'Left of User Menu';
  p_HideNavBarIconWhenActive_f2234c67 := 1;
  p_Path_f2234c67 := 'lists';
  p_AutoUpdatePath_f2234c67 := 1;
  p_ID_f2234c67 := '140166B9-4064-4C3F-ACF1-3EB7DB2C9BD0';
  PERFORM __mj."spUpdateApplication"(p_Name := p_Name_f2234c67, p_Description := p_Description_f2234c67, p_Icon := p_Icon_f2234c67, p_DefaultForNewUser := p_DefaultForNewUser_f2234c67, p_SchemaAutoAddNewEntities := p_SchemaAutoAddNewEntities_f2234c67, p_Color := p_Color_f2234c67, p_DefaultNavItems := p_DefaultNavItems_f2234c67, p_ClassName := p_ClassName_f2234c67, p_DefaultSequence := p_DefaultSequence_f2234c67, p_Status := p_Status_f2234c67, p_NavigationStyle := p_NavigationStyle_f2234c67, p_TopNavLocation := p_TopNavLocation_f2234c67, p_HideNavBarIconWhenActive := p_HideNavBarIconWhenActive_f2234c67, p_Path := p_Path_f2234c67, p_AutoUpdatePath := p_AutoUpdatePath_f2234c67, p_ID := p_ID_f2234c67);
END $$;


-- ===================== FK & CHECK Constraints =====================


-- ===================== Grants =====================


-- ===================== Comments =====================
