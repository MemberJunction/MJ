<div class="message-input-container">
  <textarea
    #messageTextarea
    class="message-input"
    [(ngModel)]="messageText"
    [placeholder]="placeholder"
    [disabled]="disabled || isSending"
    (keydown)="onKeyDown($event)"
    (input)="onInput($event)"
    rows="3">
  </textarea>

  <!-- Mention Autocomplete Dropdown -->
  <mj-mention-dropdown
    [suggestions]="mentionSuggestions"
    [position]="mentionDropdownPosition"
    [visible]="showMentionDropdown"
    (suggestionSelected)="onMentionSelected($event)"
    (closed)="closeMentionDropdown()">
  </mj-mention-dropdown>

  <div class="input-actions">
    <div class="processing-indicator" *ngIf="isProcessing">
      <i class="fas fa-circle-notch fa-spin"></i>
      <span>AI is responding...</span>
    </div>
    <button
      class="btn-attach"
      [disabled]="disabled"
      title="Attach file (coming soon)">
      <i class="fas fa-paperclip"></i>
    </button>
    <button
      class="btn-send"
      [disabled]="!canSend"
      (click)="onSend()"
      [title]="isSending ? 'Sending...' : 'Send message'">
      <i class="fas fa-paper-plane"></i>
    </button>
  </div>
</div>