<div class="conversation-workspace" [attr.data-layout]="layout" mjSearchShortcut (searchTriggered)="openSearch()">
  <!-- Top Navigation Bar -->
  <div class="workspace-navigation">
    <mj-conversation-navigation
      [activeTab]="activeTab"
      [environmentId]="environmentId"
      (tabChanged)="onTabChanged($event)"
      (sidebarToggled)="toggleSidebar()"
      (searchTriggered)="openSearch()">
    </mj-conversation-navigation>
  </div>

  <div class="workspace-content">
    <!-- Left Sidebar (hidden when Collections view is active) -->
    <div class="workspace-sidebar" *ngIf="isSidebarVisible && activeTab !== 'collections'">
      <mj-conversation-sidebar
        [activeTab]="activeTab"
        [environmentId]="environmentId"
        [currentUser]="currentUser">
      </mj-conversation-sidebar>
    </div>

    <!-- Collections Full-Panel View -->
    <div class="workspace-main" *ngIf="activeTab === 'collections'">
      <mj-collections-full-view
        [environmentId]="environmentId"
        [currentUser]="currentUser">
      </mj-collections-full-view>
    </div>

    <!-- Main Chat Area (only shown when not in Collections view) -->
    <div class="workspace-main" *ngIf="activeTab !== 'collections'">
      <mj-conversation-chat-area
        [environmentId]="environmentId"
        [currentUser]="currentUser">
      </mj-conversation-chat-area>
    </div>

    <!-- Right Artifact Panel -->
    <div class="workspace-artifact-panel" *ngIf="isArtifactPanelOpen">
      <mj-artifact-panel
        [currentUser]="currentUser"
        (close)="closeArtifactPanel()">
      </mj-artifact-panel>
    </div>
  </div>

  <!-- Global Search Panel -->
  <mj-search-panel
    [isOpen]="isSearchPanelOpen"
    [environmentId]="environmentId"
    [currentUser]="currentUser"
    (close)="closeSearch()"
    (resultSelected)="handleSearchResult($event)">
  </mj-search-panel>

  <!-- Toast Notifications -->
  <mj-toast></mj-toast>
</div>