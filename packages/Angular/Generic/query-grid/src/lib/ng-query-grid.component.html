<div class="query-grid-wrap" >
  <kendo-grid #kendoGrid

    [resizable]="true"
    [data]="gridView"
    [skip]="skip"
    [pageSize]="pageSize"
    scrollable="virtual"
    [rowHeight]="36"
    (pageChange)="pageChange($event)"
    [loading]="isLoading"
    [height]="gridHeight"
    [sortable]="true"
    [resizable]="true"
    [reorderable]="true"
    [selectable]="true"
    kendoGridSelectBy
    [(selectedKeys)]="selectedKeys"
    (cellClick)="cellClickHandler($event)"
    >
    <ng-template kendoGridToolbarTemplate>
      <button fillMode="outline" themeColor="info" kendoButton (click)="doExcelExport()" >
        <span class="fa-regular fa-file-excel"></span>Export to Excel
      </button>
      @if (showRefreshButton) {
        <button
          kendoButton
          themeColor="info"
          (click)="RefreshFromSavedParams()" >
          Refresh
          <span class="fa-solid fa-arrow-rotate-left"></span>
        </button>
      }
    </ng-template>

    <kendo-excelexport #excelExport [data]="exportData" [fileName]="Params?.QueryID + '_Query.xlsx'">
      @for (exportCol of queryColumns(); track exportCol) {
        <kendo-excelexport-column [field]="exportCol" [title]="exportCol">
        </kendo-excelexport-column>
      }
    </kendo-excelexport>
  </kendo-grid>
</div>
