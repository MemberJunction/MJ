<div class="record-form-container">
    @if (record) {
        <form class="record-form" #form="ngForm">
            <mj-form-toolbar [form]="this"></mj-form-toolbar>

            <!-- Header Section -->
            <div class="prompt-run-header">
                <div class="header-content">
                    <div class="run-overview">
                        <div class="run-icon-wrapper" [style.background-color]="getStatusColor() + '20'">
                            <i [class]="'fa-solid ' + getStatusIcon()" [style.color]="getStatusColor()"></i>
                        </div>
                        <div class="run-info">
                            <h1 class="run-title">
                                Prompt Run
                                @if (record.ID) {
                                    <span class="run-id">#{{ record.ID.substring(0, 8) }}</span>
                                }
                            </h1>
                            <div class="run-meta">
                                <span class="status-badge" [style.background-color]="getStatusColor()">
                                    <i [class]="'fa-solid ' + getStatusIcon()"></i>
                                    {{ getStatusText() }}
                                </span>
                                @if (record.RunType) {
                                    <span class="run-type-badge" [style.color]="getRunTypeColor(record.RunType)">
                                        <i [class]="'fa-solid ' + getRunTypeIcon(record.RunType)"></i>
                                        {{ record.RunType }}
                                    </span>
                                }
                                @if (prompt) {
                                    <span class="prompt-name" (click)="navigateToEntity('AI Prompts', prompt.ID)" title="View Prompt">
                                        <i class="fa-solid fa-comment-dots"></i>
                                        {{ prompt.Name }}
                                    </span>
                                }
                                @if (model) {
                                    <span class="model-name" (click)="navigateToEntity('AI Models', model.ID)" title="View Model">
                                        <i class="fa-solid fa-microchip"></i>
                                        {{ model.Name }}
                                    </span>
                                }
                                @if (record.Vendor) {
                                    <span class="vendor-name" (click)="navigateToEntity('MJ: AI Vendors', record.VendorID)" title="View Vendor">
                                        <i class="fa-solid fa-building"></i>
                                        {{ record.Vendor }}
                                    </span>
                                }
                            </div>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="run-actions">
                        <button kendoButton fillMode="outline" size="small" (click)="refreshData()" title="Refresh data">
                            <i class="fa-solid fa-refresh"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Key Metrics Bar -->
                <div class="metrics-bar">
                    <div class="metric-item">
                        <i class="fa-solid fa-clock"></i>
                        <div class="metric-content">
                            <div class="metric-label">Duration</div>
                            <div class="metric-value">{{ formatDuration(record.ExecutionTimeMS) }}</div>
                        </div>
                    </div>
                    <div class="metric-item">
                        <i class="fa-solid fa-coins"></i>
                        <div class="metric-content">
                            <div class="metric-label">Total Tokens</div>
                            <div class="metric-value">{{ formatTokens(record.TokensUsed) }}</div>
                        </div>
                    </div>
                    <div class="metric-item">
                        <i class="fa-solid fa-dollar-sign"></i>
                        <div class="metric-content">
                            <div class="metric-label">Cost</div>
                            <div class="metric-value">{{ formatCost(record.TotalCost || record.Cost) }}</div>
                        </div>
                    </div>
                    @if (record.RunAt) {
                        <div class="metric-item">
                            <i class="fa-solid fa-calendar"></i>
                            <div class="metric-content">
                                <div class="metric-label">Started</div>
                                <div class="metric-value">{{ record.RunAt | date:'short' }}</div>
                            </div>
                        </div>
                    }
                </div>
            </div>

            <!-- Main Content with Expansion Panels -->
            <div class="form-content">
                <kendo-panelbar>
                    
                    <!-- Input Messages Panel -->
                    <kendo-panelbar-item [expanded]="messagesExpanded">
                        <ng-template kendoPanelBarItemTitle>
                            <span class="panel-title">
                                <i class="fa-solid fa-comment-dots"></i>
                                Input Messages
                                @if (record.Messages && record.Messages.trim() !== '') {
                                    <span class="panel-badge">JSON</span>
                                }
                            </span>
                        </ng-template>
                        <ng-template kendoPanelBarContent>
                            <div class="panel-content">
                                @if (record.Messages && record.Messages.trim() !== '') {
                                    <div class="json-editor-container">
                                        <div class="json-toolbar">
                                            <button kendoButton
                                                fillMode="flat" 
                                                size="small"
                                                (click)="copyToClipboard(formattedMessages, 'Messages')"
                                                title="Copy JSON">
                                                <i class="fa-solid fa-copy"></i> Copy
                                            </button>
                                        </div>
                                        <mj-code-editor 
                                            [(ngModel)]="formattedMessages"
                                            name="formattedMessages"
                                            [readonly]="true"
                                            [language]="'json'"
                                            [lineWrapping]="true"
                                            style="height: 400px; width: 100%;">
                                        </mj-code-editor>
                                    </div>
                                } @else {
                                    <div class="empty-state">
                                        <i class="fa-solid fa-comment-slash"></i>
                                        <p>No input messages recorded</p>
                                    </div>
                                }
                            </div>
                        </ng-template>
                    </kendo-panelbar-item>
                    
                    <!-- Result Panel -->
                    <kendo-panelbar-item [expanded]="resultExpanded">
                        <ng-template kendoPanelBarItemTitle>
                            <span class="panel-title">
                                <i class="fa-solid fa-square-check"></i>
                                Result
                                @if (record.Result && record.Result.trim() !== '') {
                                    <span class="panel-badge">JSON</span>
                                }
                                @if (record.ErrorMessage) {
                                    <span class="panel-badge error">Error</span>
                                }
                            </span>
                        </ng-template>
                        <ng-template kendoPanelBarContent>
                            <div class="panel-content">
                                @if (record.ErrorMessage) {
                                    <div class="error-message">
                                        <i class="fa-solid fa-exclamation-triangle"></i>
                                        <div class="error-content">
                                            <h4>Error Message</h4>
                                            <p>{{ record.ErrorMessage }}</p>
                                        </div>
                                    </div>
                                }
                                
                                @if (record.Result && record.Result.trim() !== '') {
                                    <div class="json-editor-container">
                                        <div class="json-toolbar">
                                            <button kendoButton
                                                fillMode="flat" 
                                                size="small"
                                                (click)="copyToClipboard(formattedResult, 'Result')"
                                                title="Copy JSON">
                                                <i class="fa-solid fa-copy"></i> Copy
                                            </button>
                                        </div>
                                        <mj-code-editor 
                                            [(ngModel)]="formattedResult"
                                            name="formattedResult"
                                            [readonly]="true"
                                            [language]="'json'"
                                            [lineWrapping]="true"
                                            style="height: 400px; width: 100%;">
                                        </mj-code-editor>
                                    </div>
                                } @else if (!record.ErrorMessage) {
                                    <div class="empty-state">
                                        <i class="fa-solid fa-inbox"></i>
                                        <p>No result data recorded</p>
                                    </div>
                                }
                            </div>
                        </ng-template>
                    </kendo-panelbar-item>
                    
                    <!-- Token Usage & Metrics Panel -->
                    <kendo-panelbar-item [expanded]="metricsExpanded">
                        <ng-template kendoPanelBarItemTitle>
                            <span class="panel-title">
                                <i class="fa-solid fa-chart-line"></i>
                                Token Usage & Metrics
                            </span>
                        </ng-template>
                        <ng-template kendoPanelBarContent>
                            <div class="panel-content">
                                <div class="metrics-grid">
                                    <div class="metric-card">
                                        <div class="metric-header">
                                            <i class="fa-solid fa-message"></i>
                                            <h4>Prompt Tokens</h4>
                                        </div>
                                        <div class="metric-value large">{{ formatTokens(record.TokensPrompt) }}</div>
                                        @if (record.TokensPromptRollup && record.TokensPromptRollup !== record.TokensPrompt) {
                                            <div class="metric-rollup">
                                                <span>Rollup: {{ formatTokens(record.TokensPromptRollup) }}</span>
                                            </div>
                                        }
                                    </div>
                                    
                                    <div class="metric-card">
                                        <div class="metric-header">
                                            <i class="fa-solid fa-reply"></i>
                                            <h4>Completion Tokens</h4>
                                        </div>
                                        <div class="metric-value large">{{ formatTokens(record.TokensCompletion) }}</div>
                                        @if (record.TokensCompletionRollup && record.TokensCompletionRollup !== record.TokensCompletion) {
                                            <div class="metric-rollup">
                                                <span>Rollup: {{ formatTokens(record.TokensCompletionRollup) }}</span>
                                            </div>
                                        }
                                    </div>
                                    
                                    <div class="metric-card">
                                        <div class="metric-header">
                                            <i class="fa-solid fa-coins"></i>
                                            <h4>Total Tokens</h4>
                                        </div>
                                        <div class="metric-value large">{{ formatTokens(record.TokensUsed) }}</div>
                                        @if (record.TokensUsedRollup && record.TokensUsedRollup !== record.TokensUsed) {
                                            <div class="metric-rollup">
                                                <span>Rollup: {{ formatTokens(record.TokensUsedRollup) }}</span>
                                            </div>
                                        }
                                    </div>
                                    
                                    <div class="metric-card">
                                        <div class="metric-header">
                                            <i class="fa-solid fa-dollar-sign"></i>
                                            <h4>Cost</h4>
                                        </div>
                                        <div class="metric-value large">{{ formatCost(record.Cost) }}</div>
                                        @if (record.TotalCost && record.TotalCost !== record.Cost) {
                                            <div class="metric-rollup">
                                                <span>Total: {{ formatCost(record.TotalCost) }}</span>
                                            </div>
                                        }
                                        @if (record.CostCurrency) {
                                            <div class="metric-currency">{{ record.CostCurrency }}</div>
                                        }
                                    </div>
                                </div>
                                
                                <!-- Additional Metrics -->
                                <div class="additional-metrics">
                                    @if (record.ExecutionOrder !== null) {
                                        <div class="metric-row">
                                            <span class="metric-label">Execution Order:</span>
                                            <span class="metric-value">{{ record.ExecutionOrder }}</span>
                                        </div>
                                    }
                                    @if (record.ConfigurationID) {
                                        <div class="metric-row">
                                            <span class="metric-label">Configuration:</span>
                                            <span class="metric-value">{{ record.Configuration }}</span>
                                        </div>
                                    }
                                    @if (record.AgentID) {
                                        <div class="metric-row">
                                            <span class="metric-label">Agent:</span>
                                            <span class="metric-value link" (click)="navigateToEntity('AI Agents', record.AgentID)">
                                                {{ record.Agent }}
                                                <i class="fa-solid fa-external-link"></i>
                                            </span>
                                        </div>
                                    }
                                </div>
                            </div>
                        </ng-template>
                    </kendo-panelbar-item>
                    
                    <!-- Validation & Retry Panel -->
                    @if (record && ((record.ValidationAttemptCount && record.ValidationAttemptCount > 0) || record.ValidationBehavior)) {
                        <kendo-panelbar-item [expanded]="validationExpanded">
                            <ng-template kendoPanelBarItemTitle>
                                <span class="panel-title">
                                    <i class="fa-solid fa-shield-check"></i>
                                    Validation & Retries
                                    @if (record && record.ValidationAttemptCount && record.ValidationAttemptCount > 1) {
                                        <span class="panel-count">({{ record.ValidationAttemptCount }} attempts)</span>
                                    }
                                    @if (record.FinalValidationPassed) {
                                        <span class="panel-badge success">Passed</span>
                                    } @else if (record.FinalValidationPassed === false) {
                                        <span class="panel-badge error">Failed</span>
                                    }
                                </span>
                            </ng-template>
                            <ng-template kendoPanelBarContent>
                                <div class="panel-content">
                                    <!-- Validation Summary -->
                                    <div class="validation-summary">
                                        <div class="summary-header">
                                            <h4>Validation Summary</h4>
                                            <div class="validation-status" [class.success]="record.FinalValidationPassed" [class.failed]="!record.FinalValidationPassed">
                                                <i [class]="record.FinalValidationPassed ? 'fa-solid fa-check-circle' : 'fa-solid fa-times-circle'"></i>
                                                {{ record.FinalValidationPassed ? 'Validation Passed' : 'Validation Failed' }}
                                            </div>
                                        </div>
                                        
                                        <div class="validation-metrics">
                                            <div class="metric-card small">
                                                <div class="metric-label">Total Attempts</div>
                                                <div class="metric-value">{{ record.ValidationAttemptCount || 0 }}</div>
                                            </div>
                                            <div class="metric-card small">
                                                <div class="metric-label">Successful</div>
                                                <div class="metric-value">{{ record.SuccessfulValidationCount || 0 }}</div>
                                            </div>
                                            <div class="metric-card small">
                                                <div class="metric-label">Behavior</div>
                                                <div class="metric-value">{{ record.ValidationBehavior || 'Not set' }}</div>
                                            </div>
                                            <div class="metric-card small">
                                                <div class="metric-label">Retry Strategy</div>
                                                <div class="metric-value">{{ record.RetryStrategy || 'Not set' }}</div>
                                            </div>
                                        </div>
                                        
                                        @if (record.FinalValidationError) {
                                            <div class="validation-error">
                                                <h5><i class="fa-solid fa-exclamation-triangle"></i> Final Validation Error</h5>
                                                <p>{{ record.FinalValidationError }}</p>
                                                @if (record && record.ValidationErrorCount && record.ValidationErrorCount > 0) {
                                                    <span class="error-count">{{ record.ValidationErrorCount }} validation errors</span>
                                                }
                                            </div>
                                        }
                                        
                                        @if (record.CommonValidationError && record.CommonValidationError !== record.FinalValidationError) {
                                            <div class="common-error">
                                                <h5><i class="fa-solid fa-repeat"></i> Most Common Error</h5>
                                                <p>{{ record.CommonValidationError }}</p>
                                            </div>
                                        }
                                    </div>
                                    
                                    <!-- Retry Timeline -->
                                    @if (record && record.ValidationAttemptCount && record.ValidationAttemptCount > 1) {
                                        <div class="retry-timeline">
                                            <h4>Retry Timeline</h4>
                                            <div class="timeline-info">
                                                <div class="timeline-stat">
                                                    <i class="fa-solid fa-clock"></i>
                                                    <span>First Attempt: {{ record.FirstAttemptAt | date:'short' }}</span>
                                                </div>
                                                <div class="timeline-stat">
                                                    <i class="fa-solid fa-flag-checkered"></i>
                                                    <span>Last Attempt: {{ record.LastAttemptAt | date:'short' }}</span>
                                                </div>
                                                <div class="timeline-stat">
                                                    <i class="fa-solid fa-stopwatch"></i>
                                                    <span>Total Retry Duration: {{ formatDuration(record.TotalRetryDurationMS) }}</span>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                    
                                    <!-- Validation Attempts Details -->
                                    @if (validationAttempts && validationAttempts.length > 0) {
                                        <div class="validation-attempts">
                                            <h4>Validation Attempts</h4>
                                            <div class="attempts-list">
                                                @for (attempt of validationAttempts; track attempt.attemptNumber) {
                                                    <div class="attempt-item" [class.success]="attempt.success" [class.failed]="!attempt.success">
                                                        <div class="attempt-number">
                                                            <i [class]="attempt.success ? 'fa-solid fa-check' : 'fa-solid fa-times'"></i>
                                                            Attempt #{{ attempt.attemptNumber }}
                                                        </div>
                                                        <div class="attempt-details">
                                                            <span class="attempt-time">{{ attempt.timestamp }}</span>
                                                            @if (!attempt.success) {
                                                                <span class="attempt-error">{{ attempt.errorMessage || 'Unknown error' }}</span>
                                                                @if (attempt.validationErrorCount > 0) {
                                                                    <span class="error-count">({{ attempt.validationErrorCount }} errors)</span>
                                                                }
                                                            }
                                                            @if (attempt.outputLength) {
                                                                <span class="output-length">Output: {{ attempt.outputLength }} chars</span>
                                                            }
                                                        </div>
                                                    </div>
                                                }
                                            </div>
                                        </div>
                                    }
                                    
                                    <!-- Validation Summary JSON -->
                                    @if (validationSummary) {
                                        <div class="validation-json">
                                            <h4>Validation Summary Details</h4>
                                            <div class="json-viewer-container">
                                                <mj-code-editor 
                                                    [(ngModel)]="formattedValidationSummary"
                                                    name="formattedValidationSummary"
                                                    [readonly]="true"
                                                    [language]="'json'"
                                                    [lineWrapping]="true"
                                                    style="height: 200px; width: 100%;">
                                                </mj-code-editor>
                                            </div>
                                        </div>
                                    }
                                    
                                    <!-- Validation Attempts JSON -->
                                    @if (record.ValidationAttempts) {
                                        <div class="validation-json">
                                            <h4>Validation Attempts (Raw JSON)</h4>
                                            <div class="json-viewer-container">
                                                <mj-code-editor 
                                                    [(ngModel)]="formattedValidationAttempts"
                                                    name="formattedValidationAttempts"
                                                    [readonly]="true"
                                                    [language]="'json'"
                                                    [lineWrapping]="true"
                                                    style="height: 300px; width: 100%;">
                                                </mj-code-editor>
                                            </div>
                                        </div>
                                    }
                                </div>
                            </ng-template>
                        </kendo-panelbar-item>
                    }
                    
                    <!-- Hierarchy Panel (for parent/child relationships) -->
                    @if (record.ParentID || childRuns.length > 0) {
                        <kendo-panelbar-item [expanded]="hierarchyExpanded">
                            <ng-template kendoPanelBarItemTitle>
                                <span class="panel-title">
                                    <i class="fa-solid fa-sitemap"></i>
                                    Run Hierarchy
                                    @if (childRuns.length > 0) {
                                        <span class="panel-count">({{ childRuns.length }} children)</span>
                                    }
                                </span>
                            </ng-template>
                            <ng-template kendoPanelBarContent>
                                <div class="panel-content">
                                    @if (parentRun) {
                                        <div class="parent-run-section">
                                            <h4><i class="fa-solid fa-level-up-alt"></i> Parent Run</h4>
                                            <div class="run-item parent" (click)="navigateToEntity('MJ: AI Prompt Runs', parentRun.ID)">
                                                <div class="run-item-icon" [style.background-color]="getStatusColor() + '20'">
                                                    <i [class]="'fa-solid ' + getRunTypeIcon(parentRun.RunType)"></i>
                                                </div>
                                                <div class="run-item-content">
                                                    <div class="run-item-title">
                                                        Parent Run #{{ parentRun.ID.substring(0, 8) }}
                                                        <span class="run-item-type">{{ parentRun.RunType }}</span>
                                                    </div>
                                                    <div class="run-item-meta">
                                                        <span><i class="fa-solid fa-clock"></i> {{ formatDuration(parentRun.ExecutionTimeMS) }}</span>
                                                        <span><i class="fa-solid fa-coins"></i> {{ formatTokens(parentRun.TokensUsed) }}</span>
                                                        <span><i class="fa-solid fa-calendar"></i> {{ parentRun.RunAt | date:'short' }}</span>
                                                    </div>
                                                </div>
                                                <i class="fa-solid fa-external-link"></i>
                                            </div>
                                        </div>
                                    }
                                    
                                    @if (childRuns.length > 0) {
                                        <div class="child-runs-section">
                                            <h4><i class="fa-solid fa-level-down-alt"></i> Child Runs</h4>
                                            <div class="runs-list">
                                                @for (childRun of childRuns; track childRun.ID) {
                                                    <div class="run-item child" (click)="navigateToEntity('MJ: AI Prompt Runs', childRun.ID)">
                                                        <div class="run-item-icon" [style.background-color]="getStatusColor() + '20'">
                                                            <i [class]="'fa-solid ' + getRunTypeIcon(childRun.RunType)"></i>
                                                        </div>
                                                        <div class="run-item-content">
                                                            <div class="run-item-title">
                                                                Child Run #{{ childRun.ID.substring(0, 8) }}
                                                                @if (childRun.ExecutionOrder !== null) {
                                                                    <span class="execution-order">#{{ childRun.ExecutionOrder }}</span>
                                                                }
                                                                <span class="run-item-type">{{ childRun.RunType }}</span>
                                                            </div>
                                                            <div class="run-item-meta">
                                                                <span class="status-indicator" [style.color]="getStatusColor()">
                                                                    <i [class]="'fa-solid ' + getStatusIcon()"></i>
                                                                    {{ childRun.Success ? 'Success' : childRun.ErrorMessage ? 'Failed' : 'Running' }}
                                                                </span>
                                                                <span><i class="fa-solid fa-clock"></i> {{ formatDuration(childRun.ExecutionTimeMS) }}</span>
                                                                <span><i class="fa-solid fa-coins"></i> {{ formatTokens(childRun.TokensUsed) }}</span>
                                                            </div>
                                                        </div>
                                                        <i class="fa-solid fa-external-link"></i>
                                                    </div>
                                                }
                                            </div>
                                        </div>
                                    }
                                </div>
                            </ng-template>
                        </kendo-panelbar-item>
                    }
                    
                    <!-- Additional Details Panel -->
                    <kendo-panelbar-item [expanded]="false">
                        <ng-template kendoPanelBarItemTitle>
                            <span class="panel-title">
                                <i class="fa-solid fa-info-circle"></i>
                                Additional Details
                            </span>
                        </ng-template>
                        <ng-template kendoPanelBarContent>
                            <div class="panel-content">
                                <div class="detail-fields-grid">
                                    @if (record.AgentID) {
                                        <div class="detail-field">
                                            <label>Agent</label>
                                            <div class="detail-value clickable" (click)="navigateToEntity('AI Agents', record.AgentID)" title="View Agent">
                                                <i class="fa-solid fa-robot"></i>
                                                {{ record.Agent || 'Unknown' }}
                                                <i class="fa-solid fa-external-link"></i>
                                            </div>
                                        </div>
                                    }
                                    
                                    @if (record.ConfigurationID) {
                                        <div class="detail-field">
                                            <label>Configuration</label>
                                            <div class="detail-value">
                                                <i class="fa-solid fa-cog"></i>
                                                {{ record.Configuration || 'Unknown' }}
                                            </div>
                                        </div>
                                    }
                                    
                                    @if (record.RunType) {
                                        <div class="detail-field">
                                            <label>Run Type</label>
                                            <div class="detail-value">
                                                <i [class]="'fa-solid ' + getRunTypeIcon(record.RunType)"></i>
                                                {{ record.RunType }}
                                            </div>
                                        </div>
                                    }
                                    
                                    @if (record.ResponseFormat) {
                                        <div class="detail-field">
                                            <label>Response Format</label>
                                            <div class="detail-value">
                                                <i class="fa-solid fa-code"></i>
                                                {{ record.ResponseFormat }}
                                            </div>
                                        </div>
                                    }
                                    
                                    <div class="detail-field">
                                        <label>Temperature</label>
                                        <div class="detail-value" [class.null-value]="record.Temperature === null || record.Temperature === undefined">
                                            <i class="fa-solid fa-temperature-high"></i>
                                            {{ record.Temperature !== null && record.Temperature !== undefined ? record.Temperature : '—' }}
                                        </div>
                                    </div>
                                    
                                    <div class="detail-field">
                                        <label>Top P</label>
                                        <div class="detail-value" [class.null-value]="record.TopP === null || record.TopP === undefined">
                                            <i class="fa-solid fa-percentage"></i>
                                            {{ record.TopP !== null && record.TopP !== undefined ? record.TopP : '—' }}
                                        </div>
                                    </div>
                                    
                                    <div class="detail-field">
                                        <label>Top K</label>
                                        <div class="detail-value" [class.null-value]="record.TopK === null || record.TopK === undefined">
                                            <i class="fa-solid fa-list-ol"></i>
                                            {{ record.TopK !== null && record.TopK !== undefined ? record.TopK : '—' }}
                                        </div>
                                    </div>
                                    
                                    <div class="detail-field">
                                        <label>Min P</label>
                                        <div class="detail-value" [class.null-value]="record.MinP === null || record.MinP === undefined">
                                            <i class="fa-solid fa-filter"></i>
                                            {{ record.MinP !== null && record.MinP !== undefined ? record.MinP : '—' }}
                                        </div>
                                    </div>
                                    
                                    <div class="detail-field">
                                        <label>Frequency Penalty</label>
                                        <div class="detail-value" [class.null-value]="record.FrequencyPenalty === null || record.FrequencyPenalty === undefined">
                                            <i class="fa-solid fa-repeat"></i>
                                            {{ record.FrequencyPenalty !== null && record.FrequencyPenalty !== undefined ? record.FrequencyPenalty : '—' }}
                                        </div>
                                    </div>
                                    
                                    <div class="detail-field">
                                        <label>Presence Penalty</label>
                                        <div class="detail-value" [class.null-value]="record.PresencePenalty === null || record.PresencePenalty === undefined">
                                            <i class="fa-solid fa-plus-circle"></i>
                                            {{ record.PresencePenalty !== null && record.PresencePenalty !== undefined ? record.PresencePenalty : '—' }}
                                        </div>
                                    </div>
                                    
                                    <div class="detail-field">
                                        <label>Seed</label>
                                        <div class="detail-value" [class.null-value]="record.Seed === null || record.Seed === undefined">
                                            <i class="fa-solid fa-seedling"></i>
                                            {{ record.Seed !== null && record.Seed !== undefined ? record.Seed : '—' }}
                                        </div>
                                    </div>
                                    
                                    @if (record.RunAt) {
                                        <div class="detail-field">
                                            <label>Started At</label>
                                            <div class="detail-value">
                                                <i class="fa-solid fa-clock"></i>
                                                {{ record.RunAt | date:'medium' }}
                                            </div>
                                        </div>
                                    }
                                    
                                    @if (record.CompletedAt) {
                                        <div class="detail-field">
                                            <label>Completed At</label>
                                            <div class="detail-value">
                                                <i class="fa-solid fa-check-circle"></i>
                                                {{ record.CompletedAt | date:'medium' }}
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>
                        </ng-template>
                    </kendo-panelbar-item>
                    
                </kendo-panelbar>
            </div>
        </form>
    }
</div>