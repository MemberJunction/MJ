<div class="execution-panel" 
     [class.active]="executionStatus !== 'idle' && !isPanelClosed"
     [class.resizing]="isResizing"
     [style.height.px]="executionStatus !== 'idle' && !isPanelClosed ? panelHeight : 0">
  
  <!-- Resize handle -->
  <div class="resize-handle" 
       *ngIf="executionStatus !== 'idle' && !isPanelClosed"
       (mousedown)="onResizeStart($event)">
    <div class="resize-grip"></div>
  </div>
  
  <div class="panel-header">
    <h3 class="panel-title">
      <i class="fas fa-terminal"></i> Flow Execution
    </h3>
    <div class="header-actions">
      <button 
        class="icon-button"
        (click)="clearLogs()"
        title="Clear logs"
        [disabled]="executionStatus === 'running'">
        <i class="fas fa-trash"></i>
      </button>
      <button 
        class="icon-button close"
        (click)="closePanel()"
        title="Close panel">
        <i class="fas fa-times"></i>
      </button>
    </div>
  </div>
  
  <div class="execution-controls">
    <div class="status-indicator" [class]="'status-' + executionStatus">
      <i class="fas" [ngClass]="{
        'fa-circle': executionStatus === 'idle',
        'fa-spinner fa-spin': executionStatus === 'running',
        'fa-pause-circle': executionStatus === 'paused',
        'fa-check-circle': executionStatus === 'completed',
        'fa-exclamation-circle': executionStatus === 'error'
      }"></i>
      <span>{{ executionStatus | titlecase }}</span>
    </div>
    
    <div class="control-buttons">
      <button 
        class="control-button"
        (click)="onPause()"
        [disabled]="executionStatus !== 'running'"
        title="Pause execution">
        <i class="fas fa-pause"></i>
      </button>
      <button 
        class="control-button"
        (click)="onResume()"
        [disabled]="executionStatus !== 'paused'"
        title="Resume execution">
        <i class="fas fa-play"></i>
      </button>
      <button 
        class="control-button stop"
        (click)="onStop()"
        [disabled]="executionStatus !== 'running' && executionStatus !== 'paused'"
        title="Stop execution">
        <i class="fas fa-stop"></i>
      </button>
    </div>
  </div>
  
  <div class="logs-container">
    <div *ngIf="executionLogs.length === 0" class="empty-logs">
      <i class="fas fa-info-circle"></i>
      <p>No execution logs yet. Click "Run Flow" to start.</p>
    </div>
    
    <div *ngFor="let log of executionLogs" 
         class="log-entry" 
         [class]="getLogClass(log.type)"
         [class.current-step]="log.stepId === currentStepId && currentStepId !== 0">
      <div class="log-timestamp">{{ formatTimestamp(log.timestamp) }}</div>
      <div class="log-icon">
        <i class="fas" [ngClass]="getLogIcon(log.type)"></i>
      </div>
      <div class="log-content">
        <div class="log-step" *ngIf="log.stepId">
          <strong>{{ log.stepName }}</strong>
        </div>
        <div class="log-message">{{ log.message }}</div>
        <div class="log-data" *ngIf="log.data">
          <pre>{{ log.data | json }}</pre>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Minimized indicator when panel is closed but execution is active -->
<div class="execution-indicator" 
     *ngIf="executionStatus !== 'idle' && isPanelClosed"
     (click)="isPanelClosed = false"
     title="Click to reopen execution panel">
  <i class="fas" [ngClass]="{
    'fa-spinner fa-spin': executionStatus === 'running',
    'fa-pause-circle': executionStatus === 'paused',
    'fa-check-circle': executionStatus === 'completed',
    'fa-exclamation-circle': executionStatus === 'error'
  }"></i>
  <span>{{ executionStatus | titlecase }}</span>
</div>