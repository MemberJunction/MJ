<div class="record-form-container">
    <form *ngIf="record" class="record-form" #form="ngForm">
        <mj-form-toolbar [form]="this"></mj-form-toolbar>

        <div class="form-section-controls">
            <div class="control-group">
                <button (click)="expandAllSections()" title="Expand all sections">
                    <i class="fa fa-expand-alt"></i>Expand All
                </button>
                <button (click)="collapseAllSections()" title="Collapse all sections">
                    <i class="fa fa-compress-alt"></i>Collapse All
                </button>
            </div>
            <input type="text"
                   class="section-search"
                   placeholder="Search sections..."
                   (input)="filterSections($event)"
                   #sectionSearch>
            <span class="section-count">
                <span class="section-count-badge">{{getExpandedCount()}}</span> of 21 expanded
            </span>
        </div>
        <div class="form-panels-container">
<!-- Details Section -->
        <div class="form-card collapsible-card" data-section-name="details">
            <div class="collapsible-header" (click)="toggleSection('details')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-align-left"></i>
                    <h3>Details</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.details ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.details">
                <div class="form-body">
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="Name"
            Type="textarea"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="Description"
            Type="textarea"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="LogoURL"
            Type="textarea"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="__mj_CreatedAt"
            Type="textbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="__mj_UpdatedAt"
            Type="textbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="ParentID"
            Type="textbox"
            [EditMode]="EditMode"
            LinkType="Record"
            LinkComponentType="Search"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="ExposeAsAction"
            Type="checkbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="ExecutionOrder"
            Type="numerictextbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="ExecutionMode"
            Type="dropdownlist"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="EnableContextCompression"
            Type="checkbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="ContextCompressionMessageThreshold"
            Type="numerictextbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="ContextCompressionPromptID"
            Type="textbox"
            [EditMode]="EditMode"
            LinkType="Record"
            LinkComponentType="Search"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="ContextCompressionMessageRetentionCount"
            Type="numerictextbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="TypeID"
            Type="textbox"
            [EditMode]="EditMode"
            LinkType="Record"
            LinkComponentType="Search"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="Status"
            Type="dropdownlist"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="DriverClass"
            Type="textarea"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="IconClass"
            Type="textbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="ModelSelectionMode"
            Type="dropdownlist"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="PayloadDownstreamPaths"
            Type="textarea"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="PayloadUpstreamPaths"
            Type="textarea"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="PayloadSelfReadPaths"
            Type="textarea"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="PayloadSelfWritePaths"
            Type="textarea"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="PayloadScope"
            Type="textarea"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="FinalPayloadValidation"
            Type="textarea"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="FinalPayloadValidationMode"
            Type="dropdownlist"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="FinalPayloadValidationMaxRetries"
            Type="numerictextbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="MaxCostPerRun"
            Type="numerictextbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="MaxTokensPerRun"
            Type="numerictextbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="MaxIterationsPerRun"
            Type="numerictextbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="MaxTimePerRun"
            Type="numerictextbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="MinExecutionsPerRun"
            Type="numerictextbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="MaxExecutionsPerRun"
            Type="numerictextbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="StartingPayloadValidation"
            Type="textarea"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="StartingPayloadValidationMode"
            Type="dropdownlist"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="DefaultPromptEffortLevel"
            Type="numerictextbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="ChatHandlingOption"
            Type="dropdownlist"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="DefaultArtifactTypeID"
            Type="textbox"
            [EditMode]="EditMode"
            LinkType="Record"
            LinkComponentType="Search"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="OwnerUserID"
            Type="textbox"
            [EditMode]="EditMode"
            LinkType="Record"
            LinkComponentType="Search"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="InvocationMode"
            Type="dropdownlist"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="ArtifactCreationMode"
            Type="dropdownlist"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="FunctionalRequirements"
            Type="textarea"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="TechnicalDesign"
            Type="textarea"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="InjectNotes"
            Type="checkbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="MaxNotesToInject"
            Type="numerictextbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="NoteInjectionStrategy"
            Type="dropdownlist"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="InjectExamples"
            Type="checkbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="MaxExamplesToInject"
            Type="numerictextbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="ExampleInjectionStrategy"
            Type="dropdownlist"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="IsRestricted"
            Type="checkbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="MessageMode"
            Type="dropdownlist"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="MaxMessages"
            Type="numerictextbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="Parent"
            Type="textbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="ContextCompressionPrompt"
            Type="textbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="Type"
            Type="textbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="DefaultArtifactType"
            Type="textbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="OwnerUser"
            Type="textbox"
            [EditMode]="EditMode"
        ></mj-form-field>
        <mj-form-field 
            [record]="record"
            [ShowLabel]="true"
            FieldName="RootParentID"
            Type="textbox"
            [EditMode]="EditMode"
        ></mj-form-field>

                </div>
            </div>
        </div>

        <!-- AIAgent Actions Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="aiagent actions">
            <div class="collapsible-header" (click)="toggleSection('aIAgentActions')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>AIAgent Actions</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.aIAgentActions ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.aIAgentActions" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('AI Agent Actions','AgentID')"  
                        [NewRecordValues]="NewRecordValues('AI Agent Actions')"
                        [AllowLoad]="IsCurrentTab('AIAgent Actions')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- AIAgent Learning Cycles Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="aiagent learning cycles">
            <div class="collapsible-header" (click)="toggleSection('aIAgentLearningCycles')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>AIAgent Learning Cycles</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.aIAgentLearningCycles ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.aIAgentLearningCycles" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('AI Agent Learning Cycles','AgentID')"  
                        [NewRecordValues]="NewRecordValues('AI Agent Learning Cycles')"
                        [AllowLoad]="IsCurrentTab('AIAgent Learning Cycles')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- AIAgent Models Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="aiagent models">
            <div class="collapsible-header" (click)="toggleSection('aIAgentModels')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>AIAgent Models</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.aIAgentModels ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.aIAgentModels" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('AI Agent Models','AgentID')"  
                        [NewRecordValues]="NewRecordValues('AI Agent Models')"
                        [AllowLoad]="IsCurrentTab('AIAgent Models')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- AI Agent Requests Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="ai agent requests">
            <div class="collapsible-header" (click)="toggleSection('aIAgentRequests')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>AI Agent Requests</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.aIAgentRequests ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.aIAgentRequests" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('AI Agent Requests','AgentID')"  
                        [NewRecordValues]="NewRecordValues('AI Agent Requests')"
                        [AllowLoad]="IsCurrentTab('AI Agent Requests')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- MJ: AI Agent Artifact Types Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="mj: ai agent artifact types">
            <div class="collapsible-header" (click)="toggleSection('mJAIAgentArtifactTypes')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>MJ: AI Agent Artifact Types</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.mJAIAgentArtifactTypes ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.mJAIAgentArtifactTypes" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('MJ: AI Agent Artifact Types','AgentID')"  
                        [NewRecordValues]="NewRecordValues('MJ: AI Agent Artifact Types')"
                        [AllowLoad]="IsCurrentTab('MJ: AI Agent Artifact Types')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- MJ: AI Agent Data Sources Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="mj: ai agent data sources">
            <div class="collapsible-header" (click)="toggleSection('mJAIAgentDataSources')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>MJ: AI Agent Data Sources</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.mJAIAgentDataSources ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.mJAIAgentDataSources" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('MJ: AI Agent Data Sources','AgentID')"  
                        [NewRecordValues]="NewRecordValues('MJ: AI Agent Data Sources')"
                        [AllowLoad]="IsCurrentTab('MJ: AI Agent Data Sources')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- MJ: AI Agent Permissions Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="mj: ai agent permissions">
            <div class="collapsible-header" (click)="toggleSection('mJAIAgentPermissions')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>MJ: AI Agent Permissions</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.mJAIAgentPermissions ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.mJAIAgentPermissions" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('MJ: AI Agent Permissions','AgentID')"  
                        [NewRecordValues]="NewRecordValues('MJ: AI Agent Permissions')"
                        [AllowLoad]="IsCurrentTab('MJ: AI Agent Permissions')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- MJ: AI Agent Relationships Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="mj: ai agent relationships">
            <div class="collapsible-header" (click)="toggleSection('mJAIAgentRelationships')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>MJ: AI Agent Relationships</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.mJAIAgentRelationships ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.mJAIAgentRelationships" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('MJ: AI Agent Relationships','AgentID')"  
                        [NewRecordValues]="NewRecordValues('MJ: AI Agent Relationships')"
                        [AllowLoad]="IsCurrentTab('MJ: AI Agent Relationships')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- MJ: AI Agent Steps Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="mj: ai agent steps">
            <div class="collapsible-header" (click)="toggleSection('mJAIAgentSteps')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>MJ: AI Agent Steps</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.mJAIAgentSteps ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.mJAIAgentSteps" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('MJ: AI Agent Steps','AgentID')"  
                        [NewRecordValues]="NewRecordValues('MJ: AI Agent Steps')"
                        [AllowLoad]="IsCurrentTab('MJ: AI Agent Steps')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- AIAgent Notes Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="aiagent notes">
            <div class="collapsible-header" (click)="toggleSection('aIAgentNotes')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>AIAgent Notes</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.aIAgentNotes ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.aIAgentNotes" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('AI Agent Notes','AgentID')"  
                        [NewRecordValues]="NewRecordValues('AI Agent Notes')"
                        [AllowLoad]="IsCurrentTab('AIAgent Notes')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- MJ: AI Agent Examples Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="mj: ai agent examples">
            <div class="collapsible-header" (click)="toggleSection('mJAIAgentExamples')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>MJ: AI Agent Examples</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.mJAIAgentExamples ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.mJAIAgentExamples" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('MJ: AI Agent Examples','AgentID')"  
                        [NewRecordValues]="NewRecordValues('MJ: AI Agent Examples')"
                        [AllowLoad]="IsCurrentTab('MJ: AI Agent Examples')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- MJ: AI Agent Prompts Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="mj: ai agent prompts">
            <div class="collapsible-header" (click)="toggleSection('mJAIAgentPrompts')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>MJ: AI Agent Prompts</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.mJAIAgentPrompts ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.mJAIAgentPrompts" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('MJ: AI Agent Prompts','AgentID')"  
                        [NewRecordValues]="NewRecordValues('MJ: AI Agent Prompts')"
                        [AllowLoad]="IsCurrentTab('MJ: AI Agent Prompts')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- MJ: AI Agent Relationships Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="mj: ai agent relationships">
            <div class="collapsible-header" (click)="toggleSection('mJAIAgentRelationships')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>MJ: AI Agent Relationships</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.mJAIAgentRelationships ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.mJAIAgentRelationships" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('MJ: AI Agent Relationships','SubAgentID')"  
                        [NewRecordValues]="NewRecordValues('MJ: AI Agent Relationships')"
                        [AllowLoad]="IsCurrentTab('MJ: AI Agent Relationships')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- MJ: AI Agent Runs Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="mj: ai agent runs">
            <div class="collapsible-header" (click)="toggleSection('mJAIAgentRuns')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>MJ: AI Agent Runs</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.mJAIAgentRuns ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.mJAIAgentRuns" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('MJ: AI Agent Runs','AgentID')"  
                        [NewRecordValues]="NewRecordValues('MJ: AI Agent Runs')"
                        [AllowLoad]="IsCurrentTab('MJ: AI Agent Runs')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- MJ: AI Agent Steps Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="mj: ai agent steps">
            <div class="collapsible-header" (click)="toggleSection('mJAIAgentSteps')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>MJ: AI Agent Steps</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.mJAIAgentSteps ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.mJAIAgentSteps" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('MJ: AI Agent Steps','SubAgentID')"  
                        [NewRecordValues]="NewRecordValues('MJ: AI Agent Steps')"
                        [AllowLoad]="IsCurrentTab('MJ: AI Agent Steps')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- MJ: Tasks Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="mj: tasks">
            <div class="collapsible-header" (click)="toggleSection('mJTasks')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>MJ: Tasks</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.mJTasks ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.mJTasks" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('MJ: Tasks','AgentID')"  
                        [NewRecordValues]="NewRecordValues('MJ: Tasks')"
                        [AllowLoad]="IsCurrentTab('MJ: Tasks')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- AI Result Cache Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="ai result cache">
            <div class="collapsible-header" (click)="toggleSection('aIResultCache')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>AI Result Cache</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.aIResultCache ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.aIResultCache" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('AI Result Cache','AgentID')"  
                        [NewRecordValues]="NewRecordValues('AI Result Cache')"
                        [AllowLoad]="IsCurrentTab('AI Result Cache')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- MJ: AI Prompt Runs Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="mj: ai prompt runs">
            <div class="collapsible-header" (click)="toggleSection('mJAIPromptRuns')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>MJ: AI Prompt Runs</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.mJAIPromptRuns ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.mJAIPromptRuns" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('MJ: AI Prompt Runs','AgentID')"  
                        [NewRecordValues]="NewRecordValues('MJ: AI Prompt Runs')"
                        [AllowLoad]="IsCurrentTab('MJ: AI Prompt Runs')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- Conversation Details Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="conversation details">
            <div class="collapsible-header" (click)="toggleSection('conversationDetails')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>Conversation Details</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.conversationDetails ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.conversationDetails" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('Conversation Details','AgentID')"  
                        [NewRecordValues]="NewRecordValues('Conversation Details')"
                        [AllowLoad]="IsCurrentTab('Conversation Details')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>

        <!-- AI Agents Section -->
        <div class="form-card collapsible-card related-entity" data-section-name="ai agents">
            <div class="collapsible-header" (click)="toggleSection('aIAgents')" role="button" tabindex="0">
                <div class="collapsible-title">
                    <i class="fa fa-table"></i>
                    <h3>AI Agents</h3>
                </div>
                <div class="collapse-icon">
                    <i [class]="sectionsExpanded.aIAgents ? 'fa fa-chevron-up' : 'fa fa-chevron-down'"></i>
                </div>
            </div>
            <div class="collapsible-body" [class.collapsed]="!sectionsExpanded.aIAgents" *ngIf="record.IsSaved">
                <div class="form-body">
                    <mj-user-view-grid 
                        [Params]="BuildRelationshipViewParamsByEntityName('AI Agents','ParentID')"  
                        [NewRecordValues]="NewRecordValues('AI Agents')"
                        [AllowLoad]="IsCurrentTab('AI Agents')"  
                        [EditMode]="GridEditMode()"  
                        >
                    </mj-user-view-grid>
                </div>
            </div>
        </div>
        </div>
    </form>
</div>
        