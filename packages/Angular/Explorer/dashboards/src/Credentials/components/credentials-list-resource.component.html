<div class="list-container">
    <mj-loading *ngIf="isLoading" text="Loading credentials..."></mj-loading>

    <ng-container *ngIf="!isLoading">
        <!-- Toolbar -->
        <div class="toolbar">
            <div class="search-container">
                <i class="fa-solid fa-search"></i>
                <input
                    type="text"
                    placeholder="Search credentials..."
                    [value]="searchText"
                    (input)="onSearchChange($any($event.target).value)"
                />
            </div>

            <div class="filters">
                <select
                    class="filter-select"
                    [value]="selectedTypeFilter"
                    (change)="onTypeFilterChange($any($event.target).value)"
                >
                    <option value="">All Types</option>
                    <option *ngFor="let type of types" [value]="type.ID">{{type.Name}}</option>
                </select>

                <label class="filter-checkbox">
                    <input
                        type="checkbox"
                        [checked]="showActiveOnly"
                        (change)="onActiveFilterChange($any($event.target).checked)"
                    />
                    <span>Active Only</span>
                </label>

                <button class="refresh-btn" (click)="refresh()" title="Refresh">
                    <i class="fa-solid fa-refresh"></i>
                </button>
            </div>
        </div>

        <!-- Results Count -->
        <div class="results-info">
            Showing {{filteredCredentials.length}} of {{credentials.length}} credentials
        </div>

        <!-- Credentials Grid -->
        <div class="credentials-grid" *ngIf="filteredCredentials.length > 0">
            <div class="credential-card" *ngFor="let credential of filteredCredentials">
                <div class="card-header">
                    <div class="card-icon" [ngClass]="getStatusClass(credential)">
                        <i [class]="credential.IconClass || 'fa-solid fa-key'"></i>
                    </div>
                    <div class="card-title">
                        <div class="credential-name">{{credential.Name}}</div>
                        <div class="credential-type">{{credential.CredentialType || 'Unknown Type'}}</div>
                    </div>
                    <div class="status-badge" [ngClass]="getStatusClass(credential)">
                        {{getStatusLabel(credential)}}
                    </div>
                </div>

                <div class="card-body">
                    <p class="credential-description" *ngIf="credential.Description">
                        {{credential.Description}}
                    </p>

                    <div class="credential-meta">
                        <div class="meta-item" *ngIf="credential.IsDefault">
                            <i class="fa-solid fa-star"></i>
                            <span>Default</span>
                        </div>
                        <div class="meta-item" *ngIf="credential.ExpiresAt">
                            <i class="fa-solid fa-calendar"></i>
                            <span>Expires: {{formatDate(credential.ExpiresAt)}}</span>
                        </div>
                        <div class="meta-item" *ngIf="credential.LastUsedAt">
                            <i class="fa-solid fa-clock"></i>
                            <span>Last used: {{formatDate(credential.LastUsedAt)}}</span>
                        </div>
                    </div>
                </div>

                <div class="card-footer">
                    <div class="category-tag" *ngIf="credential.Category">
                        {{credential.Category}}
                    </div>
                </div>
            </div>
        </div>

        <!-- Empty State -->
        <div class="empty-state" *ngIf="filteredCredentials.length === 0">
            <i class="fa-solid fa-key"></i>
            <h3>No Credentials Found</h3>
            <p *ngIf="searchText || selectedTypeFilter">Try adjusting your filters</p>
            <p *ngIf="!searchText && !selectedTypeFilter">No credentials have been configured yet</p>
        </div>
    </ng-container>
</div>
