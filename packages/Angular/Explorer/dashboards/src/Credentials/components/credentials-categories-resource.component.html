<div class="categories-container">
    <mj-loading *ngIf="isLoading" text="Loading categories..."></mj-loading>

    <ng-container *ngIf="!isLoading">
        <div class="categories-header">
            <h2>
                <i class="fa-solid fa-folder-tree"></i>
                Category Hierarchy
            </h2>
            <span class="category-count">{{categories.length}} categories</span>
        </div>

        <div class="tree-container" *ngIf="categoryTree.length > 0">
            <div
                class="tree-node"
                *ngFor="let node of getFlattenedNodes()"
                [style.padding-left.px]="24 + (node.level * 24)"
            >
                <div class="node-content">
                    <button
                        class="expand-btn"
                        *ngIf="node.children.length > 0"
                        (click)="toggleExpand(node)"
                    >
                        <i [class]="node.expanded ? 'fa-solid fa-chevron-down' : 'fa-solid fa-chevron-right'"></i>
                    </button>
                    <span class="expand-placeholder" *ngIf="node.children.length === 0"></span>

                    <div class="node-icon">
                        <i [class]="node.category.IconClass || 'fa-solid fa-folder'"></i>
                    </div>

                    <div class="node-info">
                        <div class="node-name">{{node.category.Name}}</div>
                        <div class="node-description" *ngIf="node.category.Description">
                            {{node.category.Description}}
                        </div>
                    </div>

                    <div class="node-badges">
                        <span class="badge children" *ngIf="node.children.length > 0">
                            {{node.children.length}} subcategories
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <div class="empty-state" *ngIf="categoryTree.length === 0">
            <i class="fa-solid fa-folder-open"></i>
            <h3>No Categories</h3>
            <p>No credential categories have been configured yet</p>
        </div>
    </ng-container>
</div>
