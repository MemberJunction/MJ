<div class="component-studio-simple">
  <!-- Header -->
  <div class="dashboard-header">
    <div class="header-content">
      <h1><i class="fa-solid fa-puzzle-piece"></i> Component Studio</h1>
      <button kendoButton [icon]="'fa-solid fa-sync'" (click)="refreshData()" [disabled]="isLoading">
        Refresh
      </button>
    </div>
  </div>

  <!-- Main Content with Splitter -->
  <kendo-splitter orientation="horizontal" style="flex: 1; height: auto;">
    <!-- Left Panel - Component List -->
    <kendo-splitter-pane [min]="'300px'" [max]="'600px'">
      <div class="components-panel">
        <div class="panel-header">
          <h3>Components</h3>
          <div class="search-box">
            <kendo-textbox 
              [value]="searchQuery"
              (valueChange)="onSearchChange($event)"
              placeholder="Search components..."
              [clearButton]="true">
              <ng-template kendoTextBoxPrefixTemplate>
                <i class="fa-solid fa-search"></i>
              </ng-template>
            </kendo-textbox>
          </div>
        </div>
        
        <div class="components-list">
          @if (isLoading) {
            <div class="loading-message">
              <i class="fa-solid fa-spinner fa-spin"></i> Loading components...
            </div>
          } @else if (filteredComponents.length === 0) {
            <div class="empty-message">
              No components found
            </div>
          } @else {
            @for (component of filteredComponents; track component.ID) {
              <div class="component-item" 
                [class.selected]="selectedComponent?.ID === component.ID"
                (click)="selectComponent(component)">
                <div class="component-icon" [style.color]="getComponentTypeColor(component.Type)">
                  <i class="fa-solid" [ngClass]="getComponentTypeIcon(component.Type)"></i>
                </div>
                <div class="component-info">
                  <div class="component-name">{{ component.Name }}</div>
                  <div class="component-type">{{ component.Type || 'Unknown' }} â€¢ v{{ component.Version || '1.0.0' }}</div>
                </div>
              </div>
            }
          }
        </div>
      </div>
    </kendo-splitter-pane>

    <!-- Right Panel - Component Preview -->
    <kendo-splitter-pane [min]="'400px'">
      <div class="preview-panel">
        @if (selectedComponent) {
          <div class="preview-header">
            <h3>{{ selectedComponent.Name }}</h3>
            <div class="preview-actions">
              <button kendoButton 
                [icon]="'fa-solid fa-play'" 
                [themeColor]="'primary'"
                (click)="runComponent()">
                Run Component
              </button>
            </div>
          </div>
          
          <div class="preview-content">
            <div class="component-details">
              <div class="detail-row">
                <label>Type:</label>
                <span>{{ selectedComponent.Type || 'Unknown' }}</span>
              </div>
              <div class="detail-row">
                <label>Version:</label>
                <span>{{ selectedComponent.Version || '1.0.0' }}</span>
              </div>
              <div class="detail-row">
                <label>Status:</label>
                <span class="status-badge" [class.published]="selectedComponent.Status === 'Published'">
                  {{ selectedComponent.Status || 'Draft' }}
                </span>
              </div>
              @if (selectedComponent.Description) {
                <div class="detail-row full-width">
                  <label>Description:</label>
                  <p>{{ selectedComponent.Description }}</p>
                </div>
              }
            </div>
            
            @if (showPreview && componentSpec) {
              <div class="component-runtime">
                <div class="runtime-header">
                  <h4>Component Preview</h4>
                </div>
                <div class="runtime-container">
                  @if (currentError) {
                    <!-- Error display -->
                    <div class="error-display">
                      <div class="error-container">
                        <div class="error-header">
                          <i class="fa-solid fa-exclamation-triangle"></i>
                          <h3>Component Error</h3>
                          <button class="copy-button" (click)="copyErrorToClipboard()" title="Copy error details">
                            <i class="fa-solid fa-copy"></i>
                          </button>
                        </div>
                        
                        <p class="error-intro">
                          The component could not be rendered due to the following error:
                        </p>
                        
                        <div class="error-details">
                          <strong>Error Type:</strong> {{ currentError.type }}<br>
                          <strong>Message:</strong> {{ currentError.message }}
                          @if (currentError.technicalDetails) {
                            <details class="technical-details">
                              <summary>Technical Details (click to expand)</summary>
                              <pre>{{ formatTechnicalDetails(currentError.technicalDetails) }}</pre>
                            </details>
                          }
                        </div>
                        
                        <div class="error-help">
                          <strong>What to do:</strong>
                          <ol>
                            <li>Check that the component code is valid JavaScript/React</li>
                            <li>Ensure all required dependencies are available</li>
                            <li>Review the technical details for specific error information</li>
                            <li>Contact your system administrator if the issue persists</li>
                          </ol>
                        </div>
                        
                        <div class="error-actions">
                          <button kendoButton (click)="retryComponent()" [icon]="'fa-solid fa-rotate'">
                            Retry
                          </button>
                        </div>
                      </div>
                    </div>
                  } @else {
                    <mj-react-component 
                      [component]="componentSpec"
                      (componentEvent)="onComponentEvent($event)">
                    </mj-react-component>
                  }
                </div>
              </div>
            }
          </div>
        } @else {
          <div class="no-selection">
            <i class="fa-solid fa-hand-pointer fa-3x"></i>
            <p>Select a component from the list to preview</p>
          </div>
        }
      </div>
    </kendo-splitter-pane>
  </kendo-splitter>
</div>