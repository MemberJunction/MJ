<div class="query-grid-wrap" mjFillContainer>
    <kendo-grid #kendoGrid
        mjFillContainer
        [resizable]="true"
        [data]="gridView" 
        [skip]="skip"
        [pageSize]="pageSize"
        scrollable="virtual"
        [rowHeight]="36"
        (pageChange)="pageChange($event)"
        [loading]="isLoading"
        [height]="gridHeight"
        [sortable]="true"
        [resizable]="true"
        [reorderable]="true"
        [selectable]="true"
        kendoGridSelectBy
        [(selectedKeys)]="selectedKeys"
        (cellClick)="cellClickHandler($event)"
        >
        <ng-template kendoGridToolbarTemplate>
            <button fillMode="outline" themeColor="info" kendoButton (click)="doExcelExport()" >
                <span class="fa-regular fa-file-excel"></span>Export to Excel
            </button>
            <button
                kendoButton
                
                themeColor="info"
                *ngIf="showRefreshButton"
                (click)="RefreshFromSavedParams()" >
                Refresh
                <span class="fa-solid fa-arrow-rotate-left"></span>
            </button>
        </ng-template>

        <kendo-excelexport #excelExport [data]="exportData" [fileName]="Params?.QueryID + '_Query.xlsx'">
            <kendo-excelexport-column *ngFor="let exportCol of queryColumns()" [field]="exportCol" [title]="exportCol">
            </kendo-excelexport-column>
        </kendo-excelexport>
    </kendo-grid>
</div>
 