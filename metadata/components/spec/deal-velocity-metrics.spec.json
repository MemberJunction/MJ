{
  "name": "DealVelocityMetrics",
  "namespace": "CRM/Analytics",
  "type": "Metrics",
  "location": "embedded",
  "code": "@file:../code/deal-velocity-metrics.js",
  "functionalRequirements": "## Deal Velocity Metrics\n\n### Purpose\nAnalyze and visualize the speed of deals through the sales pipeline with detailed stage-by-stage metrics.\n\n### Core Features\n- **Stage Duration Analysis**: Time spent in each stage\n- **Bottleneck Detection**: Identify slow-moving stages\n- **Trend Analysis**: Historical velocity changes\n- **Rep Comparison**: Compare velocity across team\n- **Cohort Analysis**: Group deals by characteristics\n- **Interactive Heatmap**: Using ECharts for visualization\n- **Slide-out Details**: Deep dive into specific metrics\n- **Export Capabilities**: Download metrics as CSV\n- **Advanced Filtering**: \n  - Preset date ranges (7/30/90 days, this year, last year, all time)\n  - Custom date range picker with start and end dates\n  - Quick preset buttons for custom mode\n  - Date range summary display\n\n### Visualizations\n- Heatmap showing stage durations\n- Line charts for trend analysis\n- Box plots for distribution\n- Comparison matrices",
  "dataRequirements": {
    "mode": "views",
    "entities": [
      {
        "name": "Deals",
        "displayFields": ["DealName", "Stage", "Amount", "Probability", "CloseDate", "ActualCloseDate", "__mj_CreatedAt", "__mj_UpdatedAt"],
        "filterFields": ["Stage", "ActualCloseDate", "CloseDate"],
        "sortFields": ["ActualCloseDate", "CloseDate", "Amount"] 
      }
    ]
  },
  "technicalDesign": "## Implementation\n\n### Components\n- Main: DealVelocityMetrics\n- Sub-components:\n  - VelocityHeatmap: Stage duration visualization\n  - TrendChart: Historical trends\n  - RepComparison: Team performance\n  - MetricsExport: CSV export functionality\n\n### Data Processing\n- Calculate stage durations\n- Identify outliers and bottlenecks\n- Generate cohort groupings\n- Statistical analysis",
  "properties": [],
  "events": [],
  "dependencies": [
    "@include:deal-velocity-trend-chart.spec.json",
    "@include:deal-velocity-distribution-chart.spec.json",
    "@include:data-export-panel.spec.json"
  ],
  "libraries": [
    {
      "name": "ECharts",
      "version": "^5.4.3",
      "globalVariable": "echarts"
    },
    {
      "name": "papaparse",
      "version": "^5.4.1",
      "globalVariable": "Papa"
    },
    {
      "name": "simple-statistics",
      "version": "^7.8.3",
      "globalVariable": "ss"
    },
    {
      "name": "dayjs",
      "version": "^1.11.10",
      "globalVariable": "dayjs"
    }
  ]
}