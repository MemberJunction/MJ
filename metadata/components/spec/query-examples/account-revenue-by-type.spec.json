{
  "name": "AccountRevenueByType",
  "title": "Account Revenue by Type",
  "type": "chart",
  "userExplanation": "Shows revenue breakdown by account type (Enterprise, SMB, Individual, etc.) with click-to-drill-down functionality. Click any chart segment to view detailed invoice records for that account type using EntityDataGrid. Demonstrates the fundamental hybrid pattern: RunQuery for aggregated chart data + EntityDataGrid for automatic drill-down.",
  "functionalRequirements": "## Business Objectives\n- Visualize revenue distribution across different account types\n- Identify which account types generate the most revenue\n- Enable quick drill-down to see invoice details for any account type\n- Demonstrate the core hybrid pattern for educational purposes\n\n## Functional Requirements\n- **Revenue Chart**: Display pie or bar chart showing total revenue by account type\n- **Account Count**: Show number of accounts in each type (in tooltip or segment label)\n- **Click-to-Drill-Down**: When user clicks chart segment, display EntityDataGrid with invoices for that account type\n- **Automatic Filtering**: EntityDataGrid automatically filters to selected account type using SQL filter\n- **Invoice Details**: Show invoice number, date, account name, total, and status in grid\n- **Grid Features**: EntityDataGrid provides automatic pagination, sorting, filtering, and OpenEntityRecord\n- **Clear Selection**: Provide button/action to clear selection and return to chart-only view\n- **Highlight Selection**: Visual feedback showing which segment is currently selected\n- **Chart Type Options**: Support switching between pie, doughnut, and bar chart types\n- **Loading States**: Show loading indicator while data loads\n- **Empty States**: Handle cases with no revenue data",
  "dataRequirements": {
    "mode": "hybrid",
    "queries": [
      {
        "name": "Account Revenue by Type",
        "categoryPath": "Demo",
        "description": "Aggregates total revenue by AccountType. Joins Account → AccountType → Invoice where Status='Paid'. Returns AccountType, AccountCount, TotalRevenue for chart.",
        "entityNames": ["Accounts", "Account Types", "Invoices"],
        "fields": [],
        "parameters": []
      }
    ],
    "entities": [
      {
        "name": "Invoices",
        "description": "Invoice records shown in EntityDataGrid when drilling down from account type chart segment.",
        "displayFields": ["InvoiceNumber", "InvoiceDate", "AccountName", "TotalAmount", "Status", "AmountPaid", "BalanceDue"],
        "filterFields": ["AccountID", "Status"],
        "sortFields": ["InvoiceDate", "TotalAmount"],
        "usageContext": "Loaded by EntityDataGrid using SQL filter: AccountID IN (SELECT ID FROM Account WHERE AccountTypeID = '{selectedTypeId}')"
      }
    ]
  },
  "properties": [],
  "events": [],
  "dependencies": [
    {
      "name": "SimpleChart",
      "location": "registry",
      "namespace": "Generic/UI/Chart",
      "version": "^1.0.0"
    },
    {
      "name": "EntityDataGrid",
      "location": "registry",
      "namespace": "Generic/UI/Table",
      "version": "^1.0.0"
    }
  ],
  "location": "embedded",
  "technicalDesign": "",
  "code": "@file:../../code/query-examples/account-revenue-by-type.js",
  "exampleUsage": ""
}