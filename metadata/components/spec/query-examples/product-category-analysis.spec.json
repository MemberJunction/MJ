{
  "name": "ProductCategoryAnalysis",
  "title": "Product Category Analysis",
  "type": "dashboard",
  "userExplanation": "Comprehensive product category performance dashboard with dual drill-down paths. Shows category revenue totals, then when a category is selected, displays both top products in that category and all invoice line items. Demonstrates progressive disclosure: Category → Products → Line Items.",
  "functionalRequirements": "## Business Objectives\n- Analyze revenue performance across product categories\n- Identify top-performing products within each category\n- Enable drill-down to see individual line item sales\n- Demonstrate multi-level drill-down with conditional query execution\n\n## Functional Requirements\n- **Category Overview**: Bar chart showing total revenue by product category\n- **Category Metrics**: Display product count, average revenue, and total revenue per category\n- **Primary Drill-Down**: When user clicks category, show two panels side-by-side\n- **Top Products Panel**: Run conditional query showing top 5 products in selected category (by revenue)\n- **Line Items Panel**: EntityDataGrid showing all invoice line items for products in selected category\n- **Secondary Drill-Down**: When user clicks a product in top products list, filter line items grid to that specific product\n- **Conditional Query**: Top products query only executes when category is selected (performance optimization)\n- **Back Navigation**: Clear selection button returns to category overview\n- **Breadcrumb Trail**: Show current selection path (Category → Product)\n- **State Management**: Track both category selection and optional product selection\n- **Loading States**: Show loading for conditional queries\n- **Empty States**: Handle categories with no products or line items",
  "dataRequirements": {
    "mode": "hybrid",
    "queries": [
      {
        "name": "Category Totals",
        "categoryPath": "Demo",
        "description": "Category-level aggregates: SUM(Revenue), COUNT(DISTINCT ProductID), AVG(Revenue) grouped by CategoryName. Returns ~10-15 category summary rows for bar chart.",
        "entityNames": ["Products", "Invoice Line Items"],
        "fields": [],
        "parameters": []
      },
      {
        "name": "Category Top Products",
        "categoryPath": "Demo",
        "description": "Conditional query (executes when category selected): TOP 5 products by revenue in selected category. Returns ProductName, Revenue for top products list.",
        "entityNames": ["Products", "Invoice Line Items"],
        "fields": [],
        "parameters": []
      }
    ],
    "entities": [
      {
        "name": "Invoice Line Items",
        "description": "Line item records shown in EntityDataGrid for selected category or product. Primary drill-down entity for sales detail.",
        "displayFields": ["InvoiceDate", "ProductName", "Quantity", "UnitPrice", "Total", "AccountName"],
        "filterFields": ["ProductID", "CategoryName"],
        "sortFields": ["InvoiceDate", "Total"],
        "usageContext": "EntityDataGrid 1: Filter by ProductID IN (SELECT ID FROM Product WHERE Category = '{selected}'). EntityDataGrid 2 (nested): Filter by ProductID = '{selectedProductId}'"
      }
    ]
  },
  "properties": [],
  "events": [],
  "dependencies": [
    {
      "name": "SimpleChart",
      "location": "registry",
      "namespace": "Generic/UI/Chart",
      "version": "^1.0.0"
    },
    {
      "name": "EntityDataGrid",
      "location": "registry",
      "namespace": "Generic/UI/Table",
      "version": "^1.0.0"
    }
  ],
  "location": "embedded",
  "technicalDesign": "",
  "code": "@file:../../code/query-examples/product-category-analysis.js",
  "exampleUsage": ""
}