<div class="review-process">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <mat-spinner diameter="40"></mat-spinner>
    <p>Loading review data...</p>
  </div>
  
  <!-- Review Content -->
  <div *ngIf="!isLoading" class="review-content">
    
    <!-- AI Evaluation Section -->
    <div *ngIf="config.showAIEvaluation && aiEvaluation" class="ai-evaluation-section">
      <mat-card class="evaluation-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>smart_toy</mat-icon>
            AI Evaluation
          </mat-card-title>
          <div class="evaluation-score">
            <span class="score-value" [style.color]="getScoreColor(aiEvaluation.score)">
              {{ aiEvaluation.score }}/10
            </span>
            <span class="confidence-level">
              {{ getConfidenceLevel(aiEvaluation.confidence) }} confidence
            </span>
          </div>
        </mat-card-header>
        <mat-card-content>
          <!-- Score and Confidence -->
          <div class="score-section">
            <div class="score-metrics">
              <div class="metric">
                <span class="metric-label">Overall Score</span>
                <div class="score-display">
                  <mat-progress-bar 
                    mode="determinate" 
                    [value]="aiEvaluation.score * 10"
                    [color]="getScoreColor(aiEvaluation.score)">
                  </mat-progress-bar>
                  <span class="score-text" [style.color]="getScoreColor(aiEvaluation.score)">
                    {{ aiEvaluation.score }}/10
                  </span>
                </div>
              </div>
              
              <div class="metric">
                <span class="metric-label">Confidence</span>
                <div class="confidence-display">
                  <mat-progress-bar 
                    mode="determinate" 
                    [value]="aiEvaluation.confidence * 100">
                  </mat-progress-bar>
                  <span class="confidence-text">
                    {{ Math.round(aiEvaluation.confidence * 100) }}%
                  </span>
                </div>
              </div>
            </div>
          </div>
          
          <!-- AI Feedback -->
          <div class="feedback-section">
            <h4>AI Feedback</h4>
            <div class="feedback-content" [innerHTML]="sanitizeHtml(aiEvaluation.feedback)"></div>
          </div>
          
          <!-- Strengths and Weaknesses -->
          <div class="analysis-section">
            <div class="strengths">
              <h5>
                <mat-icon>add_circle</mat-icon>
                Strengths
              </h5>
              <ul>
                <li *ngFor="let strength of aiEvaluation.strengths">{{ strength }}</li>
              </ul>
            </div>
            
            <div class="weaknesses">
              <h5>
                <mat-icon>remove_circle</mat-icon>
                Areas for Improvement
              </h5>
              <ul>
                <li *ngFor="let weakness of aiEvaluation.weaknesses">{{ weakness }}</li>
              </ul>
            </div>
          </div>
          
          <!-- Recommendations -->
          <div class="recommendations-section" *ngIf="aiEvaluation.recommendations.length > 0">
            <h5>
              <mat-icon>lightbulb</mat-icon>
              Recommendations
            </h5>
            <ul>
              <li *ngFor="let recommendation of aiEvaluation.recommendations">{{ recommendation }}</li>
            </ul>
          </div>
          
          <!-- Evaluation Metadata -->
          <div class="evaluation-metadata">
            <div class="metadata-item">
              <mat-icon>schedule</mat-icon>
              <span>Evaluated on {{ formatDate(aiEvaluation.evaluatedAt) }}</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
    
    <!-- Human Reviews Section -->
    <div *ngIf="config.showHumanReviews" class="human-reviews-section">
      <mat-card class="reviews-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>rate_review</mat-icon>
            Human Reviews
          </mat-card-title>
          <div class="reviews-summary">
            <span class="average-score">
              Average: {{ getAverageReviewScore() }}/10
            </span>
            <mat-chip 
              [color]="getRecommendationColor(getReviewConsensus())"
              [style.color]="'white'">
              {{ getReviewConsensus() }}
            </mat-chip>
          </div>
        </mat-card-header>
        <mat-card-content>
          <!-- Reviews List -->
          <div *ngIf="humanReviews.length > 0" class="reviews-list">
            <div *ngFor="let review of humanReviews; let i = index" 
                 class="review-item"
                 [class.last-review]="i === humanReviews.length - 1">
              
              <!-- Review Header -->
              <div class="review-header">
                <div class="reviewer-info">
                  <div class="reviewer-avatar">
                    {{ review.reviewerName.charAt(0) }}
                  </div>
                  <div class="reviewer-details">
                    <div class="reviewer-name">{{ review.reviewerName }}</div>
                    <div class="review-date">{{ formatDate(review.reviewedAt) }}</div>
                  </div>
                </div>
                
                <div class="review-rating">
                  <div class="rating-score" [style.color]="getScoreColor(review.rating)">
                    {{ review.rating }}/10
                  </div>
                  <mat-chip 
                    [color]="getRecommendationColor(review.recommendation)"
                    [style.color]="'white'">
                    <mat-icon>{{ getRecommendationIcon(review.recommendation) }}</mat-icon>
                    {{ review.recommendation.replace('-', ' ').toUpperCase() }}
                  </mat-chip>
                </div>
              </div>
              
              <!-- Review Comments -->
              <div class="review-comments">
                <div class="comments-content" [innerHTML]="sanitizeHtml(review.comments)"></div>
              </div>
            </div>
          </div>
          
          <!-- No Reviews State -->
          <div *ngIf="humanReviews.length === 0" class="no-reviews">
            <mat-icon>rate_review</mat-icon>
            <h4>No Human Reviews Yet</h4>
            <p>This submission hasn't been reviewed by committee members yet.</p>
          </div>
          
          <!-- Add Review Button -->
          <div *ngIf="config.allowNewReview" class="add-review-section">
            <button mat-raised-button color="primary" (click)="toggleNewReviewForm()">
              <mat-icon>add_comment</mat-icon>
              Add Review
            </button>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
    
    <!-- Review Summary -->
    <div *ngIf="config.showAIEvaluation && config.showHumanReviews" class="review-summary-section">
      <mat-card class="summary-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>summarize</mat-icon>
            Review Summary
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="summary-grid">
            <div class="summary-item">
              <span class="summary-label">AI Score</span>
              <span class="summary-value" [style.color]="getScoreColor(aiEvaluation?.score || 0)">
                {{ aiEvaluation?.score || 0 }}/10
              </span>
            </div>
            
            <div class="summary-item">
              <span class="summary-label">Human Average</span>
              <span class="summary-value" [style.color]="getScoreColor(getAverageReviewScore())">
                {{ getAverageReviewScore() }}/10
              </span>
            </div>
            
            <div class="summary-item">
              <span class="summary-label">Total Reviews</span>
              <span class="summary-value">{{ humanReviews.length }}</span>
            </div>
            
            <div class="summary-item">
              <span class="summary-label">Consensus</span>
              <span class="summary-value" [style.color]="getRecommendationColor(getReviewConsensus())">
                {{ getReviewConsensus() }}
              </span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
  
  <!-- Empty State -->
  <div *ngIf="!isLoading && !aiEvaluation && humanReviews.length === 0" class="empty-state">
    <mat-icon>rate_review</mat-icon>
    <h3>No Review Data</h3>
    <p>Unable to load review information for this submission.</p>
    <button mat-stroked-button (click)="loadReviewData()">
      <mat-icon>refresh</mat-icon>
      Retry
    </button>
  </div>
</div>
