SELECT m.ID, m.FirstName, m.LastName, m.Email, m.Phone, m.Organization, m.EngagementScore, m.LastActivityDate, ms.Status AS MembershipStatus, ms.EndDate AS MembershipEndDate, ms.CancellationDate, ms.CancellationReason, DATEDIFF(DAY, ms.EndDate, GETDATE()) AS DaysSinceExpiration FROM [AssociationDemo].[vwMembers] m INNER JOIN [AssociationDemo].[vwMemberships] ms ON m.ID = ms.MemberID WHERE m.EngagementScore >= {{ minEngagementScore | sqlNumber }} AND ms.Status != 'Active' ORDER BY m.EngagementScore DESC