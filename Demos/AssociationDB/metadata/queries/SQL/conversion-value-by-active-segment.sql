SELECT s.ID, s.Name AS SegmentName, s.SegmentType, COUNT(DISTINCT cm.ID) AS ConvertedMembers, SUM(cm.ConversionValue) AS TotalConversionValue, AVG(cm.ConversionValue) AS AvgConversionValue FROM [AssociationDemo].[vwSegments] s INNER JOIN [AssociationDemo].[vwCampaignMembers] cm ON s.ID = cm.SegmentID WHERE s.IsActive = 1 AND cm.Status = 'Converted' AND cm.ConversionValue IS NOT NULL GROUP BY s.ID, s.Name, s.SegmentType ORDER BY TotalConversionValue DESC