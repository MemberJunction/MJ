SELECT TOP (@TopN) t.ID, t.Title, t.AuthorID, c.Name AS CategoryName, t.ViewCount, t.ReplyCount, t.CreatedDate, t.LastActivityDate, t.Status, t.IsPinned, t.IsFeatured, (t.ViewCount * 1.0 + t.ReplyCount * 3.0) AS EngagementScore FROM [AssociationDemo].[vwForumThreads] t INNER JOIN [AssociationDemo].[vwForumCategories] c ON t.CategoryID = c.ID WHERE t.LastActivityDate >= DATEADD(DAY, -@DaysBack, GETDATE()) AND t.Status = 'Active' ORDER BY EngagementScore DESC, t.LastActivityDate DESC