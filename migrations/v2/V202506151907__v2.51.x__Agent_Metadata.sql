-- SQL Logging Session
-- Session ID: 65373b8a-b124-4a6b-922f-7b1c21dd1da9
-- Started: 2025-06-14T19:22:12.590Z
-- Description: MetadataSync Push Operation
-- Generated by MemberJunction SQLServerDataProvider

-- Save Template Contents (core SP call only)
EXEC [__mj].spUpdateTemplateContent @TemplateID = '8E5F83E5-837B-4C53-9171-08272BF605A4',
@TypeID = 'E7AFCCEC-6A37-EF11-86D4-000D3A4E707E',
@TemplateText = '# Loop Agent Type System Prompt

You are an AI agent operating in a loop-based execution pattern. Your role is to analyze the current state, determine if the task is complete, and decide on the next action to take. You will continue looping until the task is successfully completed. This first section of your system prompt tells you about the Agent Type. Following this section you will learn about the specific agent we are running.

## Your Capabilities

{% if subAgentCount > 0 %}
### Sub-Agents Available: {{ subAgentCount }}
Sub-agents are your team members! Sub-agents have specialized expertise can perform a wide variety of tasks and you may *only execute one sub-agent at at time**. The sub-agents available to you are:
 
{{ subAgentDetails | safe }}

{% endif %}

{% if actionCount > 0 %}
### Actions Available: {{ actionCount }}
An action is a tool you can use to perform a specific task. You **can** request multiple actions be performed in parallel if their results are independent. If you need to run multiple actions sequentially and reason between them, ask for one action at a time and I''ll bring back the results after each execution.

#### Available Actions:
{{ actionDetails | safe }}

{% endif %}


## Task Execution

The user''s request and any additional context will be provided below. Analyze the request and determine:

1. Whether the task has been completed successfully
2. If not complete, what the next step should be
3. Which sub-agent to invoke OR which action to perform (if needed)
4. Your reasoning for the decision
5. Any relevant data or results to pass along

# Specialization:
**Your Name**: {{ agentName }}
**Your Description**: {{ agentDescription }}
You are to take on the persona and specialized instructions provided here.  

## Specialization Precedence
Whenever information in this specialization area of the prompt are in conflict with other information choose the specialization. However, you must
always use our designated response format shown below

## Specialization Details:
{{ agentSpecificPrompt }}


# Response Format
You MUST respond with valid JSON in the following structure:

{{ _OUTPUT_EXAMPLE | safe }}

## Response Format Explanation:

### Required vs Optional Properties
Properties marked with `?` in the example (like `actions?`, `subAgent?`, `userMessage?`) are **optional** and should only be included when relevant to your chosen `nextStep.type`. The `?` notation follows TypeScript convention to indicate optional properties.

### Property Descriptions
- **taskComplete**: Set to `true` only when the entire task is successfully completed
- **reasoning**: Brief description of your thought process and analysis (always required)
- **nextStep**: this object is only needed if taskComplete === false
- **nextStep.type**: 
  - `"action"` - Execute one or more specific action
  - `"sub-agent"` - Execute a single sub-agent
  - `"chat"` - Go back to the user with a message either providing an answer or asking a follow up question to help you complete the task requested.
- **nextStep.actions?**: Only include when type===''action'', an array of 1+ actions you want to run (they are run in parallel)
  - id: UUID of the action
  - name: Name of action
  - params: Object with 0 to many keys - **must match the params the action enumerated above**
- **nextStep.subAgent?**: Only include when type===''sub-agent", a **single** sub-agent you want to run
  - id: UUID for the selected agent
  - name: Name of the agent
  - message: Any and all context you want to send to the sub-agent including data in JSON form and descriptions. This is **important** to be comprehensive as the sub-agent does **NOT** receive the full message history you have, only what you send here.
  - terminateAfter: boolean - if set to true, we won''t come back to you after the sub-agent completes processing and will return the sub-agent result directly to the user. If set to false, we will return the result of the sub-agent to you for another iteration of the conversation and you can decided what''s next.
- **userMessage?**: Only include when type===''chat'', contains the message you want to send to the user

# Important Guidelines
1. **Always return valid JSON** - No additional text outside the JSON structure, no markdown, just JSON
2. **Be decisive** - Choose clear next steps based on available capabilities
3. **Estimate progress** - Provide meaningful progress updates
4. **Use sub-agents wisely** - Delegate to sub-agents when their specialization matches the need
5. **Complete the loop** - Only set taskComplete to true when you''re reasonably confident the task is done ',
@Priority = 1,
@IsActive = 1,
@ID = '1C4B8853-04B8-4BF1-92D6-B102436837D7';

GO


-- Save AI Prompts (core SP call only)
EXEC [__mj].spUpdateAIPrompt @Name = 'Loop Agent Type: System Prompt',
@Description = 'Basic control structure for the Loop Agent Type.',
@TemplateID = '8E5F83E5-837B-4C53-9171-08272BF605A4',
@CategoryID = 'A19D433E-F36B-1410-8DB1-00021F8B792E',
@TypeID = 'A6DA423E-F36B-1410-8DAC-00021F8B792E',
@Status = 'Active',
@ResponseFormat = 'JSON',
@ModelSpecificResponseFormat = NULL,
@AIModelTypeID = NULL,
@MinPowerRank = 0,
@SelectionStrategy = 'Specific',
@PowerPreference = 'Highest',
@ParallelizationMode = 'None',
@ParallelCount = NULL,
@ParallelConfigParam = NULL,
@OutputType = 'object',
@OutputExample = '{
  "taskComplete": false,
  "nextStep": {
    "type": "action",
    "actions?": [
      {
        "id": "action UUID goes here",
        "name": "action name goes here",
        "params": {
          "param1": "value1",
          "param2": "value2"
        }
      }
    ],
    "subAgent?": {
      "id": "sub agent UUID goes here",
      "name": "sub agent name goes here",
      "message": "your message to the sub-agent including any important context for the sub-agent to be aware of. Can be text and/or JSON",
      "terminateAfter": true
    },
    "userMessage?": "Provide a message to the user, only provided if type=''chat''"
  },
  "reasoning": "The conversation is still in the information gathering phase. The user has expressed interest in products but hasn''t provided enough details for me to make accurate recommendations yet. I need to ask about budget next",
  "confidence": 0.90
}',
@ValidationBehavior = 'Strict',
@MaxRetries = 2,
@RetryDelayMS = 1000,
@RetryStrategy = 'Fixed',
@ResultSelectorPromptID = NULL,
@EnableCaching = 0,
@CacheTTLSeconds = NULL,
@CacheMatchType = 'Exact',
@CacheSimilarityThreshold = NULL,
@CacheMustMatchModel = 1,
@CacheMustMatchVendor = 1,
@CacheMustMatchAgent = 0,
@CacheMustMatchConfig = 0,
@PromptRole = 'System',
@PromptPosition = 'First',
@ID = 'FF7D441F-36E1-458A-B548-0FC2208923BE';

GO




EXEC [__mj].spUpdateActionParam @ActionID = '6C88FED2-679A-4FDD-A31A-7F38D0457F22',
@Name = 'Location',
@DefaultValue = NULL,
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'City name or location to get weather for (e.g., ''New York'', ''London''). **JUST CITY NAME, NO STATE OR COUNTRY** Either this or Latitude/Longitude must be provided',
@IsRequired = 0,
@ID = '8F49FD17-4832-4E55-B880-01336A37D894';

GO







-- SQL Logging Session
-- Session ID: 919ff6e9-1d86-4847-877b-bbc8fb16406f
-- Started: 2025-06-15T14:17:04.155Z
-- Description: MetadataSync Push Operation
-- Generated by MemberJunction SQLServerDataProvider

-- Save Action Categories (core SP call only)
EXEC [__mj].spCreateActionCategory @ID = '095ec184-0aab-4122-a9b9-b64f0215f7da',
@Name = 'Web',
@Description = 'Web Actions',
@ParentID = NULL,
@Status = 'Pending';

GO

-- Save Actions (core SP call only)
EXEC [__mj].spCreateAction @ID = '82169f64-8566-4ae7-9c87-190a885c98a9',
@CategoryID = '095EC184-0AAB-4122-A9B9-B64F0215F7DA',
@Name = 'Web Search',
@Description = 'Performs web search using DuckDuckGo''s search API and returns search results with titles, URLs, and snippets',
@Type = 'Custom',
@UserPrompt = NULL,
@UserComments = NULL,
@Code = NULL,
@CodeComments = NULL,
@CodeApprovalStatus = 'Pending',
@CodeApprovalComments = NULL,
@CodeApprovedByUserID = NULL,
@CodeApprovedAt = NULL,
@CodeLocked = 0,
@ForceCodeGeneration = 0,
@RetentionPeriod = NULL,
@Status = 'Active',
@DriverClass = '__WebSearch';

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = '2114c5ec-058a-4b5a-9f5d-a3d16a7fa00c',
@ActionID = '82169F64-8566-4AE7-9C87-190A885C98A9',
@Name = 'SearchTerms',
@DefaultValue = NULL,
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Keywords to search for',
@IsRequired = 1;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = 'dc71f183-de01-4187-8735-7a5df3898b61',
@ActionID = '82169F64-8566-4AE7-9C87-190A885C98A9',
@Name = 'MaxResults',
@DefaultValue = '10',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Maximum number of results to return (default: 10, max: 30)',
@IsRequired = 0;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = '46b4466b-7e1f-4dde-81f9-afaaab263be3',
@ActionID = '82169F64-8566-4AE7-9C87-190A885C98A9',
@Name = 'Region',
@DefaultValue = 'us-en',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Regional search preference (default: ''us-en'')',
@IsRequired = 0;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = '9015d7b9-14c4-466d-bb77-b0a96e2187c9',
@ActionID = '82169F64-8566-4AE7-9C87-190A885C98A9',
@Name = 'SafeSearch',
@DefaultValue = 'moderate',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Safe search level - ''strict'', ''moderate'', ''off'' (default: ''moderate'')',
@IsRequired = 0;

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '6412048b-7cdf-44ad-bc0f-5cc46b8e4d24',
@ActionID = '82169F64-8566-4AE7-9C87-190A885C98A9',
@ResultCode = 'SUCCESS',
@IsSuccess = 1,
@Description = 'Search completed successfully';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = 'c81f8911-5798-4796-8b76-478115ba4b1e',
@ActionID = '82169F64-8566-4AE7-9C87-190A885C98A9',
@ResultCode = 'MISSING_PARAMETERS',
@IsSuccess = 0,
@Description = 'SearchTerms parameter is required';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '5ad075b0-2386-40f9-9fba-1ea5d68924b2',
@ActionID = '82169F64-8566-4AE7-9C87-190A885C98A9',
@ResultCode = 'INVALID_PARAMETERS',
@IsSuccess = 0,
@Description = 'SearchTerms cannot be empty';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '065c4100-c8cc-4a6a-86fa-7e6eff47997d',
@ActionID = '82169F64-8566-4AE7-9C87-190A885C98A9',
@ResultCode = 'SEARCH_FAILED',
@IsSuccess = 0,
@Description = 'DuckDuckGo search request failed';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = 'b56c355f-e0c4-42e0-8ef7-8bcde916dc52',
@ActionID = '82169F64-8566-4AE7-9C87-190A885C98A9',
@ResultCode = 'NO_RESULTS',
@IsSuccess = 0,
@Description = 'No search results found';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '40a95510-8c79-4d51-b535-4e4796790ec8',
@ActionID = '82169F64-8566-4AE7-9C87-190A885C98A9',
@ResultCode = 'FAILED',
@IsSuccess = 0,
@Description = 'Failed to perform web search';

GO

-- Save Actions (core SP call only)
EXEC [__mj].spCreateAction @ID = '81f96534-03f5-49e9-81b0-d8902a7645a3',
@CategoryID = '095EC184-0AAB-4122-A9B9-B64F0215F7DA',
@Name = 'Web Page Content',
@Description = 'Retrieves and processes web page content with various output formats including text extraction, HTML parsing, and document conversion',
@Type = 'Custom',
@UserPrompt = NULL,
@UserComments = NULL,
@Code = NULL,
@CodeComments = NULL,
@CodeApprovalStatus = 'Pending',
@CodeApprovalComments = NULL,
@CodeApprovedByUserID = NULL,
@CodeApprovedAt = NULL,
@CodeLocked = 0,
@ForceCodeGeneration = 0,
@RetentionPeriod = NULL,
@Status = 'Active',
@DriverClass = '__WebPageContent';

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = '61993ad9-7b5c-4d2d-8d08-d36bdfe848c1',
@ActionID = '81F96534-03F5-49E9-81B0-D8902A7645A3',
@Name = 'URL',
@DefaultValue = NULL,
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Web page URL to fetch content from',
@IsRequired = 1;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = 'e013d3bf-e9b1-4b65-bb46-b2f293651fb0',
@ActionID = '81F96534-03F5-49E9-81B0-D8902A7645A3',
@Name = 'ContentType',
@DefaultValue = 'text',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Output format - ''text'', ''html'', ''markdown'', ''json'' (default: ''text'')',
@IsRequired = 0;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = '14672b44-03c2-4d1a-a977-6d9f852f7bed',
@ActionID = '81F96534-03F5-49E9-81B0-D8902A7645A3',
@Name = 'ExtractMainContent',
@DefaultValue = 'false',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Extract only main content vs full page (default: false)',
@IsRequired = 0;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = '3fc11c9a-b034-4684-81ca-f443003363cc',
@ActionID = '81F96534-03F5-49E9-81B0-D8902A7645A3',
@Name = 'IncludeMetadata',
@DefaultValue = 'true',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Include page metadata in response (default: true)',
@IsRequired = 0;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = '2749e985-dc09-4dd3-902b-bdb7c7e6b036',
@ActionID = '81F96534-03F5-49E9-81B0-D8902A7645A3',
@Name = 'MaxContentLength',
@DefaultValue = '50000',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Maximum content length to return (default: 50000 chars)',
@IsRequired = 0;

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = 'd65739db-f628-4079-8296-ef7f2e7cfb8a',
@ActionID = '81F96534-03F5-49E9-81B0-D8902A7645A3',
@ResultCode = 'SUCCESS',
@IsSuccess = 1,
@Description = 'Content retrieved successfully';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '29b7c9f1-8d54-4482-b522-c5131fc5a938',
@ActionID = '81F96534-03F5-49E9-81B0-D8902A7645A3',
@ResultCode = 'MISSING_PARAMETERS',
@IsSuccess = 0,
@Description = 'URL parameter is required';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '15c69e57-10e1-4084-9bb2-99fe34ba271b',
@ActionID = '81F96534-03F5-49E9-81B0-D8902A7645A3',
@ResultCode = 'INVALID_URL',
@IsSuccess = 0,
@Description = 'Invalid URL format';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '8fe1314f-9649-4ad5-922b-30d110e1f6e4',
@ActionID = '81F96534-03F5-49E9-81B0-D8902A7645A3',
@ResultCode = 'INVALID_CONTENT_TYPE',
@IsSuccess = 0,
@Description = 'ContentType must be one of: text, html, markdown, json';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '1a3211b8-bbe7-4d34-b0c5-f863456fec7e',
@ActionID = '81F96534-03F5-49E9-81B0-D8902A7645A3',
@ResultCode = 'FETCH_FAILED',
@IsSuccess = 0,
@Description = 'Failed to fetch URL';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '755986d8-004f-4b08-a176-3a108deabbd7',
@ActionID = '81F96534-03F5-49E9-81B0-D8902A7645A3',
@ResultCode = 'CONTENT_TOO_LARGE',
@IsSuccess = 0,
@Description = 'Content exceeds size limits';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '93febc8d-3375-4a7e-b0ba-92a03b4152ad',
@ActionID = '81F96534-03F5-49E9-81B0-D8902A7645A3',
@ResultCode = 'UNSUPPORTED_CONTENT_TYPE',
@IsSuccess = 0,
@Description = 'URL does not return supported content type';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '0bd4ab9f-7532-4a9d-93ab-85acf902324e',
@ActionID = '81F96534-03F5-49E9-81B0-D8902A7645A3',
@ResultCode = 'FAILED',
@IsSuccess = 0,
@Description = 'Failed to retrieve web page content';

GO

-- Save Actions (core SP call only)
EXEC [__mj].spCreateAction @ID = 'd0fabbef-c505-446b-b746-b5a38541985a',
@CategoryID = '095EC184-0AAB-4122-A9B9-B64F0215F7DA',
@Name = 'URL Link Validator',
@Description = 'Validates URLs by checking accessibility, response codes, and performing health checks with detailed status information',
@Type = 'Custom',
@UserPrompt = NULL,
@UserComments = NULL,
@Code = NULL,
@CodeComments = NULL,
@CodeApprovalStatus = 'Pending',
@CodeApprovalComments = NULL,
@CodeApprovedByUserID = NULL,
@CodeApprovedAt = NULL,
@CodeLocked = 0,
@ForceCodeGeneration = 0,
@RetentionPeriod = NULL,
@Status = 'Active',
@DriverClass = '__URLLinkValidator';

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = '96a7a30d-0a6b-4152-a419-146807d38238',
@ActionID = 'D0FABBEF-C505-446B-B746-B5A38541985A',
@Name = 'URL',
@DefaultValue = NULL,
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Single URL to validate (use this OR URLs)',
@IsRequired = 0;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = 'af5382af-b383-45a2-87ca-08045563dc9a',
@ActionID = 'D0FABBEF-C505-446B-B746-B5A38541985A',
@Name = 'URLs',
@DefaultValue = NULL,
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 1,
@Description = 'Array of URLs to validate (use this OR URL)',
@IsRequired = 0;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = '8939f445-6c73-44d7-8993-4c92428d0ae9',
@ActionID = 'D0FABBEF-C505-446B-B746-B5A38541985A',
@Name = 'TimeoutMs',
@DefaultValue = '5000',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Request timeout in milliseconds (default: 5000, max: 30000)',
@IsRequired = 0;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = '4106680a-c4b9-4efe-86f7-8e97b2aed641',
@ActionID = 'D0FABBEF-C505-446B-B746-B5A38541985A',
@Name = 'FollowRedirects',
@DefaultValue = 'true',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Whether to follow redirects (default: true)',
@IsRequired = 0;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = '367b3738-323e-4e61-81d5-3c72347483de',
@ActionID = 'D0FABBEF-C505-446B-B746-B5A38541985A',
@Name = 'CheckSSL',
@DefaultValue = 'true',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Whether to check SSL certificate validity (default: true)',
@IsRequired = 0;

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = 'c5ffede1-f150-44f9-a113-af52941b086d',
@ActionID = 'D0FABBEF-C505-446B-B746-B5A38541985A',
@ResultCode = 'SUCCESS',
@IsSuccess = 1,
@Description = 'URL validation completed successfully';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '18631c1b-44ff-4c10-82ad-4cf211775a99',
@ActionID = 'D0FABBEF-C505-446B-B746-B5A38541985A',
@ResultCode = 'MISSING_PARAMETERS',
@IsSuccess = 0,
@Description = 'Either URL or URLs parameter is required';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '587fde4f-4e24-4692-ba48-da18bc79b9c7',
@ActionID = 'D0FABBEF-C505-446B-B746-B5A38541985A',
@ResultCode = 'TOO_MANY_URLS',
@IsSuccess = 0,
@Description = 'Too many URLs to validate in one request';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = 'dfb2ad08-5f95-4c51-bd0e-563df515a841',
@ActionID = 'D0FABBEF-C505-446B-B746-B5A38541985A',
@ResultCode = 'FAILED',
@IsSuccess = 0,
@Description = 'Failed to validate URLs';

GO

-- Save Actions (core SP call only)
EXEC [__mj].spCreateAction @ID = 'a2455679-1370-4298-ac9e-0ba48de2432e',
@CategoryID = '095EC184-0AAB-4122-A9B9-B64F0215F7DA',
@Name = 'URL Metadata Extractor',
@Description = 'Extracts comprehensive metadata from web pages including OpenGraph, Twitter Cards, Schema.org structured data, and standard HTML meta tags',
@Type = 'Custom',
@UserPrompt = NULL,
@UserComments = NULL,
@Code = NULL,
@CodeComments = NULL,
@CodeApprovalStatus = 'Pending',
@CodeApprovalComments = NULL,
@CodeApprovedByUserID = NULL,
@CodeApprovedAt = NULL,
@CodeLocked = 0,
@ForceCodeGeneration = 0,
@RetentionPeriod = NULL,
@Status = 'Active',
@DriverClass = '__URLMetadataExtractor';

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = 'bf0e6ec1-251b-4662-bb81-1699cd62acd2',
@ActionID = 'A2455679-1370-4298-AC9E-0BA48DE2432E',
@Name = 'URL',
@DefaultValue = NULL,
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Web page URL to extract metadata from',
@IsRequired = 1;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = '8ed0ebb5-0493-4c9b-8e04-8bd457d726fa',
@ActionID = 'A2455679-1370-4298-AC9E-0BA48DE2432E',
@Name = 'IncludeOpenGraph',
@DefaultValue = 'true',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Extract OpenGraph metadata (default: true)',
@IsRequired = 0;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = '81be4f63-2434-4875-b239-b5e4efc3caca',
@ActionID = 'A2455679-1370-4298-AC9E-0BA48DE2432E',
@Name = 'IncludeTwitterCards',
@DefaultValue = 'true',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Extract Twitter Card metadata (default: true)',
@IsRequired = 0;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = '57fef621-4cad-4db9-b512-9a93b806b0c0',
@ActionID = 'A2455679-1370-4298-AC9E-0BA48DE2432E',
@Name = 'IncludeSchemaOrg',
@DefaultValue = 'true',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Extract Schema.org JSON-LD data (default: true)',
@IsRequired = 0;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = 'af93155a-fed7-44bb-a6e3-b0e2f9a486b6',
@ActionID = 'A2455679-1370-4298-AC9E-0BA48DE2432E',
@Name = 'IncludeBasicMeta',
@DefaultValue = 'true',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Extract standard HTML meta tags (default: true)',
@IsRequired = 0;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = 'cb71e692-46a8-46f0-95d9-d0d308734556',
@ActionID = 'A2455679-1370-4298-AC9E-0BA48DE2432E',
@Name = 'IncludeFavicon',
@DefaultValue = 'true',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Extract favicon information (default: true)',
@IsRequired = 0;

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '1b75fa79-df12-4139-bf28-dc5baf260160',
@ActionID = 'A2455679-1370-4298-AC9E-0BA48DE2432E',
@ResultCode = 'SUCCESS',
@IsSuccess = 1,
@Description = 'Metadata extracted successfully';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = 'fe6d9395-788a-450b-9723-ed45356bd49c',
@ActionID = 'A2455679-1370-4298-AC9E-0BA48DE2432E',
@ResultCode = 'MISSING_PARAMETERS',
@IsSuccess = 0,
@Description = 'URL parameter is required';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '0ce5d11d-1262-4cc9-887f-242f6504ff0f',
@ActionID = 'A2455679-1370-4298-AC9E-0BA48DE2432E',
@ResultCode = 'INVALID_URL',
@IsSuccess = 0,
@Description = 'Invalid URL format';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '28cd5b28-9bf5-4bde-bd79-64737322a2d7',
@ActionID = 'A2455679-1370-4298-AC9E-0BA48DE2432E',
@ResultCode = 'FETCH_FAILED',
@IsSuccess = 0,
@Description = 'Failed to fetch URL';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '3238db76-f1f3-4d35-9b0d-21bfb7d637bd',
@ActionID = 'A2455679-1370-4298-AC9E-0BA48DE2432E',
@ResultCode = 'NOT_HTML',
@IsSuccess = 0,
@Description = 'URL does not return HTML content';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '3e01df75-7931-4377-b894-8a6d04a8c911',
@ActionID = 'A2455679-1370-4298-AC9E-0BA48DE2432E',
@ResultCode = 'CONTENT_TOO_LARGE',
@IsSuccess = 0,
@Description = 'Content exceeds size limits';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '90b41db9-8a03-4ad6-81f9-d1eb71364bd6',
@ActionID = 'A2455679-1370-4298-AC9E-0BA48DE2432E',
@ResultCode = 'TIMEOUT',
@IsSuccess = 0,
@Description = 'Request timed out';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = 'fa04289a-b219-41c7-925d-78e9d1a8bd64',
@ActionID = 'A2455679-1370-4298-AC9E-0BA48DE2432E',
@ResultCode = 'FAILED',
@IsSuccess = 0,
@Description = 'Failed to extract metadata';

GO

-- Save Actions (core SP call only)
EXEC [__mj].spCreateAction @ID = '2c9dca8e-76e2-4f01-9a0d-c1678c364fbb',
@CategoryID = 'E959A850-7842-456D-AB51-F232DF12E709',
@Name = 'QR Code',
@Description = 'Generates and reads QR codes with customizable options for size, error correction, and styling',
@Type = 'Custom',
@UserPrompt = NULL,
@UserComments = NULL,
@Code = NULL,
@CodeComments = NULL,
@CodeApprovalStatus = 'Pending',
@CodeApprovalComments = NULL,
@CodeApprovedByUserID = NULL,
@CodeApprovedAt = NULL,
@CodeLocked = 0,
@ForceCodeGeneration = 0,
@RetentionPeriod = NULL,
@Status = 'Active',
@DriverClass = '__QRCode';

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = 'af674e95-6377-4282-bef2-055e4c228c37',
@ActionID = '2C9DCA8E-76E2-4F01-9A0D-C1678C364FBB',
@Name = 'Operation',
@DefaultValue = NULL,
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = '''generate'' or ''read''',
@IsRequired = 1;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = 'fcc1582e-535e-4431-aede-cc247752b273',
@ActionID = '2C9DCA8E-76E2-4F01-9A0D-C1678C364FBB',
@Name = 'Data',
@DefaultValue = NULL,
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Text/URL to encode (for generate) or base64 image data (for read)',
@IsRequired = 1;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = '0b820a98-eefd-4327-afb0-e09318bb0ae7',
@ActionID = '2C9DCA8E-76E2-4F01-9A0D-C1678C364FBB',
@Name = 'Size',
@DefaultValue = '200',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'QR code size in pixels (default: 200, max: 1000) [generate only]',
@IsRequired = 0;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = '0775562a-796f-4858-87b7-4f14def2767c',
@ActionID = '2C9DCA8E-76E2-4F01-9A0D-C1678C364FBB',
@Name = 'ErrorCorrection',
@DefaultValue = 'M',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Error correction level ''L'', ''M'', ''Q'', ''H'' (default: ''M'') [generate only]',
@IsRequired = 0;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = 'ba1e8d93-5846-42f5-8512-259a658574d8',
@ActionID = '2C9DCA8E-76E2-4F01-9A0D-C1678C364FBB',
@Name = 'Margin',
@DefaultValue = '4',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Quiet zone margin (default: 4) [generate only]',
@IsRequired = 0;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = 'e3a22b53-0b87-4c69-9929-b3684dd0c56b',
@ActionID = '2C9DCA8E-76E2-4F01-9A0D-C1678C364FBB',
@Name = 'DarkColor',
@DefaultValue = '#000000',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Dark module color (default: ''#000000'') [generate only]',
@IsRequired = 0;

GO

-- Save Action Params (core SP call only)
EXEC [__mj].spCreateActionParam @ID = 'b585c963-9db3-49fa-82f8-d476b0174039',
@ActionID = '2C9DCA8E-76E2-4F01-9A0D-C1678C364FBB',
@Name = 'LightColor',
@DefaultValue = '#FFFFFF',
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'Light module color (default: ''#FFFFFF'') [generate only]',
@IsRequired = 0;

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '2fefa9d6-0457-487a-9a96-d2a5bbace493',
@ActionID = '2C9DCA8E-76E2-4F01-9A0D-C1678C364FBB',
@ResultCode = 'SUCCESS',
@IsSuccess = 1,
@Description = 'QR code operation completed successfully';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '52658187-b38d-40b5-a961-14978be3a0a8',
@ActionID = '2C9DCA8E-76E2-4F01-9A0D-C1678C364FBB',
@ResultCode = 'MISSING_PARAMETERS',
@IsSuccess = 0,
@Description = 'Required parameters are missing';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '4acf1304-fcc0-4193-8cc9-54e81856dbf0',
@ActionID = '2C9DCA8E-76E2-4F01-9A0D-C1678C364FBB',
@ResultCode = 'INVALID_OPERATION',
@IsSuccess = 0,
@Description = 'Invalid operation. Use ''generate'' or ''read''';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = 'b6117705-2b0b-40c8-85d4-85c8b7f9c8ae',
@ActionID = '2C9DCA8E-76E2-4F01-9A0D-C1678C364FBB',
@ResultCode = 'INVALID_ERROR_CORRECTION',
@IsSuccess = 0,
@Description = 'ErrorCorrection must be one of: L, M, Q, H';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = 'a0daa7ee-6f34-4ec0-9172-dbc2102b0079',
@ActionID = '2C9DCA8E-76E2-4F01-9A0D-C1678C364FBB',
@ResultCode = 'GENERATION_FAILED',
@IsSuccess = 0,
@Description = 'Failed to generate QR code';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '6862ed38-d33d-489e-8fde-091e4e2f36d0',
@ActionID = '2C9DCA8E-76E2-4F01-9A0D-C1678C364FBB',
@ResultCode = 'READING_FAILED',
@IsSuccess = 0,
@Description = 'Failed to read QR code';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = '4ce2d07a-aa56-4956-b11c-457fed0b85b8',
@ActionID = '2C9DCA8E-76E2-4F01-9A0D-C1678C364FBB',
@ResultCode = 'NOT_IMPLEMENTED',
@IsSuccess = 0,
@Description = 'QR code reading functionality not yet implemented';

GO

-- Save Action Result Codes (core SP call only)
EXEC [__mj].spCreateActionResultCode @ID = 'e2bd6213-b65d-4c4b-bc4a-afc9dea3fd5c',
@ActionID = '2C9DCA8E-76E2-4F01-9A0D-C1678C364FBB',
@ResultCode = 'FAILED',
@IsSuccess = 0,
@Description = 'Failed to process QR code';

GO

-- Save AI Agent Actions (core SP call only)
EXEC [__mj].spCreateAIAgentAction @ID = '7fb4d724-6e63-47f0-b059-9a7c2754299a',
@AgentID = '55399C30-C59B-47D2-A856-640DA89C46E4',
@ActionID = '82169F64-8566-4AE7-9C87-190A885C98A9',
@Status = 'Active';

GO


-- End of SQL Logging Session
-- Session ID: 919ff6e9-1d86-4847-877b-bbc8fb16406f
-- Completed: 2025-06-15T14:17:06.331Z
-- Duration: 2176ms
-- Total Statements: 68



-- SQL Logging Session
-- Session ID: a6cb9b6a-ff9d-4ff7-8ecd-bbacda3ebd33
-- Started: 2025-06-15T14:48:17.863Z
-- Description: MetadataSync Push Operation
-- Generated by MemberJunction SQLServerDataProvider

-- Save Template Contents (core SP call only)
EXEC [__mj].spUpdateTemplateContent @TemplateID = '8E5F83E5-837B-4C53-9171-08272BF605A4',
@TypeID = 'E7AFCCEC-6A37-EF11-86D4-000D3A4E707E',
@TemplateText = '# Loop Agent Type System Prompt

You are an AI agent operating in a loop-based execution pattern. Your role is to analyze the current state, determine if the task is complete, and decide on the next action to take. You will continue looping until the task is successfully completed. This first section of your system prompt tells you about the Agent Type. Following this section you will learn about the specific agent we are running.

## Your Capabilities

{% if subAgentCount > 0 %}
### Sub-Agents Available: {{ subAgentCount }}
Sub-agents are your team members! Sub-agents have specialized expertise can perform a wide variety of tasks and you may *only execute one sub-agent at at time**. The sub-agents available to you are:
 
{{ subAgentDetails | safe }}

{% endif %}

{% if actionCount > 0 %}
### Actions Available: {{ actionCount }}
An action is a tool you can use to perform a specific task. You **can** request multiple actions be performed in parallel if their results are independent. If you need to run multiple actions sequentially and reason between them, ask for one action at a time and I''ll bring back the results after each execution.

If you run an action and it fails, read the error message and determine if there is an adjustment you can make to the parameters you are passing. Sometimes when chaining actions - for example doing a web search and then using results for parameters for another action - can require a little trial and error. **You may try this up to 3 times for any given action attempt**

#### Available Actions:
{{ actionDetails | safe }}

{% endif %}


## Task Execution

The user''s request and any additional context will be provided below. Analyze the request and determine:

1. Whether the task has been completed successfully
2. If not complete, what the next step should be
3. Which sub-agent to invoke OR which action to perform (if needed)
4. Your reasoning for the decision
5. Any relevant data or results to pass along

# Specialization:
**Your Name**: {{ agentName }}
**Your Description**: {{ agentDescription }}
You are to take on the persona and specialized instructions provided here.  

## Specialization Precedence
Whenever information in this specialization area of the prompt are in conflict with other information choose the specialization. However, you must
always use our designated response format shown below

## Specialization Details:
{{ agentSpecificPrompt }}


# Response Format
You MUST respond with valid JSON in the following structure:

{{ _OUTPUT_EXAMPLE | safe }}

## Response Format Explanation:

### Required vs Optional Properties
Properties marked with `?` in the example (like `actions?`, `subAgent?`, `userMessage?`) are **optional** and should only be included when relevant to your chosen `nextStep.type`. The `?` notation follows TypeScript convention to indicate optional properties.

### Property Descriptions
- **taskComplete**: Set to `true` only when the entire task is successfully completed
- **reasoning**: Brief description of your thought process and analysis (always required)
- **nextStep**: this object is only needed if taskComplete === false
- **nextStep.type**: 
  - `"action"` - Execute one or more specific action
  - `"sub-agent"` - Execute a single sub-agent
  - `"chat"` - Go back to the user with a message either providing an answer or asking a follow up question to help you complete the task requested.
- **nextStep.actions?**: Only include when type===''action'', an array of 1+ actions you want to run (they are run in parallel)
  - id: UUID of the action
  - name: Name of action
  - params: Object with 0 to many keys - **must match the params the action enumerated above**
- **nextStep.subAgent?**: Only include when type===''sub-agent", a **single** sub-agent you want to run
  - id: UUID for the selected agent
  - name: Name of the agent
  - message: Any and all context you want to send to the sub-agent including data in JSON form and descriptions. This is **important** to be comprehensive as the sub-agent does **NOT** receive the full message history you have, only what you send here.
  - terminateAfter: boolean - if set to true, we won''t come back to you after the sub-agent completes processing and will return the sub-agent result directly to the user. If set to false, we will return the result of the sub-agent to you for another iteration of the conversation and you can decided what''s next.
- **userMessage?**: Only include when type===''chat'', contains the message you want to send to the user

# Important Guidelines
1. **Always return valid JSON** - No additional text outside the JSON structure, no markdown, just JSON
2. **Be decisive** - Choose clear next steps based on available capabilities
3. **Estimate progress** - Provide meaningful progress updates
4. **Use sub-agents wisely** - Delegate to sub-agents when their specialization matches the need
5. **Complete the loop** - Only set taskComplete to true when you''re reasonably confident the task is done ',
@Priority = 1,
@IsActive = 1,
@ID = '1C4B8853-04B8-4BF1-92D6-B102436837D7';

GO


-- End of SQL Logging Session
-- Session ID: a6cb9b6a-ff9d-4ff7-8ecd-bbacda3ebd33
-- Completed: 2025-06-15T14:48:22.823Z
-- Duration: 4960ms
-- Total Statements: 1
