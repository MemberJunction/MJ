-- SQL Logging Session
-- Session ID: a9882e4e-6224-4882-928f-8ae7b0abe2d5
-- Started: 2025-06-19T20:55:38.296Z
-- Description: MetadataSync Push Operation
-- Generated by MemberJunction SQLServerDataProvider

-- Save Action Categories (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionCategory @ID = '9ae3480b-41ff-4e4a-a5f0-eb009465b26a',
@Name = 'System',
@Description = 'Core system actions and utilities',
@ParentID = NULL,
@Status = 'Active';

GO

-- Save Action Categories (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionCategory @ID = '22285832-93ad-427e-81ba-e332f63fc5b9',
@Name = 'Data',
@Description = 'Data management actions for CRUD operations',
@ParentID = '9ae3480b-41ff-4e4a-a5f0-eb009465b26a',
@Status = 'Active';

GO

-- Save Actions (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateAction @ID = '2504e288-adf7-4913-a627-aa14276baa55',
@CategoryID = '22285832-93ad-427e-81ba-e332f63fc5b9',
@Name = 'Create Record',
@Description = 'Generic action for creating new entity records in the database. Accepts entity name and field values as parameters.',
@Type = 'Custom',
@UserPrompt = NULL,
@UserComments = NULL,
@Code = NULL,
@CodeComments = NULL,
@CodeApprovalStatus = 'Pending',
@CodeApprovalComments = NULL,
@CodeApprovedByUserID = NULL,
@CodeApprovedAt = NULL,
@CodeLocked = 0,
@ForceCodeGeneration = 0,
@RetentionPeriod = NULL,
@Status = 'Active',
@DriverClass = 'CreateRecordAction',
@ParentID = NULL;

GO

-- Save Action Params (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionParam @ID = '30328853-abc4-4141-a8a0-3a1835b831e5',
@ActionID = '2504E288-ADF7-4913-A627-AA14276BAA55',
@Name = 'EntityName',
@DefaultValue = NULL,
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'The name of the entity to create',
@IsRequired = 1;

GO

-- Save Action Params (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionParam @ID = '9bfc66d9-2270-42ef-8cf9-a528f6b36646',
@ActionID = '2504E288-ADF7-4913-A627-AA14276BAA55',
@Name = 'Fields',
@DefaultValue = NULL,
@Type = 'Input',
@ValueType = 'Simple Object',
@IsArray = 0,
@Description = 'Object containing field names and values to set on the new record',
@IsRequired = 1;

GO

-- Save Action Params (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionParam @ID = 'f33c3b12-3f57-4b10-b326-d695c49384a7',
@ActionID = '2504E288-ADF7-4913-A627-AA14276BAA55',
@Name = 'PrimaryKey',
@DefaultValue = NULL,
@Type = 'Output',
@ValueType = 'Simple Object',
@IsArray = 0,
@Description = 'Object containing the primary key field(s) and their value(s) for the created record.',
@IsRequired = 0;

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = '1c874a23-a86c-42c4-b8f4-a25ccd170114',
@ActionID = '2504E288-ADF7-4913-A627-AA14276BAA55',
@ResultCode = 'SUCCESS',
@IsSuccess = 1,
@Description = 'Record created successfully';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = 'f2a140f6-9ce4-4aa1-83d0-5b06cb7ae91c',
@ActionID = '2504E288-ADF7-4913-A627-AA14276BAA55',
@ResultCode = 'FAILED',
@IsSuccess = 0,
@Description = 'Failed to create record';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = '2f5c8e51-eae3-4959-896a-ca17308928ce',
@ActionID = '2504E288-ADF7-4913-A627-AA14276BAA55',
@ResultCode = 'ENTITY_NOT_FOUND',
@IsSuccess = 0,
@Description = 'Entity not found in metadata';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = '18903bba-7304-4cf5-9336-295b659125a8',
@ActionID = '2504E288-ADF7-4913-A627-AA14276BAA55',
@ResultCode = 'VALIDATION_ERROR',
@IsSuccess = 0,
@Description = 'Validation error occurred';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = 'e437e029-dc7f-45b2-8698-a2c3285c86da',
@ActionID = '2504E288-ADF7-4913-A627-AA14276BAA55',
@ResultCode = 'PERMISSION_DENIED',
@IsSuccess = 0,
@Description = 'Permission denied to create record';

GO

-- Save Actions (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateAction @ID = '49e30665-1a90-45ca-9129-c33959a51b4f',
@CategoryID = '22285832-93ad-427e-81ba-e332f63fc5b9',
@Name = 'Get Record',
@Description = 'Generic action for retrieving entity records from the database. Accepts entity name and primary key values as parameters.',
@Type = 'Custom',
@UserPrompt = NULL,
@UserComments = NULL,
@Code = NULL,
@CodeComments = NULL,
@CodeApprovalStatus = 'Pending',
@CodeApprovalComments = NULL,
@CodeApprovedByUserID = NULL,
@CodeApprovedAt = NULL,
@CodeLocked = 0,
@ForceCodeGeneration = 0,
@RetentionPeriod = NULL,
@Status = 'Active',
@DriverClass = 'GetRecordAction',
@ParentID = NULL;

GO

-- Save Action Params (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionParam @ID = '2ec5b4db-53d9-458a-ae23-46402a83a4e0',
@ActionID = '49E30665-1A90-45CA-9129-C33959A51B4F',
@Name = 'EntityName',
@DefaultValue = NULL,
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'The name of the entity to retrieve',
@IsRequired = 1;

GO

-- Save Action Params (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionParam @ID = '76b42b5d-a9c4-4d1d-b189-b4c8c32b89af',
@ActionID = '49E30665-1A90-45CA-9129-C33959A51B4F',
@Name = 'PrimaryKey',
@DefaultValue = NULL,
@Type = 'Input',
@ValueType = 'Simple Object',
@IsArray = 0,
@Description = 'Object containing primary key field(s) and value(s)',
@IsRequired = 1;

GO

-- Save Action Params (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionParam @ID = '25934540-6f4d-48f5-8ca1-69deb83bfad5',
@ActionID = '49E30665-1A90-45CA-9129-C33959A51B4F',
@Name = 'Record',
@DefaultValue = NULL,
@Type = 'Output',
@ValueType = 'Simple Object',
@IsArray = 0,
@Description = 'The retrieved entity record data',
@IsRequired = 0;

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = '41190cfe-cd53-4570-b5e8-3774e9a04e0b',
@ActionID = '49E30665-1A90-45CA-9129-C33959A51B4F',
@ResultCode = 'SUCCESS',
@IsSuccess = 1,
@Description = 'Record retrieved successfully';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = '42d5c250-1f89-496d-857f-b1397e23e237',
@ActionID = '49E30665-1A90-45CA-9129-C33959A51B4F',
@ResultCode = 'FAILED',
@IsSuccess = 0,
@Description = 'Failed to retrieve record';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = 'd630883e-0a3a-4487-8f01-ad68f5f5f1b8',
@ActionID = '49E30665-1A90-45CA-9129-C33959A51B4F',
@ResultCode = 'ENTITY_NOT_FOUND',
@IsSuccess = 0,
@Description = 'Entity not found in metadata';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = '2e2e687b-0fd3-4755-a974-f1b7255763eb',
@ActionID = '49E30665-1A90-45CA-9129-C33959A51B4F',
@ResultCode = 'RECORD_NOT_FOUND',
@IsSuccess = 0,
@Description = 'Record not found';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = '90537b1b-412e-44f2-92a5-1a283f5b2a7f',
@ActionID = '49E30665-1A90-45CA-9129-C33959A51B4F',
@ResultCode = 'VALIDATION_ERROR',
@IsSuccess = 0,
@Description = 'Validation error occurred';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = '38462610-6bca-4586-a34e-440188210094',
@ActionID = '49E30665-1A90-45CA-9129-C33959A51B4F',
@ResultCode = 'PERMISSION_DENIED',
@IsSuccess = 0,
@Description = 'Permission denied to access record';

GO

-- Save Actions (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateAction @ID = 'fcaad325-0d33-4e48-bc25-49c0e3587062',
@CategoryID = '22285832-93ad-427e-81ba-e332f63fc5b9',
@Name = 'Update Record',
@Description = 'Generic action for updating existing entity records in the database. Accepts entity name, primary key, and field values as parameters.',
@Type = 'Custom',
@UserPrompt = NULL,
@UserComments = NULL,
@Code = NULL,
@CodeComments = NULL,
@CodeApprovalStatus = 'Pending',
@CodeApprovalComments = NULL,
@CodeApprovedByUserID = NULL,
@CodeApprovedAt = NULL,
@CodeLocked = 0,
@ForceCodeGeneration = 0,
@RetentionPeriod = NULL,
@Status = 'Active',
@DriverClass = 'UpdateRecordAction',
@ParentID = NULL;

GO

-- Save Action Params (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionParam @ID = 'f7537cb2-3583-4cd0-a7f9-729c2404396e',
@ActionID = 'FCAAD325-0D33-4E48-BC25-49C0E3587062',
@Name = 'EntityName',
@DefaultValue = NULL,
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'The name of the entity to update',
@IsRequired = 1;

GO

-- Save Action Params (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionParam @ID = '2af41949-1ea3-45f8-89b6-c5ac6d9a25b4',
@ActionID = 'FCAAD325-0D33-4E48-BC25-49C0E3587062',
@Name = 'PrimaryKey',
@DefaultValue = NULL,
@Type = 'Input',
@ValueType = 'Simple Object',
@IsArray = 0,
@Description = 'Object containing primary key field(s) and value(s)',
@IsRequired = 1;

GO

-- Save Action Params (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionParam @ID = '7d8b81d2-74a0-4f22-b1b0-8a2a8dac9560',
@ActionID = 'FCAAD325-0D33-4E48-BC25-49C0E3587062',
@Name = 'Fields',
@DefaultValue = NULL,
@Type = 'Input',
@ValueType = 'Simple Object',
@IsArray = 0,
@Description = 'Object containing field names and values to update',
@IsRequired = 1;

GO

-- Save Action Params (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionParam @ID = '46074fbf-6bf4-4749-8cf4-7cb2f253558d',
@ActionID = 'FCAAD325-0D33-4E48-BC25-49C0E3587062',
@Name = 'UpdatedFields',
@DefaultValue = NULL,
@Type = 'Output',
@ValueType = 'Simple Object',
@IsArray = 0,
@Description = 'Object containing the fields that were actually changed with old and new values',
@IsRequired = 0;

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = 'c850f53f-106c-42f9-ace4-f01aee42fdfe',
@ActionID = 'FCAAD325-0D33-4E48-BC25-49C0E3587062',
@ResultCode = 'SUCCESS',
@IsSuccess = 1,
@Description = 'Record updated successfully';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = '287dbd24-e2c2-48a2-9dea-87b55654d6e1',
@ActionID = 'FCAAD325-0D33-4E48-BC25-49C0E3587062',
@ResultCode = 'FAILED',
@IsSuccess = 0,
@Description = 'Failed to update record';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = 'f7c25a09-02e6-49e0-9da6-c1c15db7cdee',
@ActionID = 'FCAAD325-0D33-4E48-BC25-49C0E3587062',
@ResultCode = 'ENTITY_NOT_FOUND',
@IsSuccess = 0,
@Description = 'Entity not found in metadata';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = 'b8737c6d-8b28-4132-ac6a-ff090b66da8f',
@ActionID = 'FCAAD325-0D33-4E48-BC25-49C0E3587062',
@ResultCode = 'RECORD_NOT_FOUND',
@IsSuccess = 0,
@Description = 'Record not found';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = 'bf11ec66-a12e-4366-b989-246400b4b94e',
@ActionID = 'FCAAD325-0D33-4E48-BC25-49C0E3587062',
@ResultCode = 'VALIDATION_ERROR',
@IsSuccess = 0,
@Description = 'Validation error occurred';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = '5d1c37fd-800d-4095-9a9e-d31dfb7aa571',
@ActionID = 'FCAAD325-0D33-4E48-BC25-49C0E3587062',
@ResultCode = 'PERMISSION_DENIED',
@IsSuccess = 0,
@Description = 'Permission denied to update record';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = 'a3ee88b2-f573-4190-ab97-9e942c4abef5',
@ActionID = 'FCAAD325-0D33-4E48-BC25-49C0E3587062',
@ResultCode = 'NO_CHANGES',
@IsSuccess = 1,
@Description = 'No fields were modified';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = '57ef51da-9986-4711-9b77-c0e1f274b85e',
@ActionID = 'FCAAD325-0D33-4E48-BC25-49C0E3587062',
@ResultCode = 'CONCURRENT_UPDATE',
@IsSuccess = 0,
@Description = 'Record was modified by another user';

GO

-- Save Actions (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateAction @ID = 'c03f2547-5154-4627-8e12-fbdeb7580346',
@CategoryID = '22285832-93ad-427e-81ba-e332f63fc5b9',
@Name = 'Delete Record',
@Description = 'Generic action for deleting entity records from the database. Accepts entity name and primary key values as parameters.',
@Type = 'Custom',
@UserPrompt = NULL,
@UserComments = NULL,
@Code = NULL,
@CodeComments = NULL,
@CodeApprovalStatus = 'Pending',
@CodeApprovalComments = NULL,
@CodeApprovedByUserID = NULL,
@CodeApprovedAt = NULL,
@CodeLocked = 0,
@ForceCodeGeneration = 0,
@RetentionPeriod = NULL,
@Status = 'Active',
@DriverClass = 'DeleteRecordAction',
@ParentID = NULL;

GO

-- Save Action Params (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionParam @ID = 'c61e622e-d1f6-4cb1-8701-58f2502b0943',
@ActionID = 'C03F2547-5154-4627-8E12-FBDEB7580346',
@Name = 'EntityName',
@DefaultValue = NULL,
@Type = 'Input',
@ValueType = 'Scalar',
@IsArray = 0,
@Description = 'The name of the entity to delete',
@IsRequired = 1;

GO

-- Save Action Params (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionParam @ID = '9ac131ee-a120-4092-bbbf-a6d94b22f255',
@ActionID = 'C03F2547-5154-4627-8E12-FBDEB7580346',
@Name = 'PrimaryKey',
@DefaultValue = NULL,
@Type = 'Input',
@ValueType = 'Simple Object',
@IsArray = 0,
@Description = 'Object containing primary key field(s) and value(s)',
@IsRequired = 1;

GO

-- Save Action Params (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionParam @ID = 'd187bb42-2a07-4047-9b25-88230dd263b1',
@ActionID = 'C03F2547-5154-4627-8E12-FBDEB7580346',
@Name = 'DeletedRecord',
@DefaultValue = NULL,
@Type = 'Output',
@ValueType = 'Simple Object',
@IsArray = 0,
@Description = 'The data of the deleted record',
@IsRequired = 0;

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = '2936ff50-66ef-4285-8c52-fdc8a8a345d9',
@ActionID = 'C03F2547-5154-4627-8E12-FBDEB7580346',
@ResultCode = 'SUCCESS',
@IsSuccess = 1,
@Description = 'Record deleted successfully';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = 'fa95c455-127a-4ad2-8c41-6a94a9a7108d',
@ActionID = 'C03F2547-5154-4627-8E12-FBDEB7580346',
@ResultCode = 'FAILED',
@IsSuccess = 0,
@Description = 'Failed to delete record';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = '0f999538-f4cf-4137-bd03-34e30fb60fed',
@ActionID = 'C03F2547-5154-4627-8E12-FBDEB7580346',
@ResultCode = 'ENTITY_NOT_FOUND',
@IsSuccess = 0,
@Description = 'Entity not found in metadata';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = '3728d3d7-4ebd-460a-968b-3dc2c68e947b',
@ActionID = 'C03F2547-5154-4627-8E12-FBDEB7580346',
@ResultCode = 'RECORD_NOT_FOUND',
@IsSuccess = 0,
@Description = 'Record not found';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = '6b36ebae-892f-4dc6-897d-e573af5f5a85',
@ActionID = 'C03F2547-5154-4627-8E12-FBDEB7580346',
@ResultCode = 'VALIDATION_ERROR',
@IsSuccess = 0,
@Description = 'Validation error occurred';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = '2398790f-ebfa-4dc1-a506-f7cdcb2aec48',
@ActionID = 'C03F2547-5154-4627-8E12-FBDEB7580346',
@ResultCode = 'PERMISSION_DENIED',
@IsSuccess = 0,
@Description = 'Permission denied to delete record';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = 'a6ea73d1-6aeb-4a92-aa87-0ccce8bbe09e',
@ActionID = 'C03F2547-5154-4627-8E12-FBDEB7580346',
@ResultCode = 'CASCADE_CONSTRAINT',
@IsSuccess = 0,
@Description = 'Cannot delete record: Cascade delete is not allowed';

GO

-- Save Action Result Codes (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateActionResultCode @ID = '07d76457-86b4-42ec-abec-fb9e46f6f333',
@ActionID = 'C03F2547-5154-4627-8E12-FBDEB7580346',
@ResultCode = 'REFERENCE_CONSTRAINT',
@IsSuccess = 0,
@Description = 'Cannot delete record: It is referenced by other records';

GO

-- Save AI Prompt Categories (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateAIPromptCategory @ID = '7d2def7f-138f-4620-8309-33964a97a997',
@Name = 'MJ: System',
@ParentID = NULL,
@Description = 'System-level prompts for MemberJunction framework functionality';

GO

-- Save AI Prompt Categories (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateAIPromptCategory @ID = '9a66484d-1b88-43d9-a166-692abf7bfe64',
@Name = 'Actions',
@ParentID = '7D2DEF7F-138F-4620-8309-33964A97A997',
@Description = 'Prompts for generating and managing MemberJunction Actions';

GO

-- Save Templates (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateTemplate @ID = '2f4d341a-cde0-4473-9cac-2e2e9220fee1',
@Name = 'Generate Action Code',
@Description = 'Template for AI Prompt: Generate Action Code',
@CategoryID = 'B09D433E-F36B-1410-8DB1-00021F8B792E',
@UserPrompt = NULL,
@UserID = 'ECAFCCEC-6A37-EF11-86D4-000D3A4E707E',
@ActiveAt = NULL,
@DisabledAt = NULL,
@IsActive = 1;

GO

-- Save Template Contents (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateTemplateContent @ID = 'ff8c1230-cc40-42b3-9fd0-a18e238c138b',
@TemplateID = '2F4D341A-CDE0-4473-9CAC-2E2E9220FEE1',
@TypeID = 'E7AFCCEC-6A37-EF11-86D4-000D3A4E707E',
@TemplateText = '# Action Code Generation

You are an expert TypeScript developer specializing in MemberJunction Actions. You take great pride in writing clean, well-commented, and properly formatted code.

## Your Task

{% if IsChildAction %}
You will be creating a **child action** that orchestrates and extends a parent action. Child actions add value by:
- Providing a more specific, user-friendly interface
- Pre-processing inputs into the parent''s expected format
- Post-processing outputs into a more useful form
- Adding validation, error handling, or business logic
- Batching or conditional execution of the parent

**Parent Action Context:**
{{ ChildActionInfo }}

Your child action should invoke the parent action using:
```typescript
const result = await ActionEngine.Instance.RunAction({
    ActionName: ''{{ parentAction.Name }}'',
    Params: mappedParams,
    ContextUser: params.ContextUser
});
```
{% else %}
You will be creating an action based on the user''s requirements. Actions are "verbs" in the MemberJunction framework that perform specific business operations.
{% endif %}

**User Request:**
{{ userPrompt }}

## Context

### Available Parameters
The action receives these parameters:
```
{{ actionParams }}
```

### Result Codes
Your action should return one of these result codes:
- {{ resultCodes }}

### Available Libraries
These libraries are already imported and available for use:
{{ availableLibraries }}

### Available Entities
These entities exist in the system for context:
{{ entities }}

## Requirements

1. **Implement the InternalRunAction method** - Your code goes inside this method
2. **Return ActionResultSimple** with Success, ResultCode, and optional Message
3. **Handle errors gracefully** with try-catch blocks
4. **Use async/await** for all asynchronous operations
5. **Output parameters** - Add any output parameters to the Params array

{% if IsChildAction %}
## Child Action Pattern

Your code should follow this structure:

```typescript
// 1. Extract and validate input parameters
const inputParam1 = params.Params.find(p => p.Name.trim().toLowerCase() === ''param1'')?.Value;
// ... extract other parameters

// 2. Pre-process: Transform child parameters to parent format
const mappedParams: ActionParam[] = [
    { Name: ''ParentParam1'', Value: transformedValue1 },
    // ... map other parameters
];

// 3. Invoke parent action
const parentResult = await ActionEngine.Instance.RunAction({
    ActionName: ''{{ parentAction.Name }}'',
    Params: mappedParams,
    ContextUser: params.ContextUser
});

// 4. Check parent result
if (!parentResult.Success) {
    return {
        Success: false,
        ResultCode: ''ParentActionFailed'',
        Message: ''Parent action failed: '' + parentResult.Message
    };
}

// 5. Post-process: Transform parent outputs to child format
const processedOutput = transformParentOutput(parentResult);

// 6. Set output parameters if needed
if (outputNeeded) {
    params.Params.push({
        Name: ''OutputParam'',
        Value: processedOutput
    });
}

// 7. Return success
return {
    Success: true,
    ResultCode: ''Success'',
    Message: ''Action completed successfully''
};
```
{% endif %}

## Code Generation Rules

1. **DO NOT** generate the method signature - just the code inside
2. **DO NOT** import libraries - they''re already imported
3. **DO** add helpful comments explaining complex logic
4. **DO** validate required parameters exist
5. **DO** provide clear error messages

## Parameter Generation

Analyze the user''s request to identify:
- **Input parameters** - What data does the action need?
- **Output parameters** - What data does the action produce?
- **Parameter types** - Are they scalars, objects, or entity references?
- **Requirements** - Which parameters are required vs optional?

## Result Code Generation

Generate appropriate result codes for this action beyond the standard ''Success'' and ''Failed'':
- **Specific error conditions** - What specific failures could occur?
- **Partial success states** - Are there conditions where the action partially succeeds?
- **Business logic outcomes** - What different business outcomes are possible?
- **Validation failures** - What validation errors might occur?

Examples:
- For API calls: ''NetworkError'', ''AuthenticationFailed'', ''RateLimitExceeded''
- For data operations: ''RecordNotFound'', ''DuplicateRecord'', ''ValidationError''
- For workflows: ''PartiallyCompleted'', ''SkippedDueToCondition'', ''RequiresManualIntervention''

## Response Format

You must return a valid JSON object with this structure:

```json
{
  "code": "// Your TypeScript code here\n// Use line breaks but no indentation",
  "explanation": "Clear explanation of what the code does",
  "libraries": [
    {
      "LibraryName": "LibraryName",
      "ItemsUsed": ["item1", "item2"]
    }
  ],
  "parameters": [
    {
      "Name": "ParameterName",
      "Type": "Input|Output|Both",
      "ValueType": "Scalar|Simple Object|BaseEntity Sub-Class|Other",
      "IsArray": false,
      "IsRequired": true,
      "DefaultValue": null,
      "Description": "What this parameter does"
    }
  ],
  "resultCodes": [
    {
      "ResultCode": "Success",
      "IsSuccess": true,
      "Description": "Action completed successfully"
    },
    {
      "ResultCode": "Failed",
      "IsSuccess": false,
      "Description": "Generic failure - use more specific codes when possible"
    },
    {
      "ResultCode": "ValidationError",
      "IsSuccess": false,
      "Description": "One or more input parameters failed validation"
    }
  ]
}
```

### Parameter Examples

```json
{
  "parameters": [
    {
      "Name": "FirstName",
      "Type": "Input",
      "ValueType": "Scalar",
      "IsArray": false,
      "IsRequired": true,
      "DefaultValue": null,
      "Description": "The first name of the contact"
    },
    {
      "Name": "ContactID",
      "Type": "Output",
      "ValueType": "Scalar",
      "IsArray": false,
      "IsRequired": false,
      "DefaultValue": null,
      "Description": "The ID of the newly created contact"
    },
    {
      "Name": "Tags",
      "Type": "Input",
      "ValueType": "Scalar",
      "IsArray": true,
      "IsRequired": false,
      "DefaultValue": "[]",
      "Description": "Optional tags to apply to the contact"
    }
  ],
  "resultCodes": [
    {
      "ResultCode": "Success",
      "IsSuccess": true,
      "Description": "Contact created successfully"
    },
    {
      "ResultCode": "DuplicateContact",
      "IsSuccess": false,
      "Description": "A contact with this email already exists"
    },
    {
      "ResultCode": "ValidationError",
      "IsSuccess": false,
      "Description": "Required fields are missing or invalid"
    },
    {
      "ResultCode": "APIError",
      "IsSuccess": false,
      "Description": "Failed to connect to the CRM API"
    }
  ]
}
```

## Remember

- I am a bot and can only parse valid JSON responses
- Include all sections: code, explanation, libraries, parameters, and resultCodes
- For child actions, focus on adding value beyond the parent
- Keep parameter names clear and user-friendly
- Use the specific result codes you generate in your code (not just ''Success'' and ''Failed'')
- Result codes should match the ResultCode values exactly in the generated code',
@Priority = 1,
@IsActive = 1;

GO

-- Save AI Prompts (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateAIPrompt @ID = '2222b834-50d9-49b2-9206-fa714fe9124a',
@Name = 'Generate Action Code',
@Description = 'Generates TypeScript code for MemberJunction Actions based on user requirements. Supports both base actions and child actions that orchestrate parent actions.',
@TemplateID = '2F4D341A-CDE0-4473-9CAC-2E2E9220FEE1',
@CategoryID = '9a66484d-1b88-43d9-a166-692abf7bfe64',
@TypeID = 'A6DA423E-F36B-1410-8DAC-00021F8B792E',
@Status = 'Active',
@ResponseFormat = 'JSON',
@ModelSpecificResponseFormat = NULL,
@AIModelTypeID = NULL,
@MinPowerRank = 0,
@SelectionStrategy = 'Specific',
@PowerPreference = 'Highest',
@ParallelizationMode = 'None',
@ParallelCount = NULL,
@ParallelConfigParam = NULL,
@OutputType = 'object',
@OutputExample = '',
@ValidationBehavior = 'Strict',
@MaxRetries = 3,
@RetryDelayMS = 1000,
@RetryStrategy = 'Fixed',
@ResultSelectorPromptID = NULL,
@EnableCaching = 0,
@CacheTTLSeconds = NULL,
@CacheMatchType = 'Exact',
@CacheSimilarityThreshold = NULL,
@CacheMustMatchModel = 1,
@CacheMustMatchVendor = 1,
@CacheMustMatchAgent = 0,
@CacheMustMatchConfig = 0,
@PromptRole = 'System',
@PromptPosition = 'First',
@Temperature = NULL,
@TopP = NULL,
@TopK = NULL,
@MinP = NULL,
@FrequencyPenalty = NULL,
@PresencePenalty = NULL,
@Seed = NULL,
@StopSequences = NULL,
@IncludeLogProbs = 0,
@TopLogProbs = NULL;

GO

-- Save MJ: AI Prompt Models (core SP call only)
EXEC [${flyway:defaultSchema}].spCreateAIPromptModel @ID = 'ce4822a0-cef2-4398-8cfa-9af4564af0b1',
@PromptID = '2222B834-50D9-49B2-9206-FA714FE9124A',
@ModelID = '287E317F-BF26-F011-A770-AC1A3D21423D',
@VendorID = 'D8A5CCEC-6A37-EF11-86D4-000D3A4E707E',
@ConfigurationID = NULL,
@Priority = 1,
@ExecutionGroup = 0,
@ModelParameters = NULL,
@Status = 'Active',
@ParallelizationMode = 'None',
@ParallelCount = 1,
@ParallelConfigParam = NULL;

GO


-- End of SQL Logging Session
-- Session ID: a9882e4e-6224-4882-928f-8ae7b0abe2d5
-- Completed: 2025-06-19T20:56:39.474Z
-- Duration: 61178ms
-- Total Statements: 52
