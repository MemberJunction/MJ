-- SQL Logging Session
-- Session ID: 29317af1-4c3a-4e54-bcfb-fc985f5ae3a0
-- Started: 2026-02-12T22:47:11.798Z
-- Description: MetadataSync push operation
-- Format: Migration-ready with Flyway schema placeholders
-- Generated by MemberJunction SQLServerDataProvider

-- Save AI Models (core SP call only)
DECLARE @ID_aa6af7d6 UNIQUEIDENTIFIER,
@Name_aa6af7d6 NVARCHAR(50),
@Description_aa6af7d6 NVARCHAR(MAX),
@AIModelTypeID_aa6af7d6 UNIQUEIDENTIFIER,
@PowerRank_aa6af7d6 INT,
@IsActive_aa6af7d6 BIT,
@SpeedRank_aa6af7d6 INT,
@CostRank_aa6af7d6 INT,
@ModelSelectionInsights_aa6af7d6 NVARCHAR(MAX),
@InheritTypeModalities_aa6af7d6 BIT,
@PriorVersionID_aa6af7d6 UNIQUEIDENTIFIER
SET
  @ID_aa6af7d6 = 'A4F2213B-E99D-46E5-806B-B71BF4DE653E'
SET
  @Name_aa6af7d6 = N'GLM 5'
SET
  @Description_aa6af7d6 = N'Z.AI''s (Zhipu AI) fifth-generation frontier model released February 11, 2026. Features 745B total parameters in a Mixture-of-Experts architecture (256 experts, 44B active per inference) with 200K token context window and 128K output capacity. Achieves 77.8% on SWE-bench Verified, 92.7% on AIME 2026 I, and 86.0% on GPQA-Diamond. Includes Deep Thinking mode for self-critique loops and record-low hallucination rates. Open-source under MIT license.'
SET
  @AIModelTypeID_aa6af7d6 = 'E8A5CCEC-6A37-EF11-86D4-000D3A4E707E'
SET
  @PowerRank_aa6af7d6 = 20
SET
  @IsActive_aa6af7d6 = 1
SET
  @SpeedRank_aa6af7d6 = 6
SET
  @CostRank_aa6af7d6 = 7
SET
  @InheritTypeModalities_aa6af7d6 = 1
SET
  @PriorVersionID_aa6af7d6 = '47C3B17A-2ABA-4F18-B2F6-8B62792F1EC7'
EXEC [${flyway:defaultSchema}].spCreateAIModel @ID = @ID_aa6af7d6,
  @Name = @Name_aa6af7d6,
  @Description = @Description_aa6af7d6,
  @AIModelTypeID = @AIModelTypeID_aa6af7d6,
  @PowerRank = @PowerRank_aa6af7d6,
  @IsActive = @IsActive_aa6af7d6,
  @SpeedRank = @SpeedRank_aa6af7d6,
  @CostRank = @CostRank_aa6af7d6,
  @ModelSelectionInsights = @ModelSelectionInsights_aa6af7d6,
  @InheritTypeModalities = @InheritTypeModalities_aa6af7d6,
  @PriorVersionID = @PriorVersionID_aa6af7d6;

-- Save MJ: AI Model Vendors (core SP call only)
DECLARE @ID_bdbaf1fc UNIQUEIDENTIFIER,
@ModelID_bdbaf1fc UNIQUEIDENTIFIER,
@VendorID_bdbaf1fc UNIQUEIDENTIFIER,
@Priority_bdbaf1fc INT,
@Status_bdbaf1fc NVARCHAR(20),
@DriverClass_bdbaf1fc NVARCHAR(100),
@DriverImportPath_bdbaf1fc NVARCHAR(255),
@APIName_bdbaf1fc NVARCHAR(100),
@MaxInputTokens_bdbaf1fc INT,
@MaxOutputTokens_bdbaf1fc INT,
@SupportedResponseFormats_bdbaf1fc NVARCHAR(100),
@SupportsEffortLevel_bdbaf1fc BIT,
@SupportsStreaming_bdbaf1fc BIT,
@TypeID_bdbaf1fc UNIQUEIDENTIFIER
SET
  @ID_bdbaf1fc = 'DA488608-6A6B-4955-8266-8DF3B89E36DC'
SET
  @ModelID_bdbaf1fc = 'A4F2213B-E99D-46E5-806B-B71BF4DE653E'
SET
  @VendorID_bdbaf1fc = '9105874C-747B-49C6-80B2-3BBF83ABE29B'
SET
  @Priority_bdbaf1fc = 0
SET
  @Status_bdbaf1fc = N'Active'
SET
  @SupportedResponseFormats_bdbaf1fc = N'Any'
SET
  @SupportsEffortLevel_bdbaf1fc = 1
SET
  @SupportsStreaming_bdbaf1fc = 0
SET
  @TypeID_bdbaf1fc = '10DB468E-F2CE-475D-9F39-2DF2DE75D257'
EXEC [${flyway:defaultSchema}].spCreateAIModelVendor @ID = @ID_bdbaf1fc,
  @ModelID = @ModelID_bdbaf1fc,
  @VendorID = @VendorID_bdbaf1fc,
  @Priority = @Priority_bdbaf1fc,
  @Status = @Status_bdbaf1fc,
  @DriverClass = @DriverClass_bdbaf1fc,
  @DriverImportPath = @DriverImportPath_bdbaf1fc,
  @APIName = @APIName_bdbaf1fc,
  @MaxInputTokens = @MaxInputTokens_bdbaf1fc,
  @MaxOutputTokens = @MaxOutputTokens_bdbaf1fc,
  @SupportedResponseFormats = @SupportedResponseFormats_bdbaf1fc,
  @SupportsEffortLevel = @SupportsEffortLevel_bdbaf1fc,
  @SupportsStreaming = @SupportsStreaming_bdbaf1fc,
  @TypeID = @TypeID_bdbaf1fc;

-- Save MJ: AI Model Vendors (core SP call only)
DECLARE @ID_76973f28 UNIQUEIDENTIFIER,
@ModelID_76973f28 UNIQUEIDENTIFIER,
@VendorID_76973f28 UNIQUEIDENTIFIER,
@Priority_76973f28 INT,
@Status_76973f28 NVARCHAR(20),
@DriverClass_76973f28 NVARCHAR(100),
@DriverImportPath_76973f28 NVARCHAR(255),
@APIName_76973f28 NVARCHAR(100),
@MaxInputTokens_76973f28 INT,
@MaxOutputTokens_76973f28 INT,
@SupportedResponseFormats_76973f28 NVARCHAR(100),
@SupportsEffortLevel_76973f28 BIT,
@SupportsStreaming_76973f28 BIT,
@TypeID_76973f28 UNIQUEIDENTIFIER
SET
  @ID_76973f28 = 'E6CC92D4-8EDA-4C2D-BBFD-3F15055B48E6'
SET
  @ModelID_76973f28 = 'A4F2213B-E99D-46E5-806B-B71BF4DE653E'
SET
  @VendorID_76973f28 = '9105874C-747B-49C6-80B2-3BBF83ABE29B'
SET
  @Priority_76973f28 = 0
SET
  @Status_76973f28 = N'Active'
SET
  @DriverClass_76973f28 = N'ZhipuLLM'
SET
  @APIName_76973f28 = N'glm-5'
SET
  @MaxInputTokens_76973f28 = 202752
SET
  @MaxOutputTokens_76973f28 = 131072
SET
  @SupportedResponseFormats_76973f28 = N'Any, JSON'
SET
  @SupportsEffortLevel_76973f28 = 1
SET
  @SupportsStreaming_76973f28 = 1
SET
  @TypeID_76973f28 = '5B043EC3-1FF2-4730-B5D2-7CFDA50979B3'
EXEC [${flyway:defaultSchema}].spCreateAIModelVendor @ID = @ID_76973f28,
  @ModelID = @ModelID_76973f28,
  @VendorID = @VendorID_76973f28,
  @Priority = @Priority_76973f28,
  @Status = @Status_76973f28,
  @DriverClass = @DriverClass_76973f28,
  @DriverImportPath = @DriverImportPath_76973f28,
  @APIName = @APIName_76973f28,
  @MaxInputTokens = @MaxInputTokens_76973f28,
  @MaxOutputTokens = @MaxOutputTokens_76973f28,
  @SupportedResponseFormats = @SupportedResponseFormats_76973f28,
  @SupportsEffortLevel = @SupportsEffortLevel_76973f28,
  @SupportsStreaming = @SupportsStreaming_76973f28,
  @TypeID = @TypeID_76973f28;

-- Save MJ: AI Model Costs (core SP call only)
DECLARE @ID_95d7ad57 UNIQUEIDENTIFIER,
@ModelID_95d7ad57 UNIQUEIDENTIFIER,
@VendorID_95d7ad57 UNIQUEIDENTIFIER,
@StartedAt_95d7ad57 DATETIMEOFFSET,
@EndedAt_95d7ad57 DATETIMEOFFSET,
@Status_95d7ad57 NVARCHAR(20),
@Currency_95d7ad57 NCHAR(3),
@PriceTypeID_95d7ad57 UNIQUEIDENTIFIER,
@InputPricePerUnit_95d7ad57 DECIMAL(18, 8),
@OutputPricePerUnit_95d7ad57 DECIMAL(18, 8),
@UnitTypeID_95d7ad57 UNIQUEIDENTIFIER,
@ProcessingType_95d7ad57 NVARCHAR(20),
@Comments_95d7ad57 NVARCHAR(MAX)
SET
  @ID_95d7ad57 = '5A453FFB-DBF1-4363-B08F-7FC1AAB158CA'
SET
  @ModelID_95d7ad57 = 'A4F2213B-E99D-46E5-806B-B71BF4DE653E'
SET
  @VendorID_95d7ad57 = '9105874C-747B-49C6-80B2-3BBF83ABE29B'
SET
  @StartedAt_95d7ad57 = '2026-02-11T00:00:00.000Z'
SET
  @Status_95d7ad57 = N'Active'
SET
  @Currency_95d7ad57 = N'USD'
SET
  @PriceTypeID_95d7ad57 = 'ECE2BCB7-C854-4BF7-A517-D72793A40652'
SET
  @InputPricePerUnit_95d7ad57 = 1
SET
  @OutputPricePerUnit_95d7ad57 = 3.2
SET
  @UnitTypeID_95d7ad57 = '54208F7D-331C-40AB-84E8-163338EE9EA1'
SET
  @ProcessingType_95d7ad57 = N'Realtime'
SET
  @Comments_95d7ad57 = N'GLM 5 pricing on Z.AI as of February 2026. 745B parameter MoE model (44B active) with 200K context and 128K output. Cached input tokens available at $0.20/1M. State-of-the-art open-source model rivaling Claude Opus on benchmarks.'
EXEC [${flyway:defaultSchema}].spCreateAIModelCost @ID = @ID_95d7ad57,
  @ModelID = @ModelID_95d7ad57,
  @VendorID = @VendorID_95d7ad57,
  @StartedAt = @StartedAt_95d7ad57,
  @EndedAt = @EndedAt_95d7ad57,
  @Status = @Status_95d7ad57,
  @Currency = @Currency_95d7ad57,
  @PriceTypeID = @PriceTypeID_95d7ad57,
  @InputPricePerUnit = @InputPricePerUnit_95d7ad57,
  @OutputPricePerUnit = @OutputPricePerUnit_95d7ad57,
  @UnitTypeID = @UnitTypeID_95d7ad57,
  @ProcessingType = @ProcessingType_95d7ad57,
  @Comments = @Comments_95d7ad57;


-- Save Queries (core SP call only)
DECLARE @Name_767c8008 NVARCHAR(255),
@CategoryID_767c8008 UNIQUEIDENTIFIER,
@UserQuestion_767c8008 NVARCHAR(MAX),
@Description_767c8008 NVARCHAR(MAX),
@SQL_767c8008 NVARCHAR(MAX),
@TechnicalDescription_767c8008 NVARCHAR(MAX),
@OriginalSQL_767c8008 NVARCHAR(MAX),
@Feedback_767c8008 NVARCHAR(MAX),
@Status_767c8008 NVARCHAR(15),
@QualityRank_767c8008 INT,
@ExecutionCostRank_767c8008 INT,
@UsesTemplate_767c8008 BIT,
@AuditQueryRuns_767c8008 BIT,
@CacheEnabled_767c8008 BIT,
@CacheTTLMinutes_767c8008 INT,
@CacheMaxSize_767c8008 INT,
@EmbeddingVector_767c8008 NVARCHAR(MAX),
@EmbeddingModelID_767c8008 UNIQUEIDENTIFIER,
@CacheValidationSQL_767c8008 NVARCHAR(MAX),
@ID_767c8008 UNIQUEIDENTIFIER
SET
  @Name_767c8008 = N'GetConversationsForMemoryManager'
SET
  @CategoryID_767c8008 = '5609FBC7-381C-4F9C-9C74-04B52C1FF3DA'
SET
  @UserQuestion_767c8008 = N'What conversations have new activity that need to be analyzed for memory extraction?'
SET
  @Description_767c8008 = N'Returns all conversation data needed for memory extraction in a single query: conversations with new activity, their details with ratings, and linked agent runs for scope inheritance. Optimized to replace 4 separate sequential queries.'
SET
  @SQL_767c8008 = N'-- Get Conversations for Memory Manager - Single optimized query
-- Returns all data needed for memory extraction: conversations, details, ratings, and agent runs
-- Uses JSON aggregation to include related data without row multiplication
-- This replaces 4 separate queries with 1 query for better performance
--
-- Parameters:
--   @since (optional): ISO date string - only include conversations with new activity after this date
--   @agentIds: Comma-separated list of agent IDs that have memory enabled

SELECT
    c.ID as ConversationID,
    c.UserID,

    -- Most recent agent run ID for this conversation (for scope inheritance)
    (
        SELECT TOP 1 ar.ID
        FROM [${flyway:defaultSchema}].[vwAIAgentRuns] ar
        WHERE ar.ConversationID = c.ID
        AND ar.AgentID IN ({{ agentIds }})
        ORDER BY ar.StartedAt DESC
    ) as AgentRunID,

    -- Conversation details as JSON array with ratings included
    (
        SELECT
            cd.ID as id,
            cd.Role as role,
            cd.Message as message,
            cd.__mj_CreatedAt as createdAt,
            cdr.Rating as rating,
            cdr.Comments as ratingComment
        FROM [${flyway:defaultSchema}].[vwConversationDetails] cd
        LEFT OUTER JOIN [${flyway:defaultSchema}].[vwConversationDetailRatings] cdr
            ON cdr.ConversationDetailID = cd.ID
        WHERE cd.ConversationID = c.ID
        AND cd.Status = ''Complete''
        ORDER BY cd.__mj_CreatedAt ASC
        FOR JSON PATH
    ) as MessagesJSON,

    -- Rating summary flags
    CASE WHEN EXISTS (
        SELECT 1 FROM [${flyway:defaultSchema}].[vwConversationDetails] cd
        INNER JOIN [${flyway:defaultSchema}].[vwConversationDetailRatings] cdr ON cdr.ConversationDetailID = cd.ID
        WHERE cd.ConversationID = c.ID AND cdr.Rating >= 8
    ) THEN 1 ELSE 0
END as HasPositiveRating,

    CASE WHEN EXISTS (
        SELECT 1 FROM [${flyway:defaultSchema}].[vwConversationDetails] cd
        INNER JOIN [${flyway:defaultSchema}].[vwConversationDetailRatings] cdr ON cdr.ConversationDetailID = cd.ID
        WHERE cd.ConversationID = c.ID AND cdr.Rating <= 3
    ) THEN 1 ELSE 0
END as HasNegativeRating,

    CASE WHEN NOT EXISTS (
        SELECT 1 FROM [${flyway:defaultSchema}].[vwConversationDetails] cd
        INNER JOIN [${flyway:defaultSchema}].[vwConversationDetailRatings] cdr ON cdr.ConversationDetailID = cd.ID
        WHERE cd.ConversationID = c.ID
    ) THEN 1 ELSE 0
END as IsUnrated

FROM [${flyway:defaultSchema}].[vwConversations] c

-- Only include conversations with new activity since last run
WHERE EXISTS (
    SELECT 1 FROM [${flyway:defaultSchema}].[vwConversationDetails] cd_new
    WHERE cd_new.ConversationID = c.ID
    {% if since %}
    AND cd_new.__mj_CreatedAt >= ''{{ since }}''
    {% endif %}
)

-- Only include conversations linked to agents that have memory enabled
AND EXISTS (
    SELECT 1 FROM [${flyway:defaultSchema}].[vwAIAgentRuns] ar
    WHERE ar.ConversationID = c.ID
    AND ar.AgentID IN ({{ agentIds }})
)

ORDER BY c.__mj_UpdatedAt DESC
'
SET
  @TechnicalDescription_767c8008 = N'Single-query optimization that replaces 4 separate RunView calls in Memory Manager (get conversations, get agent runs, get details, get ratings). Uses SQL Server FOR JSON PATH to aggregate conversation details with ratings as JSON arrays. Returns rating summary flags (HasPositiveRating, HasNegativeRating, IsUnrated) and most recent AgentRunID for scope inheritance. Reduces database round trips from 4 to 1.'
SET
  @Status_767c8008 = N'Approved'
SET
  @QualityRank_767c8008 = 9
SET
  @ExecutionCostRank_767c8008 = 3
SET
  @UsesTemplate_767c8008 = 1
SET
  @AuditQueryRuns_767c8008 = 0
SET
  @CacheEnabled_767c8008 = 0
SET
  @EmbeddingVector_767c8008 = CAST(
    N'[0.05079127848148346,0.09035059064626694,-0.0241005327552557,0.0002047202578978613,0.007942557334899902,-0.004986656829714775,-0.0040833973325788975,-0.013648014515638351,-0.012232557870447636,-0.016947250813245773,-0.028481926769018173,0.007967942394316196,-0.02684820257127285,0.04656028747558594,-0.052749037742614746,-0.0031639356166124344,0.021843701601028442,-0.00868343934416771,0.024816567078232765,0.024035068228840828,-0.00625630933791399,-0.005105008836835623,0.03923854976892471,-0.03631487116217613,-0.011602414771914482,-0.003479759907349944,-0.04228506609797478,0.019970396533608437,0.03680785372853279,-0.05429837480187416,0.0020721578039228916,0.03860961273312569,-0.063536137342453,0.020076200366020203,0.0000018501910972190672,-0.029065575450658798,-0.04729870334267616,0.016312794759869576,0.0121134789660573,0.033217646181583405,0.06390431523323059,0.010297387838363647,0.04633641615509987,0.013665363192558289,-0.058271877467632294,0.04765554890036583,-0.006883734837174416,-0.06572329252958298,0.046769462525844574,0.02473931387066841,-0.009251734241843224,0.032639279961586,-0.027040032669901848,0.005404791794717312,0.03869984298944473,-0.07086299359798431,0.012611155398190022,0.042279329150915146,0.06193437799811363,-0.0017248332733288407,0.036020055413246155,-0.012290241196751595,-0.010795294307172298,-0.023887621238827705,-0.00048658213927410543,0.004781071562319994,-0.027481012046337128,-0.01167088933289051,-0.005306650884449482,0.012155258096754551,0.1098610982298851,0.048767127096652985,0.014109102077782154,-0.005584047641605139,-0.023643946275115013,-0.05883141607046127,-0.0119113028049469,-0.0008175396360456944,-0.01818632148206234,0.011405295692384243,-0.0691610649228096,0.03485322743654251,-0.016906920820474625,-0.020627707242965698,-0.05224714055657387,-0.017756739631295204,-0.00005160645378055051,-0.010144558735191822,-0.012117987498641014,-0.03278453275561333,0.10722796618938446,0.009296494536101818,0.03643833100795746,-0.02586969919502735,-0.02776397578418255,0.002058778889477253,-0.018441760912537575,-0.00994481984525919,0.017424477264285088,-0.08905638009309769,0.026498032733798027,0.03623943775892258,0.03114563226699829,0.02810569480061531,0.049529869109392166,-0.06858674436807632,-0.018866688013076782,-0.037773989140987396,-0.030855953693389893,-0.0016322797164320946,-0.03939410671591759,0.0075011784210801125,-0.023640239611268044,0.0894571989774704,-0.05356133356690407,0.0033090044744312763,-0.055434998124837875,0.08320257812738419,0.0010676984675228596,-0.007338373921811581,0.009556654840707779,0.03627324849367142,-0.028003215789794922,0.024955447763204575,-0.027351753786206245,0.017706898972392082,-0.0022198003716766834,-0.02509322389960289,0.022394653409719467,-0.07395141571760178,-0.01856291852891445,-0.018150687217712402,0.031191453337669373,-0.03474811092019081,-0.005459083244204521,0.04644906520843506,0.025601867586374283,-0.07710008323192596,-0.017003830522298813,-0.0401291623711586,0.06264519691467285,-0.03787681832909584,-0.02545793540775776,-0.017351355403661728,0.03698789328336716,-0.030737601220607758,-0.039643894881010056,0.02032824046909809,-0.00019931506540160626,0.02879779413342476,-0.058180488646030426,0.019686447456479073,0.002907541813328862,0.0023019530344754457,0.003079300280660391,0.010915940627455711,0.10657579451799393,0.08073189109563828,0.006317181047052145,0.06279805302619934,0.04606578126549721,-0.000859603111166507,-0.017565233632922173,-0.0028020672034472227,0.011497484520077705,0.0007478615152649581,0.013867675326764584,0.028941577300429344,-0.027205482125282288,-0.025482267141342163,-0.015496990643441677,0.019426340237259865,-0.026243751868605614,-0.003329381812363863,0.04347588121891022,0.046181272715330124,-0.0378577895462513,-0.002381382044404745,-0.028820278123021126,0.01254812628030777,-0.031145159155130386,-0.05485319346189499,-0.04959753155708313,0.03526325896382332,0.0010121699888259172,-0.03156620264053345,0.07196877151727676,0.021316271275281906,-0.050753612' AS NVARCHAR(MAX)
  ) + N'07127571,-0.024181406944990158,0.018523653969168663,-0.062384121119976044,0.025164064019918442,-0.0076613579876720905,0.028020406141877174,-0.004517694003880024,-0.03566809743642807,0.050433333963155746,0.03190324828028679,-0.028339020907878876,-0.056465163826942444,-0.01460159569978714,0.013730207458138466,0.08056039363145828,-0.011897717602550983,-0.022440511733293533,-0.07959193736314774,0.03878672793507576,0.008727208711206913,0.007012821733951569,0.00516737625002861,0.021217189729213715,0.032105930149555206,-0.009648353792726994,-0.023099390789866447,0.028003400191664696,0.039157934486866,0.016207469627261162,0.0008238396840170026,-0.013398611918091774,-0.01404569111764431,0.02496291883289814,-0.029620852321386337,-0.006285957992076874,0.0005397481145337224,0.029324516654014587,0.028163200244307518,0.0014608276542276144,0.03636430948972702,0.05486462637782097,0.006569191347807646,0.0003904184268321842,0.0591057687997818,0.021048828959465027,0.010539560578763485,0.06098775565624237,0.012887216173112392,0.0705694928765297,-0.035670775920152664,-0.003907260950654745,0.04537628963589668,-0.04667634144425392,-0.02407081238925457,0.008037649095058441,0.0061867255717515945,-0.040602907538414,0.05563296750187874,-0.002667628927156329,0.019101625308394432,-0.003512762486934662,0.001137108076363802,0.030229294672608376,0.02169504202902317,-0.05029250681400299,-0.055469121783971786,-0.03266417980194092,-0.018757766112685204,0.005477202124893665,-0.03844166174530983,0.04366390034556389,-0.01916595920920372,0.02346942201256752,0.01841963268816471,-0.013052878901362419,0.04185650125145912,-0.048077140003442764,0.009478059597313404,-0.07091536372900009,0.022565769031643867,-0.004921324085444212,0.04391113668680191,0.011910381726920605,0.08163058012723923,0.0018719411455094814,-0.03828807175159454,0.03158252313733101,0.0425875261425972,0.0010985546978190541,0.040754493325948715,-0.004179877694696188,0.025889461860060692,-0.012415274046361446,-0.015056653879582882,0.004746823105961084,-0.0002814853214658797,0.01745971105992794,0.0441463403403759,-0.08236732333898544,0.014081819914281368,-0.036024268716573715,-0.016545020043849945,-0.003377856919541955,-0.02306751348078251,-0.02636226825416088,-0.01099723856896162,-0.05543310195207596,-0.0648922249674797,0.06529548764228821,0.013662722893059254,0.036326147615909576,-0.007037690375000238,-0.0361054427921772,-0.058202896267175674,-0.004697256721556187,-0.04680855572223663,0.0021172116976231337,-0.01232223305851221,0.02042219787836075,0.05537120997905731,0.03784762695431709,-0.04327843338251114,0.032823529094457626,-0.014867894351482391,-0.008223011158406734,0.03855353593826294,-0.013950797729194164,0.04459561035037041,0.027599478140473366,-0.004590993747115135,0.03264136239886284,-0.010919061489403248,-0.05871909111738205,0.035408467054367065,0.06742919236421585,0.010252798907458782,-0.07799189537763596,-0.016890371218323708,-0.007714482955634594,0.05800987407565117,-0.02045244351029396,0.005857840180397034,-0.02115759439766407,-0.06399159878492355,0.030116943642497063,-0.053240351378917694,0.003706203540787101,-0.04979139193892479,0.06886255741119385,-0.04757111892104149,0.0033437798265367746,0.00736438762396574,-0.022324025630950928,-0.02843300811946392,0.03313082829117775,-0.031460754573345184,-0.019286077469587326,0.0031424034386873245,-0.03315126895904541,-0.06568882614374161,0.014908798970282078,-0.04478200152516365,-0.013060609810054302,-0.017260616645216942,-0.01208257395774126,0.0013886390952393413,-0.024398701265454292,-0.0075802854262292385,0.004130313638597727,-0.06296239048242569,-0.021676722913980484,0.029038386419415474,0.09631688892841339,0.024205869063735008,-0.03380195051431656,0.0354977510869503,-0.040639523416757584,0.028481315821409225,-0.006406386848539114,0.0029548911843448877,0.013059730641543865,0.033372655510902405,-0.02978798747062683,-0.05105017125606537,0.06694665551185608,0.02004576474428177,-0.10536867380142212,-0.01994118094444275,-0.013440405018627644,-0.027' + N'942100539803505,-0.020736780017614365,0.03392152115702629,-0.09779267013072968,0.014945067465305328,-0.028502844274044037,0.020530885085463524,0.01761610433459282,-0.0625622346997261,-0.033886488527059555,-0.1131233349442482,0.00009574100113241002,0.012706561014056206,-0.06307659298181534,0.019195737317204475,-0.08009906113147736,0.005383370444178581,-0.017002683132886887,-0.004235582426190376,-0.021217117086052895,0.01647210866212845,-0.0007949425489641726,-0.011339214630424976,0.006899432744830847,0.0444469228386879,0.008899403735995293,-0.06134840101003647,0.03177731856703758,0.015260351821780205,0.06299184262752533,0.0032627482432872057,-0.02273254469037056,-0.03224923461675644,0.005678757559508085,-0.01799294725060463,-0.028770867735147476,0.05657487362623215,-0.013943229801952839,0.03969544544816017,0.02078286185860634,0.046805765479803085,-0.004324295558035374,0.05251304432749748,0.029305709525942802,0.022435922175645828,-0.026093272492289543,0.02631351165473461,-0.00607965188100934,0.04262903332710266,0.01061802078038454,0.02471427246928215,-0.00781203480437398,-0.014936456456780434,-0.025120357051491737,-0.0036682637874037027,-0.018968453630805016,-0.0644301250576973,0.03706567734479904,0.031014690175652504,-0.07060138136148453,-0.02515042945742607,-0.008712846785783768,-0.03514249250292778,0.018190797418355942,0.08127940446138382,-0.017786934971809387,0.018582746386528015,0.024726053699851036,0.00039170298259705305,-0.026734352111816406,-0.021657204255461693,-0.0040737902745604515,-0.00675504794344306,-0.008087733760476112,-0.02449152059853077,-0.005953727290034294,0.007129926234483719,0.013528949581086636,-0.024357624351978302,-0.07492576539516449,-0.047737520188093185,0.014164100401103497,0.05191383510828018,0.035761598497629166,0.035110652446746826,0.008612304925918579,0.013734747655689716,-0.028543705120682716,0.05263384059071541,-0.09211473166942596,0.018031325191259384,0.025148333981633186,0.06415750831365585,0.011009620502591133,0.030593188479542732,-0.023033324629068375,0.025234058499336243,0.02118276059627533,-0.015876511111855507,-0.0508064404129982,-0.012985431589186192,-0.000732322339899838,0.02684761956334114,0.019889231771230698,0.050808217376470566,-0.04824836552143097,0.00004551123856799677,0.04843232035636902,-0.07893157750368118,0.007085248362272978,-0.0434907041490078,-0.012945124879479408,-0.016079507768154144,0.00799733679741621,-0.013625946827232838,0.018292617052793503,0.002236912725493312,0.04320317879319191,-0.011262319050729275,-0.05728518217802048,0.02192917838692665,-0.05100050941109657,-0.0038374271243810654,-0.032028570771217346,-0.004153268411755562,0.014178507961332798,0.018571963533759117,0.06490568816661835,-0.04621608182787895,0.0011113806394860148,0.0038916936609894037,0.011749910190701485,0.02180490642786026,0.03846370801329613,-0.05944552272558212,-0.031017789617180824,0.03457550331950188,-0.031838394701480865,-0.03136684373021126,0.0001624780852580443,0.04812081530690193,-0.004885158967226744,0.015770161524415016,-0.006694483105093241,0.0160669032484293,-0.0043753222562372684,0.025523560121655464,-0.03197191283106804,0.015508252196013927,0.0016496420139446855,0.008066253736615181,0.06393346190452576,-0.052016470581293106,0.041149038821458817,-0.006335366051644087,-0.0408761091530323,-0.022557884454727173,-0.010689076967537403,0.0378512367606163,0.06826858222484589,0.011972835287451744,-0.07253285497426987,-0.006630072370171547,0.029759662225842476,0.013830936513841152,-0.028837310150265694,-0.017657645046710968,0.0028450982645154,0.040727175772190094,0.018832918256521225,0.053141843527555466,0.022112255915999413,-0.032845836132764816,-0.038760773837566376,-0.08138919621706009,-0.0023772651329636574,0.036029040813446045,-6.432864916884136e-33,-0.023917924612760544,-0.014684871770441532,0.006195457652211189,0.03723994642496109,-0.0597340352833271,-0.014452226459980011,-0.014286693185567856,-0.031614288687705994,-0.0014728907262906432,-0.0454246811568737,-0.019309645518660545,0.04' + N'720998555421829,0.037140704691410065,0.017804637551307678,0.024539735168218613,0.018375108018517494,0.024064848199486732,-0.015934990718960762,0.003956449218094349,0.06683484464883804,0.05707010626792908,0.07038233429193497,-0.0026173924561589956,-0.04496459290385246,0.017081035301089287,0.016864199191331863,0.04953546077013016,0.0032294809352606535,0.004290263168513775,0.01644625887274742,-0.017755873501300812,0.011755957268178463,0.0029416726902127266,0.02460000291466713,-0.00520614068955183,-0.040576498955488205,-0.053908150643110275,-0.061240725219249725,0.0105019211769104,-0.03919978067278862,-0.006003388203680515,0.005817030090838671,0.012093015015125275,0.010909541510045528,0.019264882430434227,-0.03533279895782471,0.034129075706005096,-0.009940299205482006,-0.04438069090247154,-0.030499612912535667,-0.005030960310250521,0.016664298251271248,0.0006420074496418238,0.07340309023857117,0.0007477820618078113,-0.02241343818604946,-0.00947281252592802,0.0218973346054554,-0.057180631905794144,0.03891448304057121,-0.06643245369195938,0.015900282189249992,-0.02570738084614277,0.05755329877138138,0.03457222878932953,0.015214716084301472,0.04068397358059883,0.060166239738464355,0.00036199623718857765,0.017706768587231636,-0.00989444274455309,0.06864777952432632,-0.05683824419975281,-0.0468280054628849,-0.04011251777410507,-0.007704589981585741,-0.0539516881108284,-0.01912015490233898,0.04430456832051277,0.008914164267480373,0.010646039620041847,0.023217666894197464,-0.056944120675325394,-0.010533517226576805,0.037721216678619385,0.05675901100039482,-0.0004984409315511584,-0.03318960592150688,-0.018096156418323517,-0.002046339213848114,-0.06401760131120682,0.012063666246831417,-0.002988585736602545,-0.02988538332283497,0.01409144140779972,-0.00019880582112818956,0.05567929893732071,-0.04396361485123634,-0.013401719741523266,0.015571626834571362,-0.009291345253586769,-0.020664727315306664,0.005512372124940157,0.03060385398566723,-0.014660770073533058,0.004089468624442816,0.02298607863485813,-0.02113240957260132,-0.046136461198329926,-0.009890127927064896,-0.0017711372347548604,0.02748834528028965,0.005973044782876968,0.03226775303483009,-0.008336141705513,0.04134117066860199,-0.005496539641171694,0.11610472947359085,0.03799837827682495,0.048205774277448654,-0.03318478912115097,-0.032624684274196625,0.060979388654232025,-0.026705428957939148,0.00505594490095973,0.02075597085058689,-0.045613549649715424,-0.038081854581832886,0.0028805441688746214,-0.020954394713044167,-0.005293926224112511,0.01901543326675892,2.7053718554270745e-7,0.019686926156282425,0.017047487199306488,-0.013053808361291885,0.003960337024182081,0.0027668620459735394,0.00214202213101089,0.046231482177972794,0.011082331649959087,0.03369522839784622,-0.002964071463793516,0.04340475797653198,0.017111919820308685,0.011001167818903923,0.03854682296514511,-0.07275687158107758,-0.036689192056655884,-0.0218672938644886,-0.09564562886953354,-0.07321562618017197,-0.03604140505194664,0.03735772892832756,0.0071462951600551605,0.04691056162118912,0.0017742825439199805,-0.005430781748145819,0.0074676088988780975,0.019835757091641426,-0.05317511036992073,-0.08343472331762314,0.015415129251778126,0.05399279296398163,-0.052760958671569824,-0.033376842737197876,0.01886281929910183,-0.021096426993608475,0.009936757385730743,-0.047020334750413895,0.01970226876437664,-0.025672458112239838,-0.047675274312496185,0.008177420124411583,-0.045784033834934235,-0.01186355296522379,0.06341540813446045,0.059236180037260056,-0.049784839153289795,-0.05416940152645111,0.005316439084708691,-0.008641050197184086,-0.031758345663547516,0.022063013166189194,0.03223682940006256,0.011694096028804779,0.001983350608497858,0.011517112143337727,0.03735494241118431,-0.017370957881212234,-0.04038471728563309,0.0416184663772583,-0.0342542827129364,-0.0036211232654750347,-0.09179119765758514,0.01881531998515129,0.030116280540823936,-0.021103352308273315,-0.03853075951337814,0.013337511569261551,2.6788554278417677' + N'e-34,0.039873164147138596,0.05002487450838089,0.028683243319392204,0.05554112046957016,0.029719317331910133,0.03558764606714249,0.009646526537835598,0.007612765766680241,0.055310722440481186,-0.1114618182182312,-0.007236486300826073]'
SET
  @EmbeddingModelID_767c8008 = '1D45AA65-41EC-4572-9ECD-AB2826C9B059'
SET
  @ID_767c8008 = '574FD9D5-AB9E-4FA5-A36C-C25E7D3F63FC'
EXEC [${flyway:defaultSchema}].spUpdateQuery @Name = @Name_767c8008,
  @CategoryID = @CategoryID_767c8008,
  @UserQuestion = @UserQuestion_767c8008,
  @Description = @Description_767c8008,
  @SQL = @SQL_767c8008,
  @TechnicalDescription = @TechnicalDescription_767c8008,
  @OriginalSQL = @OriginalSQL_767c8008,
  @Feedback = @Feedback_767c8008,
  @Status = @Status_767c8008,
  @QualityRank = @QualityRank_767c8008,
  @ExecutionCostRank = @ExecutionCostRank_767c8008,
  @UsesTemplate = @UsesTemplate_767c8008,
  @AuditQueryRuns = @AuditQueryRuns_767c8008,
  @CacheEnabled = @CacheEnabled_767c8008,
  @CacheTTLMinutes = @CacheTTLMinutes_767c8008,
  @CacheMaxSize = @CacheMaxSize_767c8008,
  @EmbeddingVector = @EmbeddingVector_767c8008,
  @EmbeddingModelID = @EmbeddingModelID_767c8008,
  @CacheValidationSQL = @CacheValidationSQL_767c8008,
  @ID = @ID_767c8008;

-- Save MJ: Query Parameters (core SP call only)
DECLARE @QueryID_fee809ec UNIQUEIDENTIFIER,
@Name_fee809ec NVARCHAR(255),
@Type_fee809ec NVARCHAR(50),
@IsRequired_fee809ec BIT,
@DefaultValue_fee809ec NVARCHAR(MAX),
@Description_fee809ec NVARCHAR(MAX),
@SampleValue_fee809ec NVARCHAR(MAX),
@ValidationFilters_fee809ec NVARCHAR(MAX),
@DetectionMethod_fee809ec NVARCHAR(50),
@AutoDetectConfidenceScore_fee809ec DECIMAL(3, 2),
@ID_fee809ec UNIQUEIDENTIFIER
SET
  @QueryID_fee809ec = '574FD9D5-AB9E-4FA5-A36C-C25E7D3F63FC'
SET
  @Name_fee809ec = N'since'
SET
  @Type_fee809ec = N'date'
SET
  @IsRequired_fee809ec = 0
SET
  @Description_fee809ec = N'ISO date string - only include conversations with new activity after this date'
SET
  @SampleValue_fee809ec = N'2024-01-01T00:00:00.000Z'
SET
  @DetectionMethod_fee809ec = N'AI'
SET
  @ID_fee809ec = 'DF0E9F24-CD92-4C6C-BA18-13B443160DE5'
EXEC [${flyway:defaultSchema}].spUpdateQueryParameter @QueryID = @QueryID_fee809ec,
  @Name = @Name_fee809ec,
  @Type = @Type_fee809ec,
  @IsRequired = @IsRequired_fee809ec,
  @DefaultValue = @DefaultValue_fee809ec,
  @Description = @Description_fee809ec,
  @SampleValue = @SampleValue_fee809ec,
  @ValidationFilters = @ValidationFilters_fee809ec,
  @DetectionMethod = @DetectionMethod_fee809ec,
  @AutoDetectConfidenceScore = @AutoDetectConfidenceScore_fee809ec,
  @ID = @ID_fee809ec;

-- Save MJ: Query Parameters (core SP call only)
DECLARE @QueryID_eca41b90 UNIQUEIDENTIFIER,
@Name_eca41b90 NVARCHAR(255),
@Type_eca41b90 NVARCHAR(50),
@IsRequired_eca41b90 BIT,
@DefaultValue_eca41b90 NVARCHAR(MAX),
@Description_eca41b90 NVARCHAR(MAX),
@SampleValue_eca41b90 NVARCHAR(MAX),
@ValidationFilters_eca41b90 NVARCHAR(MAX),
@DetectionMethod_eca41b90 NVARCHAR(50),
@AutoDetectConfidenceScore_eca41b90 DECIMAL(3, 2),
@ID_eca41b90 UNIQUEIDENTIFIER
SET
  @QueryID_eca41b90 = '574FD9D5-AB9E-4FA5-A36C-C25E7D3F63FC'
SET
  @Name_eca41b90 = N'agentIds'
SET
  @Type_eca41b90 = N'array'
SET
  @IsRequired_eca41b90 = 1
SET
  @Description_eca41b90 = N'Comma-separated list of agent IDs that have memory enabled'
SET
  @SampleValue_eca41b90 = N'550e8400-e29b-41d4-a716-446655440000,550e8400-e29b-41d4-a716-446655440001'
SET
  @DetectionMethod_eca41b90 = N'AI'
SET
  @ID_eca41b90 = 'AF4459A1-BEDA-4200-A739-4292E90EA6A1'
EXEC [${flyway:defaultSchema}].spUpdateQueryParameter @QueryID = @QueryID_eca41b90,
  @Name = @Name_eca41b90,
  @Type = @Type_eca41b90,
  @IsRequired = @IsRequired_eca41b90,
  @DefaultValue = @DefaultValue_eca41b90,
  @Description = @Description_eca41b90,
  @SampleValue = @SampleValue_eca41b90,
  @ValidationFilters = @ValidationFilters_eca41b90,
  @DetectionMethod = @DetectionMethod_eca41b90,
  @AutoDetectConfidenceScore = @AutoDetectConfidenceScore_eca41b90,
  @ID = @ID_eca41b90;

-- Save Query Fields (core SP call only)
DECLARE @QueryID_fbf012b1 UNIQUEIDENTIFIER,
@Name_fbf012b1 NVARCHAR(255),
@Description_fbf012b1 NVARCHAR(MAX),
@Sequence_fbf012b1 INT,
@SQLBaseType_fbf012b1 NVARCHAR(50),
@SQLFullType_fbf012b1 NVARCHAR(100),
@SourceEntityID_fbf012b1 UNIQUEIDENTIFIER,
@SourceFieldName_fbf012b1 NVARCHAR(255),
@IsComputed_fbf012b1 BIT,
@ComputationDescription_fbf012b1 NVARCHAR(MAX),
@IsSummary_fbf012b1 BIT,
@SummaryDescription_fbf012b1 NVARCHAR(MAX),
@DetectionMethod_fbf012b1 NVARCHAR(50),
@AutoDetectConfidenceScore_fbf012b1 DECIMAL(3, 2),
@ID_fbf012b1 UNIQUEIDENTIFIER
SET
  @QueryID_fbf012b1 = '574FD9D5-AB9E-4FA5-A36C-C25E7D3F63FC'
SET
  @Name_fbf012b1 = N'HasPositiveRating'
SET
  @Description_fbf012b1 = N'Flag indicating if conversation has any positive ratings (>=8)'
SET
  @Sequence_fbf012b1 = 5
SET
  @SQLBaseType_fbf012b1 = N'bit'
SET
  @SQLFullType_fbf012b1 = N'bit'
SET
  @IsComputed_fbf012b1 = 1
SET
  @ComputationDescription_fbf012b1 = N'CASE statement checking for existence of ratings >= 8'
SET
  @IsSummary_fbf012b1 = 0
SET
  @DetectionMethod_fbf012b1 = N'Manual'
SET
  @ID_fbf012b1 = 'ADC80F10-C778-46A7-AB21-1474FF3051BA'
EXEC [${flyway:defaultSchema}].spUpdateQueryField @QueryID = @QueryID_fbf012b1,
  @Name = @Name_fbf012b1,
  @Description = @Description_fbf012b1,
  @Sequence = @Sequence_fbf012b1,
  @SQLBaseType = @SQLBaseType_fbf012b1,
  @SQLFullType = @SQLFullType_fbf012b1,
  @SourceEntityID = @SourceEntityID_fbf012b1,
  @SourceFieldName = @SourceFieldName_fbf012b1,
  @IsComputed = @IsComputed_fbf012b1,
  @ComputationDescription = @ComputationDescription_fbf012b1,
  @IsSummary = @IsSummary_fbf012b1,
  @SummaryDescription = @SummaryDescription_fbf012b1,
  @DetectionMethod = @DetectionMethod_fbf012b1,
  @AutoDetectConfidenceScore = @AutoDetectConfidenceScore_fbf012b1,
  @ID = @ID_fbf012b1;

-- Save Query Fields (core SP call only)
DECLARE @QueryID_6b826746 UNIQUEIDENTIFIER,
@Name_6b826746 NVARCHAR(255),
@Description_6b826746 NVARCHAR(MAX),
@Sequence_6b826746 INT,
@SQLBaseType_6b826746 NVARCHAR(50),
@SQLFullType_6b826746 NVARCHAR(100),
@SourceEntityID_6b826746 UNIQUEIDENTIFIER,
@SourceFieldName_6b826746 NVARCHAR(255),
@IsComputed_6b826746 BIT,
@ComputationDescription_6b826746 NVARCHAR(MAX),
@IsSummary_6b826746 BIT,
@SummaryDescription_6b826746 NVARCHAR(MAX),
@DetectionMethod_6b826746 NVARCHAR(50),
@AutoDetectConfidenceScore_6b826746 DECIMAL(3, 2),
@ID_6b826746 UNIQUEIDENTIFIER
SET
  @QueryID_6b826746 = '574FD9D5-AB9E-4FA5-A36C-C25E7D3F63FC'
SET
  @Name_6b826746 = N'UserID'
SET
  @Description_6b826746 = N'Unique identifier for the user associated with the conversation'
SET
  @Sequence_6b826746 = 2
SET
  @SQLBaseType_6b826746 = N'nvarchar'
SET
  @SQLFullType_6b826746 = N'nvarchar(MAX)'
SET
  @SourceEntityID_6b826746 = '13248F34-2837-EF11-86D4-6045BDEE16E6'
SET
  @SourceFieldName_6b826746 = N'UserID'
SET
  @IsComputed_6b826746 = 0
SET
  @IsSummary_6b826746 = 0
SET
  @DetectionMethod_6b826746 = N'Manual'
SET
  @ID_6b826746 = 'FC47BF02-BE51-4C7C-9132-1C20ADC4FEBD'
EXEC [${flyway:defaultSchema}].spUpdateQueryField @QueryID = @QueryID_6b826746,
  @Name = @Name_6b826746,
  @Description = @Description_6b826746,
  @Sequence = @Sequence_6b826746,
  @SQLBaseType = @SQLBaseType_6b826746,
  @SQLFullType = @SQLFullType_6b826746,
  @SourceEntityID = @SourceEntityID_6b826746,
  @SourceFieldName = @SourceFieldName_6b826746,
  @IsComputed = @IsComputed_6b826746,
  @ComputationDescription = @ComputationDescription_6b826746,
  @IsSummary = @IsSummary_6b826746,
  @SummaryDescription = @SummaryDescription_6b826746,
  @DetectionMethod = @DetectionMethod_6b826746,
  @AutoDetectConfidenceScore = @AutoDetectConfidenceScore_6b826746,
  @ID = @ID_6b826746;

-- Save Query Fields (core SP call only)
DECLARE @QueryID_c5bb04e7 UNIQUEIDENTIFIER,
@Name_c5bb04e7 NVARCHAR(255),
@Description_c5bb04e7 NVARCHAR(MAX),
@Sequence_c5bb04e7 INT,
@SQLBaseType_c5bb04e7 NVARCHAR(50),
@SQLFullType_c5bb04e7 NVARCHAR(100),
@SourceEntityID_c5bb04e7 UNIQUEIDENTIFIER,
@SourceFieldName_c5bb04e7 NVARCHAR(255),
@IsComputed_c5bb04e7 BIT,
@ComputationDescription_c5bb04e7 NVARCHAR(MAX),
@IsSummary_c5bb04e7 BIT,
@SummaryDescription_c5bb04e7 NVARCHAR(MAX),
@DetectionMethod_c5bb04e7 NVARCHAR(50),
@AutoDetectConfidenceScore_c5bb04e7 DECIMAL(3, 2),
@ID_c5bb04e7 UNIQUEIDENTIFIER
SET
  @QueryID_c5bb04e7 = '574FD9D5-AB9E-4FA5-A36C-C25E7D3F63FC'
SET
  @Name_c5bb04e7 = N'MessagesJSON'
SET
  @Description_c5bb04e7 = N'Conversation details as JSON array with ratings included'
SET
  @Sequence_c5bb04e7 = 4
SET
  @SQLBaseType_c5bb04e7 = N'nvarchar'
SET
  @SQLFullType_c5bb04e7 = N'nvarchar(MAX)'
SET
  @IsComputed_c5bb04e7 = 1
SET
  @ComputationDescription_c5bb04e7 = N'Subquery with FOR JSON PATH returning conversation details with ratings'
SET
  @IsSummary_c5bb04e7 = 0
SET
  @DetectionMethod_c5bb04e7 = N'Manual'
SET
  @ID_c5bb04e7 = 'CB76A976-AE46-454B-B837-90A78B74ED50'
EXEC [${flyway:defaultSchema}].spUpdateQueryField @QueryID = @QueryID_c5bb04e7,
  @Name = @Name_c5bb04e7,
  @Description = @Description_c5bb04e7,
  @Sequence = @Sequence_c5bb04e7,
  @SQLBaseType = @SQLBaseType_c5bb04e7,
  @SQLFullType = @SQLFullType_c5bb04e7,
  @SourceEntityID = @SourceEntityID_c5bb04e7,
  @SourceFieldName = @SourceFieldName_c5bb04e7,
  @IsComputed = @IsComputed_c5bb04e7,
  @ComputationDescription = @ComputationDescription_c5bb04e7,
  @IsSummary = @IsSummary_c5bb04e7,
  @SummaryDescription = @SummaryDescription_c5bb04e7,
  @DetectionMethod = @DetectionMethod_c5bb04e7,
  @AutoDetectConfidenceScore = @AutoDetectConfidenceScore_c5bb04e7,
  @ID = @ID_c5bb04e7;

-- Save Query Fields (core SP call only)
DECLARE @QueryID_74cf3238 UNIQUEIDENTIFIER,
@Name_74cf3238 NVARCHAR(255),
@Description_74cf3238 NVARCHAR(MAX),
@Sequence_74cf3238 INT,
@SQLBaseType_74cf3238 NVARCHAR(50),
@SQLFullType_74cf3238 NVARCHAR(100),
@SourceEntityID_74cf3238 UNIQUEIDENTIFIER,
@SourceFieldName_74cf3238 NVARCHAR(255),
@IsComputed_74cf3238 BIT,
@ComputationDescription_74cf3238 NVARCHAR(MAX),
@IsSummary_74cf3238 BIT,
@SummaryDescription_74cf3238 NVARCHAR(MAX),
@DetectionMethod_74cf3238 NVARCHAR(50),
@AutoDetectConfidenceScore_74cf3238 DECIMAL(3, 2),
@ID_74cf3238 UNIQUEIDENTIFIER
SET
  @QueryID_74cf3238 = '574FD9D5-AB9E-4FA5-A36C-C25E7D3F63FC'
SET
  @Name_74cf3238 = N'HasNegativeRating'
SET
  @Description_74cf3238 = N'Flag indicating if conversation has any negative ratings (<=3)'
SET
  @Sequence_74cf3238 = 6
SET
  @SQLBaseType_74cf3238 = N'bit'
SET
  @SQLFullType_74cf3238 = N'bit'
SET
  @IsComputed_74cf3238 = 1
SET
  @ComputationDescription_74cf3238 = N'CASE statement checking for existence of ratings <= 3'
SET
  @IsSummary_74cf3238 = 0
SET
  @DetectionMethod_74cf3238 = N'Manual'
SET
  @ID_74cf3238 = '5A464544-F105-4F17-94F8-A0423F150812'
EXEC [${flyway:defaultSchema}].spUpdateQueryField @QueryID = @QueryID_74cf3238,
  @Name = @Name_74cf3238,
  @Description = @Description_74cf3238,
  @Sequence = @Sequence_74cf3238,
  @SQLBaseType = @SQLBaseType_74cf3238,
  @SQLFullType = @SQLFullType_74cf3238,
  @SourceEntityID = @SourceEntityID_74cf3238,
  @SourceFieldName = @SourceFieldName_74cf3238,
  @IsComputed = @IsComputed_74cf3238,
  @ComputationDescription = @ComputationDescription_74cf3238,
  @IsSummary = @IsSummary_74cf3238,
  @SummaryDescription = @SummaryDescription_74cf3238,
  @DetectionMethod = @DetectionMethod_74cf3238,
  @AutoDetectConfidenceScore = @AutoDetectConfidenceScore_74cf3238,
  @ID = @ID_74cf3238;

-- Save Query Fields (core SP call only)
DECLARE @QueryID_145e1aa3 UNIQUEIDENTIFIER,
@Name_145e1aa3 NVARCHAR(255),
@Description_145e1aa3 NVARCHAR(MAX),
@Sequence_145e1aa3 INT,
@SQLBaseType_145e1aa3 NVARCHAR(50),
@SQLFullType_145e1aa3 NVARCHAR(100),
@SourceEntityID_145e1aa3 UNIQUEIDENTIFIER,
@SourceFieldName_145e1aa3 NVARCHAR(255),
@IsComputed_145e1aa3 BIT,
@ComputationDescription_145e1aa3 NVARCHAR(MAX),
@IsSummary_145e1aa3 BIT,
@SummaryDescription_145e1aa3 NVARCHAR(MAX),
@DetectionMethod_145e1aa3 NVARCHAR(50),
@AutoDetectConfidenceScore_145e1aa3 DECIMAL(3, 2),
@ID_145e1aa3 UNIQUEIDENTIFIER
SET
  @QueryID_145e1aa3 = '574FD9D5-AB9E-4FA5-A36C-C25E7D3F63FC'
SET
  @Name_145e1aa3 = N'IsUnrated'
SET
  @Description_145e1aa3 = N'Flag indicating if conversation has no ratings'
SET
  @Sequence_145e1aa3 = 7
SET
  @SQLBaseType_145e1aa3 = N'bit'
SET
  @SQLFullType_145e1aa3 = N'bit'
SET
  @IsComputed_145e1aa3 = 1
SET
  @ComputationDescription_145e1aa3 = N'CASE statement checking for absence of any ratings'
SET
  @IsSummary_145e1aa3 = 0
SET
  @DetectionMethod_145e1aa3 = N'Manual'
SET
  @ID_145e1aa3 = 'F11B7F22-EF85-418E-855A-AC0EDBEE014A'
EXEC [${flyway:defaultSchema}].spUpdateQueryField @QueryID = @QueryID_145e1aa3,
  @Name = @Name_145e1aa3,
  @Description = @Description_145e1aa3,
  @Sequence = @Sequence_145e1aa3,
  @SQLBaseType = @SQLBaseType_145e1aa3,
  @SQLFullType = @SQLFullType_145e1aa3,
  @SourceEntityID = @SourceEntityID_145e1aa3,
  @SourceFieldName = @SourceFieldName_145e1aa3,
  @IsComputed = @IsComputed_145e1aa3,
  @ComputationDescription = @ComputationDescription_145e1aa3,
  @IsSummary = @IsSummary_145e1aa3,
  @SummaryDescription = @SummaryDescription_145e1aa3,
  @DetectionMethod = @DetectionMethod_145e1aa3,
  @AutoDetectConfidenceScore = @AutoDetectConfidenceScore_145e1aa3,
  @ID = @ID_145e1aa3;

-- End of SQL Logging Session
-- Session ID: 29317af1-4c3a-4e54-bcfb-fc985f5ae3a0
-- Completed: 2026-02-12T22:48:24.082Z
-- Duration: 72284ms
-- Total Statements: 87
